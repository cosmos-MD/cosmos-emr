import {
  Ce,
  Fa,
  Fn,
  G,
  Hs,
  I,
  Io,
  Jo,
  Kn,
  Lo,
  Ma,
  N,
  Nn,
  Oe,
  Or,
  P,
  Pr,
  Qs,
  Re,
  T,
  Uo,
  Wn,
  _n,
  ae,
  at,
  es,
  hi,
  hn,
  ie,
  it,
  js,
  k,
  kr,
  ns,
  nt,
  pe,
  ps,
  rs,
  se,
  st,
  te,
  ts,
  u,
  ve,
  yt,
  z,
  zt
} from "./chunk-LA5DQH65.js";
import {
  ActionIcon,
  Alert,
  Anchor,
  AppShell,
  Avatar,
  Badge,
  Blockquote,
  Box,
  Button,
  Center,
  Checkbox,
  Chip,
  Container,
  CopyButton,
  Divider,
  Flex,
  Grid,
  Group,
  Header,
  Input,
  JsonInput,
  List,
  Loader,
  Menu,
  Modal,
  MultiSelect,
  NativeSelect,
  Navbar,
  Notification,
  Pagination,
  Paper,
  PasswordInput,
  Portal,
  Radio,
  RingProgress,
  ScrollArea,
  SimpleGrid,
  Space,
  Stack,
  Stepper,
  Switch,
  Table,
  Text,
  TextInput,
  Textarea,
  Title,
  Tooltip,
  UnstyledButton,
  _extends,
  _objectWithoutPropertiesLoose,
  createStyles,
  createUseExternalEvents,
  getDefaultZIndex,
  rem,
  useComponentDefaultProps,
  useMantineTheme
} from "./chunk-6SC7AYTT.js";
import {
  randomId,
  useDidUpdate,
  useForceUpdate,
  useQueue,
  useReducedMotion
} from "./chunk-YPQFAJYC.js";
import {
  require_prop_types
} from "./chunk-ZLV3SRT3.js";
import "./chunk-XGGF7GLZ.js";
import {
  require_react_dom
} from "./chunk-TFZGB4MC.js";
import {
  require_react
} from "./chunk-V7ECRL6R.js";
import {
  __toESM
} from "./chunk-TCQZMY3T.js";

// ../node_modules/@medplum/react/dist/esm/index.mjs
var import_react10 = __toESM(require_react(), 1);
var import_react11 = __toESM(require_react(), 1);
var import_react12 = __toESM(require_react(), 1);
var import_react13 = __toESM(require_react(), 1);
var import_react14 = __toESM(require_react(), 1);
var import_react15 = __toESM(require_react(), 1);
var import_react16 = __toESM(require_react(), 1);

// ../node_modules/@mantine/notifications/esm/Notifications/Notifications.js
var import_react9 = __toESM(require_react());

// ../node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js
function _setPrototypeOf(o, p2) {
  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf2(o2, p3) {
    o2.__proto__ = p3;
    return o2;
  };
  return _setPrototypeOf(o, p2);
}

// ../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js
function _inheritsLoose(subClass, superClass) {
  subClass.prototype = Object.create(superClass.prototype);
  subClass.prototype.constructor = subClass;
  _setPrototypeOf(subClass, superClass);
}

// ../node_modules/react-transition-group/esm/CSSTransition.js
var import_prop_types3 = __toESM(require_prop_types());

// ../node_modules/dom-helpers/esm/hasClass.js
function hasClass(element, className) {
  if (element.classList)
    return !!className && element.classList.contains(className);
  return (" " + (element.className.baseVal || element.className) + " ").indexOf(" " + className + " ") !== -1;
}

// ../node_modules/dom-helpers/esm/addClass.js
function addClass(element, className) {
  if (element.classList)
    element.classList.add(className);
  else if (!hasClass(element, className))
    if (typeof element.className === "string")
      element.className = element.className + " " + className;
    else
      element.setAttribute("class", (element.className && element.className.baseVal || "") + " " + className);
}

// ../node_modules/dom-helpers/esm/removeClass.js
function replaceClassName(origClass, classToRemove) {
  return origClass.replace(new RegExp("(^|\\s)" + classToRemove + "(?:\\s|$)", "g"), "$1").replace(/\s+/g, " ").replace(/^\s*|\s*$/g, "");
}
function removeClass(element, className) {
  if (element.classList) {
    element.classList.remove(className);
  } else if (typeof element.className === "string") {
    element.className = replaceClassName(element.className, className);
  } else {
    element.setAttribute("class", replaceClassName(element.className && element.className.baseVal || "", className));
  }
}

// ../node_modules/react-transition-group/esm/CSSTransition.js
var import_react3 = __toESM(require_react());

// ../node_modules/react-transition-group/esm/Transition.js
var import_prop_types2 = __toESM(require_prop_types());
var import_react2 = __toESM(require_react());
var import_react_dom = __toESM(require_react_dom());

// ../node_modules/react-transition-group/esm/config.js
var config_default = {
  disabled: false
};

// ../node_modules/react-transition-group/esm/utils/PropTypes.js
var import_prop_types = __toESM(require_prop_types());
var timeoutsShape = true ? import_prop_types.default.oneOfType([import_prop_types.default.number, import_prop_types.default.shape({
  enter: import_prop_types.default.number,
  exit: import_prop_types.default.number,
  appear: import_prop_types.default.number
}).isRequired]) : null;
var classNamesShape = true ? import_prop_types.default.oneOfType([import_prop_types.default.string, import_prop_types.default.shape({
  enter: import_prop_types.default.string,
  exit: import_prop_types.default.string,
  active: import_prop_types.default.string
}), import_prop_types.default.shape({
  enter: import_prop_types.default.string,
  enterDone: import_prop_types.default.string,
  enterActive: import_prop_types.default.string,
  exit: import_prop_types.default.string,
  exitDone: import_prop_types.default.string,
  exitActive: import_prop_types.default.string
})]) : null;

// ../node_modules/react-transition-group/esm/TransitionGroupContext.js
var import_react = __toESM(require_react());
var TransitionGroupContext_default = import_react.default.createContext(null);

// ../node_modules/react-transition-group/esm/Transition.js
var UNMOUNTED = "unmounted";
var EXITED = "exited";
var ENTERING = "entering";
var ENTERED = "entered";
var EXITING = "exiting";
var Transition = function(_React$Component) {
  _inheritsLoose(Transition2, _React$Component);
  function Transition2(props, context) {
    var _this;
    _this = _React$Component.call(this, props, context) || this;
    var parentGroup = context;
    var appear = parentGroup && !parentGroup.isMounting ? props.enter : props.appear;
    var initialStatus;
    _this.appearStatus = null;
    if (props.in) {
      if (appear) {
        initialStatus = EXITED;
        _this.appearStatus = ENTERING;
      } else {
        initialStatus = ENTERED;
      }
    } else {
      if (props.unmountOnExit || props.mountOnEnter) {
        initialStatus = UNMOUNTED;
      } else {
        initialStatus = EXITED;
      }
    }
    _this.state = {
      status: initialStatus
    };
    _this.nextCallback = null;
    return _this;
  }
  Transition2.getDerivedStateFromProps = function getDerivedStateFromProps(_ref, prevState) {
    var nextIn = _ref.in;
    if (nextIn && prevState.status === UNMOUNTED) {
      return {
        status: EXITED
      };
    }
    return null;
  };
  var _proto = Transition2.prototype;
  _proto.componentDidMount = function componentDidMount() {
    this.updateStatus(true, this.appearStatus);
  };
  _proto.componentDidUpdate = function componentDidUpdate(prevProps) {
    var nextStatus = null;
    if (prevProps !== this.props) {
      var status = this.state.status;
      if (this.props.in) {
        if (status !== ENTERING && status !== ENTERED) {
          nextStatus = ENTERING;
        }
      } else {
        if (status === ENTERING || status === ENTERED) {
          nextStatus = EXITING;
        }
      }
    }
    this.updateStatus(false, nextStatus);
  };
  _proto.componentWillUnmount = function componentWillUnmount() {
    this.cancelNextCallback();
  };
  _proto.getTimeouts = function getTimeouts() {
    var timeout2 = this.props.timeout;
    var exit, enter, appear;
    exit = enter = appear = timeout2;
    if (timeout2 != null && typeof timeout2 !== "number") {
      exit = timeout2.exit;
      enter = timeout2.enter;
      appear = timeout2.appear !== void 0 ? timeout2.appear : enter;
    }
    return {
      exit,
      enter,
      appear
    };
  };
  _proto.updateStatus = function updateStatus(mounting, nextStatus) {
    if (mounting === void 0) {
      mounting = false;
    }
    if (nextStatus !== null) {
      this.cancelNextCallback();
      if (nextStatus === ENTERING) {
        this.performEnter(mounting);
      } else {
        this.performExit();
      }
    } else if (this.props.unmountOnExit && this.state.status === EXITED) {
      this.setState({
        status: UNMOUNTED
      });
    }
  };
  _proto.performEnter = function performEnter(mounting) {
    var _this2 = this;
    var enter = this.props.enter;
    var appearing = this.context ? this.context.isMounting : mounting;
    var _ref2 = this.props.nodeRef ? [appearing] : [import_react_dom.default.findDOMNode(this), appearing], maybeNode = _ref2[0], maybeAppearing = _ref2[1];
    var timeouts = this.getTimeouts();
    var enterTimeout = appearing ? timeouts.appear : timeouts.enter;
    if (!mounting && !enter || config_default.disabled) {
      this.safeSetState({
        status: ENTERED
      }, function() {
        _this2.props.onEntered(maybeNode);
      });
      return;
    }
    this.props.onEnter(maybeNode, maybeAppearing);
    this.safeSetState({
      status: ENTERING
    }, function() {
      _this2.props.onEntering(maybeNode, maybeAppearing);
      _this2.onTransitionEnd(enterTimeout, function() {
        _this2.safeSetState({
          status: ENTERED
        }, function() {
          _this2.props.onEntered(maybeNode, maybeAppearing);
        });
      });
    });
  };
  _proto.performExit = function performExit() {
    var _this3 = this;
    var exit = this.props.exit;
    var timeouts = this.getTimeouts();
    var maybeNode = this.props.nodeRef ? void 0 : import_react_dom.default.findDOMNode(this);
    if (!exit || config_default.disabled) {
      this.safeSetState({
        status: EXITED
      }, function() {
        _this3.props.onExited(maybeNode);
      });
      return;
    }
    this.props.onExit(maybeNode);
    this.safeSetState({
      status: EXITING
    }, function() {
      _this3.props.onExiting(maybeNode);
      _this3.onTransitionEnd(timeouts.exit, function() {
        _this3.safeSetState({
          status: EXITED
        }, function() {
          _this3.props.onExited(maybeNode);
        });
      });
    });
  };
  _proto.cancelNextCallback = function cancelNextCallback() {
    if (this.nextCallback !== null) {
      this.nextCallback.cancel();
      this.nextCallback = null;
    }
  };
  _proto.safeSetState = function safeSetState(nextState, callback) {
    callback = this.setNextCallback(callback);
    this.setState(nextState, callback);
  };
  _proto.setNextCallback = function setNextCallback(callback) {
    var _this4 = this;
    var active = true;
    this.nextCallback = function(event) {
      if (active) {
        active = false;
        _this4.nextCallback = null;
        callback(event);
      }
    };
    this.nextCallback.cancel = function() {
      active = false;
    };
    return this.nextCallback;
  };
  _proto.onTransitionEnd = function onTransitionEnd(timeout2, handler) {
    this.setNextCallback(handler);
    var node = this.props.nodeRef ? this.props.nodeRef.current : import_react_dom.default.findDOMNode(this);
    var doesNotHaveTimeoutOrListener = timeout2 == null && !this.props.addEndListener;
    if (!node || doesNotHaveTimeoutOrListener) {
      setTimeout(this.nextCallback, 0);
      return;
    }
    if (this.props.addEndListener) {
      var _ref3 = this.props.nodeRef ? [this.nextCallback] : [node, this.nextCallback], maybeNode = _ref3[0], maybeNextCallback = _ref3[1];
      this.props.addEndListener(maybeNode, maybeNextCallback);
    }
    if (timeout2 != null) {
      setTimeout(this.nextCallback, timeout2);
    }
  };
  _proto.render = function render() {
    var status = this.state.status;
    if (status === UNMOUNTED) {
      return null;
    }
    var _this$props = this.props, children2 = _this$props.children, _in = _this$props.in, _mountOnEnter = _this$props.mountOnEnter, _unmountOnExit = _this$props.unmountOnExit, _appear = _this$props.appear, _enter = _this$props.enter, _exit = _this$props.exit, _timeout = _this$props.timeout, _addEndListener = _this$props.addEndListener, _onEnter = _this$props.onEnter, _onEntering = _this$props.onEntering, _onEntered = _this$props.onEntered, _onExit = _this$props.onExit, _onExiting = _this$props.onExiting, _onExited = _this$props.onExited, _nodeRef = _this$props.nodeRef, childProps = _objectWithoutPropertiesLoose(_this$props, ["children", "in", "mountOnEnter", "unmountOnExit", "appear", "enter", "exit", "timeout", "addEndListener", "onEnter", "onEntering", "onEntered", "onExit", "onExiting", "onExited", "nodeRef"]);
    return (
      // allows for nested Transitions
      import_react2.default.createElement(TransitionGroupContext_default.Provider, {
        value: null
      }, typeof children2 === "function" ? children2(status, childProps) : import_react2.default.cloneElement(import_react2.default.Children.only(children2), childProps))
    );
  };
  return Transition2;
}(import_react2.default.Component);
Transition.contextType = TransitionGroupContext_default;
Transition.propTypes = true ? {
  /**
   * A React reference to DOM element that need to transition:
   * https://stackoverflow.com/a/51127130/4671932
   *
   *   - When `nodeRef` prop is used, `node` is not passed to callback functions
   *      (e.g. `onEnter`) because user already has direct access to the node.
   *   - When changing `key` prop of `Transition` in a `TransitionGroup` a new
   *     `nodeRef` need to be provided to `Transition` with changed `key` prop
   *     (see
   *     [test/CSSTransition-test.js](https://github.com/reactjs/react-transition-group/blob/13435f897b3ab71f6e19d724f145596f5910581c/test/CSSTransition-test.js#L362-L437)).
   */
  nodeRef: import_prop_types2.default.shape({
    current: typeof Element === "undefined" ? import_prop_types2.default.any : function(propValue, key, componentName, location, propFullName, secret) {
      var value = propValue[key];
      return import_prop_types2.default.instanceOf(value && "ownerDocument" in value ? value.ownerDocument.defaultView.Element : Element)(propValue, key, componentName, location, propFullName, secret);
    }
  }),
  /**
   * A `function` child can be used instead of a React element. This function is
   * called with the current transition status (`'entering'`, `'entered'`,
   * `'exiting'`, `'exited'`), which can be used to apply context
   * specific props to a component.
   *
   * ```jsx
   * <Transition in={this.state.in} timeout={150}>
   *   {state => (
   *     <MyComponent className={`fade fade-${state}`} />
   *   )}
   * </Transition>
   * ```
   */
  children: import_prop_types2.default.oneOfType([import_prop_types2.default.func.isRequired, import_prop_types2.default.element.isRequired]).isRequired,
  /**
   * Show the component; triggers the enter or exit states
   */
  in: import_prop_types2.default.bool,
  /**
   * By default the child component is mounted immediately along with
   * the parent `Transition` component. If you want to "lazy mount" the component on the
   * first `in={true}` you can set `mountOnEnter`. After the first enter transition the component will stay
   * mounted, even on "exited", unless you also specify `unmountOnExit`.
   */
  mountOnEnter: import_prop_types2.default.bool,
  /**
   * By default the child component stays mounted after it reaches the `'exited'` state.
   * Set `unmountOnExit` if you'd prefer to unmount the component after it finishes exiting.
   */
  unmountOnExit: import_prop_types2.default.bool,
  /**
   * By default the child component does not perform the enter transition when
   * it first mounts, regardless of the value of `in`. If you want this
   * behavior, set both `appear` and `in` to `true`.
   *
   * > **Note**: there are no special appear states like `appearing`/`appeared`, this prop
   * > only adds an additional enter transition. However, in the
   * > `<CSSTransition>` component that first enter transition does result in
   * > additional `.appear-*` classes, that way you can choose to style it
   * > differently.
   */
  appear: import_prop_types2.default.bool,
  /**
   * Enable or disable enter transitions.
   */
  enter: import_prop_types2.default.bool,
  /**
   * Enable or disable exit transitions.
   */
  exit: import_prop_types2.default.bool,
  /**
   * The duration of the transition, in milliseconds.
   * Required unless `addEndListener` is provided.
   *
   * You may specify a single timeout for all transitions:
   *
   * ```jsx
   * timeout={500}
   * ```
   *
   * or individually:
   *
   * ```jsx
   * timeout={{
   *  appear: 500,
   *  enter: 300,
   *  exit: 500,
   * }}
   * ```
   *
   * - `appear` defaults to the value of `enter`
   * - `enter` defaults to `0`
   * - `exit` defaults to `0`
   *
   * @type {number | { enter?: number, exit?: number, appear?: number }}
   */
  timeout: function timeout(props) {
    var pt = timeoutsShape;
    if (!props.addEndListener)
      pt = pt.isRequired;
    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }
    return pt.apply(void 0, [props].concat(args));
  },
  /**
   * Add a custom transition end trigger. Called with the transitioning
   * DOM node and a `done` callback. Allows for more fine grained transition end
   * logic. Timeouts are still used as a fallback if provided.
   *
   * **Note**: when `nodeRef` prop is passed, `node` is not passed.
   *
   * ```jsx
   * addEndListener={(node, done) => {
   *   // use the css transitionend event to mark the finish of a transition
   *   node.addEventListener('transitionend', done, false);
   * }}
   * ```
   */
  addEndListener: import_prop_types2.default.func,
  /**
   * Callback fired before the "entering" status is applied. An extra parameter
   * `isAppearing` is supplied to indicate if the enter stage is occurring on the initial mount
   *
   * **Note**: when `nodeRef` prop is passed, `node` is not passed.
   *
   * @type Function(node: HtmlElement, isAppearing: bool) -> void
   */
  onEnter: import_prop_types2.default.func,
  /**
   * Callback fired after the "entering" status is applied. An extra parameter
   * `isAppearing` is supplied to indicate if the enter stage is occurring on the initial mount
   *
   * **Note**: when `nodeRef` prop is passed, `node` is not passed.
   *
   * @type Function(node: HtmlElement, isAppearing: bool)
   */
  onEntering: import_prop_types2.default.func,
  /**
   * Callback fired after the "entered" status is applied. An extra parameter
   * `isAppearing` is supplied to indicate if the enter stage is occurring on the initial mount
   *
   * **Note**: when `nodeRef` prop is passed, `node` is not passed.
   *
   * @type Function(node: HtmlElement, isAppearing: bool) -> void
   */
  onEntered: import_prop_types2.default.func,
  /**
   * Callback fired before the "exiting" status is applied.
   *
   * **Note**: when `nodeRef` prop is passed, `node` is not passed.
   *
   * @type Function(node: HtmlElement) -> void
   */
  onExit: import_prop_types2.default.func,
  /**
   * Callback fired after the "exiting" status is applied.
   *
   * **Note**: when `nodeRef` prop is passed, `node` is not passed.
   *
   * @type Function(node: HtmlElement) -> void
   */
  onExiting: import_prop_types2.default.func,
  /**
   * Callback fired after the "exited" status is applied.
   *
   * **Note**: when `nodeRef` prop is passed, `node` is not passed
   *
   * @type Function(node: HtmlElement) -> void
   */
  onExited: import_prop_types2.default.func
} : {};
function noop() {
}
Transition.defaultProps = {
  in: false,
  mountOnEnter: false,
  unmountOnExit: false,
  appear: false,
  enter: true,
  exit: true,
  onEnter: noop,
  onEntering: noop,
  onEntered: noop,
  onExit: noop,
  onExiting: noop,
  onExited: noop
};
Transition.UNMOUNTED = UNMOUNTED;
Transition.EXITED = EXITED;
Transition.ENTERING = ENTERING;
Transition.ENTERED = ENTERED;
Transition.EXITING = EXITING;
var Transition_default = Transition;

// ../node_modules/react-transition-group/esm/CSSTransition.js
var _addClass = function addClass2(node, classes) {
  return node && classes && classes.split(" ").forEach(function(c) {
    return addClass(node, c);
  });
};
var removeClass2 = function removeClass3(node, classes) {
  return node && classes && classes.split(" ").forEach(function(c) {
    return removeClass(node, c);
  });
};
var CSSTransition = function(_React$Component) {
  _inheritsLoose(CSSTransition2, _React$Component);
  function CSSTransition2() {
    var _this;
    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }
    _this = _React$Component.call.apply(_React$Component, [this].concat(args)) || this;
    _this.appliedClasses = {
      appear: {},
      enter: {},
      exit: {}
    };
    _this.onEnter = function(maybeNode, maybeAppearing) {
      var _this$resolveArgument = _this.resolveArguments(maybeNode, maybeAppearing), node = _this$resolveArgument[0], appearing = _this$resolveArgument[1];
      _this.removeClasses(node, "exit");
      _this.addClass(node, appearing ? "appear" : "enter", "base");
      if (_this.props.onEnter) {
        _this.props.onEnter(maybeNode, maybeAppearing);
      }
    };
    _this.onEntering = function(maybeNode, maybeAppearing) {
      var _this$resolveArgument2 = _this.resolveArguments(maybeNode, maybeAppearing), node = _this$resolveArgument2[0], appearing = _this$resolveArgument2[1];
      var type = appearing ? "appear" : "enter";
      _this.addClass(node, type, "active");
      if (_this.props.onEntering) {
        _this.props.onEntering(maybeNode, maybeAppearing);
      }
    };
    _this.onEntered = function(maybeNode, maybeAppearing) {
      var _this$resolveArgument3 = _this.resolveArguments(maybeNode, maybeAppearing), node = _this$resolveArgument3[0], appearing = _this$resolveArgument3[1];
      var type = appearing ? "appear" : "enter";
      _this.removeClasses(node, type);
      _this.addClass(node, type, "done");
      if (_this.props.onEntered) {
        _this.props.onEntered(maybeNode, maybeAppearing);
      }
    };
    _this.onExit = function(maybeNode) {
      var _this$resolveArgument4 = _this.resolveArguments(maybeNode), node = _this$resolveArgument4[0];
      _this.removeClasses(node, "appear");
      _this.removeClasses(node, "enter");
      _this.addClass(node, "exit", "base");
      if (_this.props.onExit) {
        _this.props.onExit(maybeNode);
      }
    };
    _this.onExiting = function(maybeNode) {
      var _this$resolveArgument5 = _this.resolveArguments(maybeNode), node = _this$resolveArgument5[0];
      _this.addClass(node, "exit", "active");
      if (_this.props.onExiting) {
        _this.props.onExiting(maybeNode);
      }
    };
    _this.onExited = function(maybeNode) {
      var _this$resolveArgument6 = _this.resolveArguments(maybeNode), node = _this$resolveArgument6[0];
      _this.removeClasses(node, "exit");
      _this.addClass(node, "exit", "done");
      if (_this.props.onExited) {
        _this.props.onExited(maybeNode);
      }
    };
    _this.resolveArguments = function(maybeNode, maybeAppearing) {
      return _this.props.nodeRef ? [_this.props.nodeRef.current, maybeNode] : [maybeNode, maybeAppearing];
    };
    _this.getClassNames = function(type) {
      var classNames = _this.props.classNames;
      var isStringClassNames = typeof classNames === "string";
      var prefix = isStringClassNames && classNames ? classNames + "-" : "";
      var baseClassName = isStringClassNames ? "" + prefix + type : classNames[type];
      var activeClassName = isStringClassNames ? baseClassName + "-active" : classNames[type + "Active"];
      var doneClassName = isStringClassNames ? baseClassName + "-done" : classNames[type + "Done"];
      return {
        baseClassName,
        activeClassName,
        doneClassName
      };
    };
    return _this;
  }
  var _proto = CSSTransition2.prototype;
  _proto.addClass = function addClass3(node, type, phase) {
    var className = this.getClassNames(type)[phase + "ClassName"];
    var _this$getClassNames = this.getClassNames("enter"), doneClassName = _this$getClassNames.doneClassName;
    if (type === "appear" && phase === "done" && doneClassName) {
      className += " " + doneClassName;
    }
    if (phase === "active") {
      node && node.scrollTop;
    }
    if (className) {
      this.appliedClasses[type][phase] = className;
      _addClass(node, className);
    }
  };
  _proto.removeClasses = function removeClasses(node, type) {
    var _this$appliedClasses$ = this.appliedClasses[type], baseClassName = _this$appliedClasses$.base, activeClassName = _this$appliedClasses$.active, doneClassName = _this$appliedClasses$.done;
    this.appliedClasses[type] = {};
    if (baseClassName) {
      removeClass2(node, baseClassName);
    }
    if (activeClassName) {
      removeClass2(node, activeClassName);
    }
    if (doneClassName) {
      removeClass2(node, doneClassName);
    }
  };
  _proto.render = function render() {
    var _this$props = this.props, _2 = _this$props.classNames, props = _objectWithoutPropertiesLoose(_this$props, ["classNames"]);
    return import_react3.default.createElement(Transition_default, _extends({}, props, {
      onEnter: this.onEnter,
      onEntered: this.onEntered,
      onEntering: this.onEntering,
      onExit: this.onExit,
      onExiting: this.onExiting,
      onExited: this.onExited
    }));
  };
  return CSSTransition2;
}(import_react3.default.Component);
CSSTransition.defaultProps = {
  classNames: ""
};
CSSTransition.propTypes = true ? _extends({}, Transition_default.propTypes, {
  /**
   * The animation classNames applied to the component as it appears, enters,
   * exits or has finished the transition. A single name can be provided, which
   * will be suffixed for each stage, e.g. `classNames="fade"` applies:
   *
   * - `fade-appear`, `fade-appear-active`, `fade-appear-done`
   * - `fade-enter`, `fade-enter-active`, `fade-enter-done`
   * - `fade-exit`, `fade-exit-active`, `fade-exit-done`
   *
   * A few details to note about how these classes are applied:
   *
   * 1. They are _joined_ with the ones that are already defined on the child
   *    component, so if you want to add some base styles, you can use
   *    `className` without worrying that it will be overridden.
   *
   * 2. If the transition component mounts with `in={false}`, no classes are
   *    applied yet. You might be expecting `*-exit-done`, but if you think
   *    about it, a component cannot finish exiting if it hasn't entered yet.
   *
   * 2. `fade-appear-done` and `fade-enter-done` will _both_ be applied. This
   *    allows you to define different behavior for when appearing is done and
   *    when regular entering is done, using selectors like
   *    `.fade-enter-done:not(.fade-appear-done)`. For example, you could apply
   *    an epic entrance animation when element first appears in the DOM using
   *    [Animate.css](https://daneden.github.io/animate.css/). Otherwise you can
   *    simply use `fade-enter-done` for defining both cases.
   *
   * Each individual classNames can also be specified independently like:
   *
   * ```js
   * classNames={{
   *  appear: 'my-appear',
   *  appearActive: 'my-active-appear',
   *  appearDone: 'my-done-appear',
   *  enter: 'my-enter',
   *  enterActive: 'my-active-enter',
   *  enterDone: 'my-done-enter',
   *  exit: 'my-exit',
   *  exitActive: 'my-active-exit',
   *  exitDone: 'my-done-exit',
   * }}
   * ```
   *
   * If you want to set these classes using CSS Modules:
   *
   * ```js
   * import styles from './styles.css';
   * ```
   *
   * you might want to use camelCase in your CSS file, that way could simply
   * spread them instead of listing them one by one:
   *
   * ```js
   * classNames={{ ...styles }}
   * ```
   *
   * @type {string | {
   *  appear?: string,
   *  appearActive?: string,
   *  appearDone?: string,
   *  enter?: string,
   *  enterActive?: string,
   *  enterDone?: string,
   *  exit?: string,
   *  exitActive?: string,
   *  exitDone?: string,
   * }}
   */
  classNames: classNamesShape,
  /**
   * A `<Transition>` callback fired immediately after the 'enter' or 'appear' class is
   * applied.
   *
   * **Note**: when `nodeRef` prop is passed, `node` is not passed.
   *
   * @type Function(node: HtmlElement, isAppearing: bool)
   */
  onEnter: import_prop_types3.default.func,
  /**
   * A `<Transition>` callback fired immediately after the 'enter-active' or
   * 'appear-active' class is applied.
   *
   * **Note**: when `nodeRef` prop is passed, `node` is not passed.
   *
   * @type Function(node: HtmlElement, isAppearing: bool)
   */
  onEntering: import_prop_types3.default.func,
  /**
   * A `<Transition>` callback fired immediately after the 'enter' or
   * 'appear' classes are **removed** and the `done` class is added to the DOM node.
   *
   * **Note**: when `nodeRef` prop is passed, `node` is not passed.
   *
   * @type Function(node: HtmlElement, isAppearing: bool)
   */
  onEntered: import_prop_types3.default.func,
  /**
   * A `<Transition>` callback fired immediately after the 'exit' class is
   * applied.
   *
   * **Note**: when `nodeRef` prop is passed, `node` is not passed
   *
   * @type Function(node: HtmlElement)
   */
  onExit: import_prop_types3.default.func,
  /**
   * A `<Transition>` callback fired immediately after the 'exit-active' is applied.
   *
   * **Note**: when `nodeRef` prop is passed, `node` is not passed
   *
   * @type Function(node: HtmlElement)
   */
  onExiting: import_prop_types3.default.func,
  /**
   * A `<Transition>` callback fired immediately after the 'exit' classes
   * are **removed** and the `exit-done` class is added to the DOM node.
   *
   * **Note**: when `nodeRef` prop is passed, `node` is not passed
   *
   * @type Function(node: HtmlElement)
   */
  onExited: import_prop_types3.default.func
}) : {};

// ../node_modules/react-transition-group/esm/ReplaceTransition.js
var import_prop_types5 = __toESM(require_prop_types());
var import_react6 = __toESM(require_react());
var import_react_dom2 = __toESM(require_react_dom());

// ../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js
function _assertThisInitialized(self) {
  if (self === void 0) {
    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  }
  return self;
}

// ../node_modules/react-transition-group/esm/TransitionGroup.js
var import_prop_types4 = __toESM(require_prop_types());
var import_react5 = __toESM(require_react());

// ../node_modules/react-transition-group/esm/utils/ChildMapping.js
var import_react4 = __toESM(require_react());
function getChildMapping(children2, mapFn) {
  var mapper = function mapper2(child) {
    return mapFn && (0, import_react4.isValidElement)(child) ? mapFn(child) : child;
  };
  var result = /* @__PURE__ */ Object.create(null);
  if (children2)
    import_react4.Children.map(children2, function(c) {
      return c;
    }).forEach(function(child) {
      result[child.key] = mapper(child);
    });
  return result;
}
function mergeChildMappings(prev, next) {
  prev = prev || {};
  next = next || {};
  function getValueForKey(key) {
    return key in next ? next[key] : prev[key];
  }
  var nextKeysPending = /* @__PURE__ */ Object.create(null);
  var pendingKeys = [];
  for (var prevKey in prev) {
    if (prevKey in next) {
      if (pendingKeys.length) {
        nextKeysPending[prevKey] = pendingKeys;
        pendingKeys = [];
      }
    } else {
      pendingKeys.push(prevKey);
    }
  }
  var i;
  var childMapping = {};
  for (var nextKey in next) {
    if (nextKeysPending[nextKey]) {
      for (i = 0; i < nextKeysPending[nextKey].length; i++) {
        var pendingNextKey = nextKeysPending[nextKey][i];
        childMapping[nextKeysPending[nextKey][i]] = getValueForKey(pendingNextKey);
      }
    }
    childMapping[nextKey] = getValueForKey(nextKey);
  }
  for (i = 0; i < pendingKeys.length; i++) {
    childMapping[pendingKeys[i]] = getValueForKey(pendingKeys[i]);
  }
  return childMapping;
}
function getProp(child, prop, props) {
  return props[prop] != null ? props[prop] : child.props[prop];
}
function getInitialChildMapping(props, onExited) {
  return getChildMapping(props.children, function(child) {
    return (0, import_react4.cloneElement)(child, {
      onExited: onExited.bind(null, child),
      in: true,
      appear: getProp(child, "appear", props),
      enter: getProp(child, "enter", props),
      exit: getProp(child, "exit", props)
    });
  });
}
function getNextChildMapping(nextProps, prevChildMapping, onExited) {
  var nextChildMapping = getChildMapping(nextProps.children);
  var children2 = mergeChildMappings(prevChildMapping, nextChildMapping);
  Object.keys(children2).forEach(function(key) {
    var child = children2[key];
    if (!(0, import_react4.isValidElement)(child))
      return;
    var hasPrev = key in prevChildMapping;
    var hasNext = key in nextChildMapping;
    var prevChild = prevChildMapping[key];
    var isLeaving = (0, import_react4.isValidElement)(prevChild) && !prevChild.props.in;
    if (hasNext && (!hasPrev || isLeaving)) {
      children2[key] = (0, import_react4.cloneElement)(child, {
        onExited: onExited.bind(null, child),
        in: true,
        exit: getProp(child, "exit", nextProps),
        enter: getProp(child, "enter", nextProps)
      });
    } else if (!hasNext && hasPrev && !isLeaving) {
      children2[key] = (0, import_react4.cloneElement)(child, {
        in: false
      });
    } else if (hasNext && hasPrev && (0, import_react4.isValidElement)(prevChild)) {
      children2[key] = (0, import_react4.cloneElement)(child, {
        onExited: onExited.bind(null, child),
        in: prevChild.props.in,
        exit: getProp(child, "exit", nextProps),
        enter: getProp(child, "enter", nextProps)
      });
    }
  });
  return children2;
}

// ../node_modules/react-transition-group/esm/TransitionGroup.js
var values = Object.values || function(obj) {
  return Object.keys(obj).map(function(k2) {
    return obj[k2];
  });
};
var defaultProps = {
  component: "div",
  childFactory: function childFactory(child) {
    return child;
  }
};
var TransitionGroup = function(_React$Component) {
  _inheritsLoose(TransitionGroup2, _React$Component);
  function TransitionGroup2(props, context) {
    var _this;
    _this = _React$Component.call(this, props, context) || this;
    var handleExited = _this.handleExited.bind(_assertThisInitialized(_this));
    _this.state = {
      contextValue: {
        isMounting: true
      },
      handleExited,
      firstRender: true
    };
    return _this;
  }
  var _proto = TransitionGroup2.prototype;
  _proto.componentDidMount = function componentDidMount() {
    this.mounted = true;
    this.setState({
      contextValue: {
        isMounting: false
      }
    });
  };
  _proto.componentWillUnmount = function componentWillUnmount() {
    this.mounted = false;
  };
  TransitionGroup2.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, _ref) {
    var prevChildMapping = _ref.children, handleExited = _ref.handleExited, firstRender = _ref.firstRender;
    return {
      children: firstRender ? getInitialChildMapping(nextProps, handleExited) : getNextChildMapping(nextProps, prevChildMapping, handleExited),
      firstRender: false
    };
  };
  _proto.handleExited = function handleExited(child, node) {
    var currentChildMapping = getChildMapping(this.props.children);
    if (child.key in currentChildMapping)
      return;
    if (child.props.onExited) {
      child.props.onExited(node);
    }
    if (this.mounted) {
      this.setState(function(state) {
        var children2 = _extends({}, state.children);
        delete children2[child.key];
        return {
          children: children2
        };
      });
    }
  };
  _proto.render = function render() {
    var _this$props = this.props, Component = _this$props.component, childFactory2 = _this$props.childFactory, props = _objectWithoutPropertiesLoose(_this$props, ["component", "childFactory"]);
    var contextValue = this.state.contextValue;
    var children2 = values(this.state.children).map(childFactory2);
    delete props.appear;
    delete props.enter;
    delete props.exit;
    if (Component === null) {
      return import_react5.default.createElement(TransitionGroupContext_default.Provider, {
        value: contextValue
      }, children2);
    }
    return import_react5.default.createElement(TransitionGroupContext_default.Provider, {
      value: contextValue
    }, import_react5.default.createElement(Component, props, children2));
  };
  return TransitionGroup2;
}(import_react5.default.Component);
TransitionGroup.propTypes = true ? {
  /**
   * `<TransitionGroup>` renders a `<div>` by default. You can change this
   * behavior by providing a `component` prop.
   * If you use React v16+ and would like to avoid a wrapping `<div>` element
   * you can pass in `component={null}`. This is useful if the wrapping div
   * borks your css styles.
   */
  component: import_prop_types4.default.any,
  /**
   * A set of `<Transition>` components, that are toggled `in` and out as they
   * leave. the `<TransitionGroup>` will inject specific transition props, so
   * remember to spread them through if you are wrapping the `<Transition>` as
   * with our `<Fade>` example.
   *
   * While this component is meant for multiple `Transition` or `CSSTransition`
   * children, sometimes you may want to have a single transition child with
   * content that you want to be transitioned out and in when you change it
   * (e.g. routes, images etc.) In that case you can change the `key` prop of
   * the transition child as you change its content, this will cause
   * `TransitionGroup` to transition the child out and back in.
   */
  children: import_prop_types4.default.node,
  /**
   * A convenience prop that enables or disables appear animations
   * for all children. Note that specifying this will override any defaults set
   * on individual children Transitions.
   */
  appear: import_prop_types4.default.bool,
  /**
   * A convenience prop that enables or disables enter animations
   * for all children. Note that specifying this will override any defaults set
   * on individual children Transitions.
   */
  enter: import_prop_types4.default.bool,
  /**
   * A convenience prop that enables or disables exit animations
   * for all children. Note that specifying this will override any defaults set
   * on individual children Transitions.
   */
  exit: import_prop_types4.default.bool,
  /**
   * You may need to apply reactive updates to a child as it is exiting.
   * This is generally done by using `cloneElement` however in the case of an exiting
   * child the element has already been removed and not accessible to the consumer.
   *
   * If you do need to update a child as it leaves you can provide a `childFactory`
   * to wrap every child, even the ones that are leaving.
   *
   * @type Function(child: ReactElement) -> ReactElement
   */
  childFactory: import_prop_types4.default.func
} : {};
TransitionGroup.defaultProps = defaultProps;
var TransitionGroup_default = TransitionGroup;

// ../node_modules/react-transition-group/esm/ReplaceTransition.js
var ReplaceTransition = function(_React$Component) {
  _inheritsLoose(ReplaceTransition2, _React$Component);
  function ReplaceTransition2() {
    var _this;
    for (var _len = arguments.length, _args = new Array(_len), _key = 0; _key < _len; _key++) {
      _args[_key] = arguments[_key];
    }
    _this = _React$Component.call.apply(_React$Component, [this].concat(_args)) || this;
    _this.handleEnter = function() {
      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        args[_key2] = arguments[_key2];
      }
      return _this.handleLifecycle("onEnter", 0, args);
    };
    _this.handleEntering = function() {
      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
        args[_key3] = arguments[_key3];
      }
      return _this.handleLifecycle("onEntering", 0, args);
    };
    _this.handleEntered = function() {
      for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
        args[_key4] = arguments[_key4];
      }
      return _this.handleLifecycle("onEntered", 0, args);
    };
    _this.handleExit = function() {
      for (var _len5 = arguments.length, args = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {
        args[_key5] = arguments[_key5];
      }
      return _this.handleLifecycle("onExit", 1, args);
    };
    _this.handleExiting = function() {
      for (var _len6 = arguments.length, args = new Array(_len6), _key6 = 0; _key6 < _len6; _key6++) {
        args[_key6] = arguments[_key6];
      }
      return _this.handleLifecycle("onExiting", 1, args);
    };
    _this.handleExited = function() {
      for (var _len7 = arguments.length, args = new Array(_len7), _key7 = 0; _key7 < _len7; _key7++) {
        args[_key7] = arguments[_key7];
      }
      return _this.handleLifecycle("onExited", 1, args);
    };
    return _this;
  }
  var _proto = ReplaceTransition2.prototype;
  _proto.handleLifecycle = function handleLifecycle(handler, idx, originalArgs) {
    var _child$props;
    var children2 = this.props.children;
    var child = import_react6.default.Children.toArray(children2)[idx];
    if (child.props[handler])
      (_child$props = child.props)[handler].apply(_child$props, originalArgs);
    if (this.props[handler]) {
      var maybeNode = child.props.nodeRef ? void 0 : import_react_dom2.default.findDOMNode(this);
      this.props[handler](maybeNode);
    }
  };
  _proto.render = function render() {
    var _this$props = this.props, children2 = _this$props.children, inProp = _this$props.in, props = _objectWithoutPropertiesLoose(_this$props, ["children", "in"]);
    var _React$Children$toArr = import_react6.default.Children.toArray(children2), first = _React$Children$toArr[0], second = _React$Children$toArr[1];
    delete props.onEnter;
    delete props.onEntering;
    delete props.onEntered;
    delete props.onExit;
    delete props.onExiting;
    delete props.onExited;
    return import_react6.default.createElement(TransitionGroup_default, props, inProp ? import_react6.default.cloneElement(first, {
      key: "first",
      onEnter: this.handleEnter,
      onEntering: this.handleEntering,
      onEntered: this.handleEntered
    }) : import_react6.default.cloneElement(second, {
      key: "second",
      onEnter: this.handleExit,
      onEntering: this.handleExiting,
      onEntered: this.handleExited
    }));
  };
  return ReplaceTransition2;
}(import_react6.default.Component);
ReplaceTransition.propTypes = true ? {
  in: import_prop_types5.default.bool.isRequired,
  children: function children(props, propName) {
    if (import_react6.default.Children.count(props[propName]) !== 2)
      return new Error('"' + propName + '" must be exactly two transition components.');
    return null;
  }
} : {};

// ../node_modules/react-transition-group/esm/SwitchTransition.js
var import_react7 = __toESM(require_react());
var import_prop_types6 = __toESM(require_prop_types());
var _leaveRenders;
var _enterRenders;
function areChildrenDifferent(oldChildren, newChildren) {
  if (oldChildren === newChildren)
    return false;
  if (import_react7.default.isValidElement(oldChildren) && import_react7.default.isValidElement(newChildren) && oldChildren.key != null && oldChildren.key === newChildren.key) {
    return false;
  }
  return true;
}
var modes = {
  out: "out-in",
  in: "in-out"
};
var callHook = function callHook2(element, name, cb) {
  return function() {
    var _element$props;
    element.props[name] && (_element$props = element.props)[name].apply(_element$props, arguments);
    cb();
  };
};
var leaveRenders = (_leaveRenders = {}, _leaveRenders[modes.out] = function(_ref) {
  var current = _ref.current, changeState = _ref.changeState;
  return import_react7.default.cloneElement(current, {
    in: false,
    onExited: callHook(current, "onExited", function() {
      changeState(ENTERING, null);
    })
  });
}, _leaveRenders[modes.in] = function(_ref2) {
  var current = _ref2.current, changeState = _ref2.changeState, children2 = _ref2.children;
  return [current, import_react7.default.cloneElement(children2, {
    in: true,
    onEntered: callHook(children2, "onEntered", function() {
      changeState(ENTERING);
    })
  })];
}, _leaveRenders);
var enterRenders = (_enterRenders = {}, _enterRenders[modes.out] = function(_ref3) {
  var children2 = _ref3.children, changeState = _ref3.changeState;
  return import_react7.default.cloneElement(children2, {
    in: true,
    onEntered: callHook(children2, "onEntered", function() {
      changeState(ENTERED, import_react7.default.cloneElement(children2, {
        in: true
      }));
    })
  });
}, _enterRenders[modes.in] = function(_ref4) {
  var current = _ref4.current, children2 = _ref4.children, changeState = _ref4.changeState;
  return [import_react7.default.cloneElement(current, {
    in: false,
    onExited: callHook(current, "onExited", function() {
      changeState(ENTERED, import_react7.default.cloneElement(children2, {
        in: true
      }));
    })
  }), import_react7.default.cloneElement(children2, {
    in: true
  })];
}, _enterRenders);
var SwitchTransition = function(_React$Component) {
  _inheritsLoose(SwitchTransition2, _React$Component);
  function SwitchTransition2() {
    var _this;
    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }
    _this = _React$Component.call.apply(_React$Component, [this].concat(args)) || this;
    _this.state = {
      status: ENTERED,
      current: null
    };
    _this.appeared = false;
    _this.changeState = function(status, current) {
      if (current === void 0) {
        current = _this.state.current;
      }
      _this.setState({
        status,
        current
      });
    };
    return _this;
  }
  var _proto = SwitchTransition2.prototype;
  _proto.componentDidMount = function componentDidMount() {
    this.appeared = true;
  };
  SwitchTransition2.getDerivedStateFromProps = function getDerivedStateFromProps(props, state) {
    if (props.children == null) {
      return {
        current: null
      };
    }
    if (state.status === ENTERING && props.mode === modes.in) {
      return {
        status: ENTERING
      };
    }
    if (state.current && areChildrenDifferent(state.current, props.children)) {
      return {
        status: EXITING
      };
    }
    return {
      current: import_react7.default.cloneElement(props.children, {
        in: true
      })
    };
  };
  _proto.render = function render() {
    var _this$props = this.props, children2 = _this$props.children, mode = _this$props.mode, _this$state = this.state, status = _this$state.status, current = _this$state.current;
    var data = {
      children: children2,
      current,
      changeState: this.changeState,
      status
    };
    var component;
    switch (status) {
      case ENTERING:
        component = enterRenders[mode](data);
        break;
      case EXITING:
        component = leaveRenders[mode](data);
        break;
      case ENTERED:
        component = current;
    }
    return import_react7.default.createElement(TransitionGroupContext_default.Provider, {
      value: {
        isMounting: !this.appeared
      }
    }, component);
  };
  return SwitchTransition2;
}(import_react7.default.Component);
SwitchTransition.propTypes = true ? {
  /**
   * Transition modes.
   * `out-in`: Current element transitions out first, then when complete, the new element transitions in.
   * `in-out`: New element transitions in first, then when complete, the current element transitions out.
   *
   * @type {'out-in'|'in-out'}
   */
  mode: import_prop_types6.default.oneOf([modes.in, modes.out]),
  /**
   * Any `Transition` or `CSSTransition` component.
   */
  children: import_prop_types6.default.oneOfType([import_prop_types6.default.element.isRequired])
} : {};
SwitchTransition.defaultProps = {
  mode: modes.out
};

// ../node_modules/@mantine/notifications/esm/events.js
var [useNotificationsEvents, createEvent] = createUseExternalEvents("mantine-notifications");
var showNotification = createEvent("show");
var hideNotification = createEvent("hide");
var cleanNotifications = createEvent("clean");
var cleanNotificationsQueue = createEvent("cleanQueue");
var updateNotification = createEvent("update");
var notifications = {
  show: showNotification,
  hide: hideNotification,
  clean: cleanNotifications,
  cleanQueue: cleanNotificationsQueue,
  update: updateNotification
};

// ../node_modules/@mantine/notifications/esm/Notifications/get-position-styles/get-position-styles.js
function getPositionStyles([vertical, horizontal], spacing) {
  const styles = {};
  vertical === "top" && (styles.top = spacing);
  vertical === "bottom" && (styles.bottom = spacing);
  horizontal === "left" && (styles.left = spacing);
  horizontal === "right" && (styles.right = spacing);
  horizontal === "center" && (styles.left = "50%", styles.transform = "translateX(-50%)");
  return styles;
}
var get_position_styles_default = getPositionStyles;

// ../node_modules/@mantine/notifications/esm/Notifications/get-notification-state-styles/get-notification-state-styles.js
var __defProp = Object.defineProperty;
var __getOwnPropSymbols = Object.getOwnPropertySymbols;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __propIsEnum = Object.prototype.propertyIsEnumerable;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __spreadValues = (a, b2) => {
  for (var prop in b2 || (b2 = {}))
    if (__hasOwnProp.call(b2, prop))
      __defNormalProp(a, prop, b2[prop]);
  if (__getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(b2)) {
      if (__propIsEnum.call(b2, prop))
        __defNormalProp(a, prop, b2[prop]);
    }
  return a;
};
var transforms = {
  left: "translateX(-100%)",
  right: "translateX(100%)",
  "top-center": "translateY(-100%)",
  "bottom-center": "translateY(100%)"
};
var noTransform = {
  left: "translateX(0)",
  right: "translateX(0)",
  "top-center": "translateY(0)",
  "bottom-center": "translateY(0)"
};
function getNotificationStateStyles({
  state,
  maxHeight,
  positioning,
  transitionDuration
}) {
  const [vertical, horizontal] = positioning;
  const property = horizontal === "center" ? `${vertical}-center` : horizontal;
  const commonStyles = {
    opacity: 0,
    maxHeight,
    transform: transforms[property],
    transitionDuration: `${transitionDuration}ms, ${transitionDuration}ms, ${transitionDuration}ms`,
    transitionTimingFunction: "cubic-bezier(.51,.3,0,1.21), cubic-bezier(.51,.3,0,1.21), linear",
    transitionProperty: "opacity, transform, max-height"
  };
  const inState = {
    opacity: 1,
    transform: noTransform[property]
  };
  const outState = {
    opacity: 0,
    maxHeight: 0,
    transform: transforms[property]
  };
  const transitionStyles = {
    entering: inState,
    entered: inState,
    exiting: outState,
    exited: outState
  };
  return __spreadValues(__spreadValues({}, commonStyles), transitionStyles[state]);
}
var get_notification_state_styles_default = getNotificationStateStyles;

// ../node_modules/@mantine/notifications/esm/NotificationContainer/NotificationContainer.js
var import_react8 = __toESM(require_react());

// ../node_modules/@mantine/notifications/esm/NotificationContainer/get-auto-close/get-auto-close.js
function getAutoClose(autoClose, notificationAutoClose) {
  if (typeof notificationAutoClose === "number") {
    return notificationAutoClose;
  }
  if (notificationAutoClose === false || autoClose === false) {
    return false;
  }
  return autoClose;
}
var get_auto_close_default = getAutoClose;

// ../node_modules/@mantine/notifications/esm/NotificationContainer/NotificationContainer.js
var __defProp2 = Object.defineProperty;
var __defProps = Object.defineProperties;
var __getOwnPropDescs = Object.getOwnPropertyDescriptors;
var __getOwnPropSymbols2 = Object.getOwnPropertySymbols;
var __hasOwnProp2 = Object.prototype.hasOwnProperty;
var __propIsEnum2 = Object.prototype.propertyIsEnumerable;
var __defNormalProp2 = (obj, key, value) => key in obj ? __defProp2(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __spreadValues2 = (a, b2) => {
  for (var prop in b2 || (b2 = {}))
    if (__hasOwnProp2.call(b2, prop))
      __defNormalProp2(a, prop, b2[prop]);
  if (__getOwnPropSymbols2)
    for (var prop of __getOwnPropSymbols2(b2)) {
      if (__propIsEnum2.call(b2, prop))
        __defNormalProp2(a, prop, b2[prop]);
    }
  return a;
};
var __spreadProps = (a, b2) => __defProps(a, __getOwnPropDescs(b2));
var __objRest = (source, exclude) => {
  var target = {};
  for (var prop in source)
    if (__hasOwnProp2.call(source, prop) && exclude.indexOf(prop) < 0)
      target[prop] = source[prop];
  if (source != null && __getOwnPropSymbols2)
    for (var prop of __getOwnPropSymbols2(source)) {
      if (exclude.indexOf(prop) < 0 && __propIsEnum2.call(source, prop))
        target[prop] = source[prop];
    }
  return target;
};
function NotificationContainer(_a2) {
  var _b = _a2, {
    notification,
    autoClose,
    onHide,
    innerRef
  } = _b, others = __objRest(_b, [
    "notification",
    "autoClose",
    "onHide",
    "innerRef"
  ]);
  const _a22 = notification, { autoClose: notificationAutoClose, message } = _a22, notificationProps = __objRest(_a22, ["autoClose", "message"]);
  const autoCloseTimeout = get_auto_close_default(autoClose, notificationAutoClose);
  const hideTimeout = (0, import_react8.useRef)();
  const handleHide = () => {
    onHide(notification.id);
    window.clearTimeout(hideTimeout.current);
  };
  const cancelDelayedHide = () => {
    clearTimeout(hideTimeout.current);
  };
  const handleDelayedHide = () => {
    if (typeof autoCloseTimeout === "number") {
      hideTimeout.current = window.setTimeout(handleHide, autoCloseTimeout);
    }
  };
  (0, import_react8.useEffect)(() => {
    if (typeof notification.onOpen === "function") {
      notification.onOpen(notification);
    }
  }, []);
  (0, import_react8.useEffect)(() => {
    handleDelayedHide();
    return cancelDelayedHide;
  }, [autoClose, notification.autoClose]);
  return import_react8.default.createElement(Notification, __spreadProps(__spreadValues2(__spreadValues2({}, notificationProps), others), {
    onClose: handleHide,
    onMouseEnter: cancelDelayedHide,
    onMouseLeave: handleDelayedHide,
    ref: innerRef
  }), message);
}
NotificationContainer.displayName = "@mantine/notifications/NotificationContainer";
var NotificationContainer_default = NotificationContainer;

// ../node_modules/@mantine/notifications/esm/Notifications/Notifications.styles.js
var useStyles = createStyles((theme, { zIndex }) => ({
  notifications: {
    width: `calc(100% - ${theme.spacing.md} * 2)`,
    boxSizing: "border-box",
    position: "fixed",
    zIndex
  },
  notification: {
    "&:not(:first-of-type)": {
      marginTop: theme.spacing.sm
    }
  }
}));
var Notifications_styles_default = useStyles;

// ../node_modules/@mantine/notifications/esm/Notifications/use-notifications-state/use-notifications-state.js
var __defProp3 = Object.defineProperty;
var __defProps2 = Object.defineProperties;
var __getOwnPropDescs2 = Object.getOwnPropertyDescriptors;
var __getOwnPropSymbols3 = Object.getOwnPropertySymbols;
var __hasOwnProp3 = Object.prototype.hasOwnProperty;
var __propIsEnum3 = Object.prototype.propertyIsEnumerable;
var __defNormalProp3 = (obj, key, value) => key in obj ? __defProp3(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __spreadValues3 = (a, b2) => {
  for (var prop in b2 || (b2 = {}))
    if (__hasOwnProp3.call(b2, prop))
      __defNormalProp3(a, prop, b2[prop]);
  if (__getOwnPropSymbols3)
    for (var prop of __getOwnPropSymbols3(b2)) {
      if (__propIsEnum3.call(b2, prop))
        __defNormalProp3(a, prop, b2[prop]);
    }
  return a;
};
var __spreadProps2 = (a, b2) => __defProps2(a, __getOwnPropDescs2(b2));
function useNotificationsState({ limit }) {
  const { state, queue, update, cleanQueue } = useQueue({
    initialValues: [],
    limit
  });
  const showNotification2 = (notification) => {
    const id2 = notification.id || randomId();
    update((notifications2) => {
      if (notification.id && notifications2.some((n) => n.id === notification.id)) {
        return notifications2;
      }
      return [...notifications2, __spreadProps2(__spreadValues3({}, notification), { id: id2 })];
    });
    return id2;
  };
  const updateNotification2 = (notification) => update((notifications2) => {
    const index = notifications2.findIndex((n) => n.id === notification.id);
    if (index === -1) {
      return notifications2;
    }
    const newNotifications = [...notifications2];
    newNotifications[index] = notification;
    return newNotifications;
  });
  const hideNotification2 = (id2) => update((notifications2) => notifications2.filter((notification) => {
    if (notification.id === id2) {
      typeof notification.onClose === "function" && notification.onClose(notification);
      return false;
    }
    return true;
  }));
  const clean = () => update(() => []);
  return {
    notifications: state,
    queue,
    showNotification: showNotification2,
    updateNotification: updateNotification2,
    hideNotification: hideNotification2,
    cleanQueue,
    clean
  };
}
var use_notifications_state_default = useNotificationsState;

// ../node_modules/@mantine/notifications/esm/Notifications/Notifications.js
var __defProp4 = Object.defineProperty;
var __getOwnPropSymbols4 = Object.getOwnPropertySymbols;
var __hasOwnProp4 = Object.prototype.hasOwnProperty;
var __propIsEnum4 = Object.prototype.propertyIsEnumerable;
var __defNormalProp4 = (obj, key, value) => key in obj ? __defProp4(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __spreadValues4 = (a, b2) => {
  for (var prop in b2 || (b2 = {}))
    if (__hasOwnProp4.call(b2, prop))
      __defNormalProp4(a, prop, b2[prop]);
  if (__getOwnPropSymbols4)
    for (var prop of __getOwnPropSymbols4(b2)) {
      if (__propIsEnum4.call(b2, prop))
        __defNormalProp4(a, prop, b2[prop]);
    }
  return a;
};
var __objRest2 = (source, exclude) => {
  var target = {};
  for (var prop in source)
    if (__hasOwnProp4.call(source, prop) && exclude.indexOf(prop) < 0)
      target[prop] = source[prop];
  if (source != null && __getOwnPropSymbols4)
    for (var prop of __getOwnPropSymbols4(source)) {
      if (exclude.indexOf(prop) < 0 && __propIsEnum4.call(source, prop))
        target[prop] = source[prop];
    }
  return target;
};
var POSITIONS = [
  "top-left",
  "top-right",
  "top-center",
  "bottom-left",
  "bottom-right",
  "bottom-center"
];
var Notifications = (_a2) => {
  var _b = _a2, {
    className,
    position = "bottom-right",
    autoClose = 4e3,
    transitionDuration = 250,
    containerWidth = rem(440),
    notificationMaxHeight = rem(200),
    limit = 5,
    zIndex = getDefaultZIndex("overlay"),
    style,
    children: children2,
    target
  } = _b, others = __objRest2(_b, [
    "className",
    "position",
    "autoClose",
    "transitionDuration",
    "containerWidth",
    "notificationMaxHeight",
    "limit",
    "zIndex",
    "style",
    "children",
    "target"
  ]);
  const forceUpdate = useForceUpdate();
  const refs = (0, import_react9.useRef)({});
  const previousLength = (0, import_react9.useRef)(0);
  const {
    notifications: notifications2,
    showNotification: showNotification2,
    updateNotification: updateNotification2,
    hideNotification: hideNotification2,
    clean,
    cleanQueue
  } = use_notifications_state_default({ limit });
  const { classes, cx, theme } = Notifications_styles_default({ zIndex });
  const shouldReduceMotion = useReducedMotion();
  const reduceMotion = theme.respectReducedMotion ? shouldReduceMotion : false;
  const duration = reduceMotion ? 1 : transitionDuration;
  const positioning = (POSITIONS.includes(position) ? position : "bottom-right").split("-");
  useDidUpdate(() => {
    if (notifications2.length > previousLength.current) {
      setTimeout(() => forceUpdate(), 0);
    }
    previousLength.current = notifications2.length;
  }, [notifications2]);
  useNotificationsEvents({
    show: showNotification2,
    hide: hideNotification2,
    update: updateNotification2,
    clean,
    cleanQueue
  });
  const items = notifications2.map((notification) => import_react9.default.createElement(Transition_default, {
    key: notification.id,
    timeout: duration,
    onEnter: () => refs.current[notification.id].offsetHeight,
    nodeRef: { current: refs.current[notification.id] }
  }, (state) => import_react9.default.createElement(NotificationContainer_default, {
    innerRef: (node) => {
      refs.current[notification.id] = node;
    },
    notification,
    onHide: hideNotification2,
    className: classes.notification,
    autoClose,
    sx: [
      __spreadValues4({}, get_notification_state_styles_default({
        state,
        positioning,
        transitionDuration: duration,
        maxHeight: notificationMaxHeight
      })),
      ...Array.isArray(notification.sx) ? notification.sx : [notification.sx]
    ]
  })));
  return import_react9.default.createElement(Portal, {
    target
  }, import_react9.default.createElement(Box, __spreadValues4({
    className: cx(classes.notifications, className),
    style,
    sx: __spreadValues4({
      maxWidth: containerWidth
    }, get_position_styles_default(positioning, theme.spacing.md))
  }, others), import_react9.default.createElement(TransitionGroup_default, null, items)));
};
Notifications.displayName = "@mantine/notifications/Notifications";
Notifications.show = notifications.show;
Notifications.hide = notifications.hide;
Notifications.update = notifications.update;
Notifications.clean = notifications.clean;
Notifications.cleanQueue = notifications.cleanQueue;

// ../node_modules/@medplum/react/dist/esm/index.mjs
var import_react17 = __toESM(require_react(), 1);
var import_react18 = __toESM(require_react(), 1);
var import_prop_types7 = __toESM(require_prop_types(), 1);
var import_react19 = __toESM(require_react(), 1);
var import_react20 = __toESM(require_react(), 1);
var import_react21 = __toESM(require_react(), 1);
var import_react22 = __toESM(require_react(), 1);
var import_react23 = __toESM(require_react(), 1);
var import_react24 = __toESM(require_react(), 1);
var import_react25 = __toESM(require_react(), 1);
var import_react26 = __toESM(require_react(), 1);
var import_react27 = __toESM(require_react(), 1);
var import_react28 = __toESM(require_react(), 1);
var import_react29 = __toESM(require_react(), 1);
var import_react30 = __toESM(require_react(), 1);
var import_react31 = __toESM(require_react(), 1);
var import_react32 = __toESM(require_react(), 1);
var import_react33 = __toESM(require_react(), 1);
var import_react34 = __toESM(require_react(), 1);
var import_react35 = __toESM(require_react(), 1);
var import_react36 = __toESM(require_react(), 1);
var import_react37 = __toESM(require_react(), 1);
var import_react38 = __toESM(require_react(), 1);
var import_react39 = __toESM(require_react(), 1);
var import_react40 = __toESM(require_react(), 1);
var import_react41 = __toESM(require_react(), 1);
var import_react42 = __toESM(require_react(), 1);
var import_react43 = __toESM(require_react(), 1);
var import_react44 = __toESM(require_react(), 1);
var import_react45 = __toESM(require_react(), 1);
var import_react46 = __toESM(require_react(), 1);
var import_react47 = __toESM(require_react(), 1);
var import_react48 = __toESM(require_react(), 1);
var import_react49 = __toESM(require_react(), 1);
var import_react50 = __toESM(require_react(), 1);
var import_react51 = __toESM(require_react(), 1);
var import_react52 = __toESM(require_react(), 1);
var import_react53 = __toESM(require_react(), 1);
var import_react54 = __toESM(require_react(), 1);
var import_react55 = __toESM(require_react(), 1);
var import_react56 = __toESM(require_react(), 1);
var import_react57 = __toESM(require_react(), 1);
var import_react58 = __toESM(require_react(), 1);
var import_react59 = __toESM(require_react(), 1);
var import_react60 = __toESM(require_react(), 1);
var import_react61 = __toESM(require_react(), 1);
var import_react62 = __toESM(require_react(), 1);
var import_react63 = __toESM(require_react(), 1);
var import_react64 = __toESM(require_react(), 1);
var import_react65 = __toESM(require_react(), 1);
var import_react66 = __toESM(require_react(), 1);
var import_react67 = __toESM(require_react(), 1);
var import_react68 = __toESM(require_react(), 1);
var import_react69 = __toESM(require_react(), 1);
var import_react70 = __toESM(require_react(), 1);
var import_react71 = __toESM(require_react(), 1);
var import_react72 = __toESM(require_react(), 1);
var import_react73 = __toESM(require_react(), 1);
var import_react74 = __toESM(require_react(), 1);
var import_react75 = __toESM(require_react(), 1);
var import_react76 = __toESM(require_react(), 1);
var import_react77 = __toESM(require_react(), 1);
var import_react78 = __toESM(require_react(), 1);
var import_react79 = __toESM(require_react(), 1);
var import_react80 = __toESM(require_react(), 1);
var import_react81 = __toESM(require_react(), 1);
var import_react82 = __toESM(require_react(), 1);
var import_react83 = __toESM(require_react(), 1);
var import_react84 = __toESM(require_react(), 1);
var import_react85 = __toESM(require_react(), 1);
var import_react86 = __toESM(require_react(), 1);
var import_react87 = __toESM(require_react(), 1);
var import_react88 = __toESM(require_react(), 1);
var import_react89 = __toESM(require_react(), 1);
var import_react90 = __toESM(require_react(), 1);
var import_react91 = __toESM(require_react(), 1);
var import_react92 = __toESM(require_react(), 1);
var import_react93 = __toESM(require_react(), 1);
var import_react94 = __toESM(require_react(), 1);
var import_react95 = __toESM(require_react(), 1);
var import_react96 = __toESM(require_react(), 1);
var import_react97 = __toESM(require_react(), 1);
var import_react98 = __toESM(require_react(), 1);
var import_react99 = __toESM(require_react(), 1);
var import_react100 = __toESM(require_react(), 1);
var import_react101 = __toESM(require_react(), 1);
var import_react102 = __toESM(require_react(), 1);
var import_react103 = __toESM(require_react(), 1);
var import_react104 = __toESM(require_react(), 1);
var import_react105 = __toESM(require_react(), 1);
var import_react106 = __toESM(require_react(), 1);
var import_react107 = __toESM(require_react(), 1);
var import_react108 = __toESM(require_react(), 1);
var import_react109 = __toESM(require_react(), 1);
var import_react110 = __toESM(require_react(), 1);
var import_react111 = __toESM(require_react(), 1);
var import_react112 = __toESM(require_react(), 1);
var import_react113 = __toESM(require_react(), 1);
var import_react114 = __toESM(require_react(), 1);
var import_react115 = __toESM(require_react(), 1);
var import_react116 = __toESM(require_react(), 1);
var import_react117 = __toESM(require_react(), 1);
var import_react118 = __toESM(require_react(), 1);
var import_react119 = __toESM(require_react(), 1);
var import_react120 = __toESM(require_react(), 1);
var import_react121 = __toESM(require_react(), 1);
var import_react122 = __toESM(require_react(), 1);
var import_react123 = __toESM(require_react(), 1);
var import_react124 = __toESM(require_react(), 1);
var import_react125 = __toESM(require_react(), 1);
var import_react126 = __toESM(require_react(), 1);
var import_react127 = __toESM(require_react(), 1);
var hn2 = (0, import_react11.createContext)(void 0);
function Xo() {
  return (0, import_react11.useContext)(hn2);
}
function P2() {
  return Xo().medplum;
}
function Qe() {
  return Xo().navigate;
}
function gt() {
  return Xo().profile;
}
function BC(e) {
  let o = e.medplum, t = e.navigate ?? yi, [r, a] = (0, import_react10.useState)({ profile: o.getProfile(), loading: false });
  (0, import_react10.useEffect)(() => {
    function f() {
      a({ ...r, profile: o.getProfile() });
    }
    return o.addEventListener("change", f), () => o.removeEventListener("change", f);
  }, [o, r]);
  let n = (0, import_react10.useMemo)(() => ({ ...r, medplum: o, navigate: t }), [r, o, t]);
  return import_react10.default.createElement(hn2.Provider, { value: n }, e.children);
}
function yi(e) {
  window.location.assign(e);
}
function z2(e, o) {
  let t = P2(), [r, a] = (0, import_react12.useState)(gn(t, e)), n = (0, import_react12.useCallback)((f) => {
    ve(f, r) || a(f);
  }, [r, a]);
  return (0, import_react12.useEffect)(() => {
    n(gn(t, e));
  }, [t, e, n]), (0, import_react12.useEffect)(() => {
    let f = true;
    return ae(e) && t.readReference(e).then((s) => {
      f && n(s);
    }).catch((s) => {
      f && (n(void 0), o && o(Oe(s)));
    }), () => f = false;
  }, [t, r, e, n, o]), r;
}
function gn(e, o) {
  if (o) {
    if (N(o))
      return o;
    if (ae(o))
      return e.getCachedReference(o);
  }
}
function OC(e, o) {
  return Dr("search", e, o);
}
function yn(e, o) {
  return Dr("searchOne", e, o);
}
function vn(e, o) {
  return Dr("searchResources", e, o);
}
function Dr(e, o, t) {
  let r = P2(), [a, n] = (0, import_react13.useState)(), [f, s] = (0, import_react13.useState)(false), [l, i] = (0, import_react13.useState)(), [u2, c] = (0, import_react13.useState)();
  return (0, import_react13.useEffect)(() => {
    let d = r.fhirSearchUrl(o, t).toString();
    d !== a && (n(d), r[e](o, t).then((x) => {
      s(false), i(x), c(ps);
    }).catch((x) => {
      s(false), i(void 0), c(Oe(x));
    }));
  }, [r, e, o, t, a, i]), [l, f, u2];
}
function bn(e) {
  let o = e.value;
  return o ? import_react14.default.createElement(import_react14.default.Fragment, null, Jo(o)) : null;
}
function Dn(e, o) {
  return e.line && e.line.length > o ? e.line[o] : "";
}
function Tn(e, o, t) {
  let r = e.line || [];
  for (; r.length <= o; )
    r.push("");
  return r[o] = t, { ...e, line: r };
}
function kn(e) {
  let [o, t] = (0, import_react15.useState)(e.defaultValue || {}), r = (0, import_react15.useRef)();
  r.current = o;
  function a(d) {
    t(d), e.onChange && e.onChange(d);
  }
  function n(d) {
    a({ ...r.current, use: d });
  }
  function f(d) {
    a({ ...r.current, type: d });
  }
  function s(d) {
    a(Tn(r.current || {}, 0, d));
  }
  function l(d) {
    a(Tn(r.current || {}, 1, d));
  }
  function i(d) {
    a({ ...r.current, city: d });
  }
  function u2(d) {
    a({ ...r.current, state: d });
  }
  function c(d) {
    a({ ...r.current, postalCode: d });
  }
  return import_react15.default.createElement(Group, { spacing: "xs", grow: true, noWrap: true }, import_react15.default.createElement(NativeSelect, { "data-testid": "address-use", defaultValue: o.use, onChange: (d) => n(d.currentTarget.value), data: ["", "home", "work", "temp", "old", "billing"] }), import_react15.default.createElement(NativeSelect, { "data-testid": "address-type", defaultValue: o.type, onChange: (d) => f(d.currentTarget.value), data: ["", "postal", "physical", "both"] }), import_react15.default.createElement(TextInput, { placeholder: "Line 1", defaultValue: Dn(o, 0), onChange: (d) => s(d.currentTarget.value) }), import_react15.default.createElement(TextInput, { placeholder: "Line 2", defaultValue: Dn(o, 1), onChange: (d) => l(d.currentTarget.value) }), import_react15.default.createElement(TextInput, { placeholder: "City", defaultValue: o.city, onChange: (d) => i(d.currentTarget.value) }), import_react15.default.createElement(TextInput, { placeholder: "State", defaultValue: o.state, onChange: (d) => u2(d.currentTarget.value) }), import_react15.default.createElement(TextInput, { placeholder: "Postal Code", defaultValue: o.postalCode, onChange: (d) => c(d.currentTarget.value) }));
}
function Bn(e) {
  let o = gt(), [t, r] = (0, import_react16.useState)(e.defaultValue || {}), a = (0, import_react16.useRef)();
  a.current = t;
  function n(f) {
    let s = f ? { text: f, authorReference: o && G(o), time: (/* @__PURE__ */ new Date()).toISOString() } : {};
    r(s), e.onChange && e.onChange(s);
  }
  return import_react16.default.createElement(TextInput, { name: e.name, placeholder: "Annotation text", defaultValue: t.text, onChange: (f) => n(f.currentTarget.value) });
}
var An = { xmlns: "http://www.w3.org/2000/svg", width: 24, height: 24, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: 2, strokeLinecap: "round", strokeLinejoin: "round" };
var Vi = Object.defineProperty;
var qi = Object.defineProperties;
var Gi = Object.getOwnPropertyDescriptors;
var ht = Object.getOwnPropertySymbols;
var On = Object.prototype.hasOwnProperty;
var En = Object.prototype.propertyIsEnumerable;
var Fn2 = (e, o, t) => o in e ? Vi(e, o, { enumerable: true, configurable: true, writable: true, value: t }) : e[o] = t;
var wn = (e, o) => {
  for (var t in o || (o = {}))
    On.call(o, t) && Fn2(e, t, o[t]);
  if (ht)
    for (var t of ht(o))
      En.call(o, t) && Fn2(e, t, o[t]);
  return e;
};
var Ui = (e, o) => qi(e, Gi(o));
var Qi = (e, o) => {
  var t = {};
  for (var r in e)
    On.call(e, r) && o.indexOf(r) < 0 && (t[r] = e[r]);
  if (e != null && ht)
    for (var r of ht(e))
      o.indexOf(r) < 0 && En.call(e, r) && (t[r] = e[r]);
  return t;
};
var p = (e, o, t) => {
  let r = (0, import_react18.forwardRef)((a, n) => {
    var f = a, { color: s = "currentColor", size: l = 24, stroke: i = 2, children: u2 } = f, c = Qi(f, ["color", "size", "stroke", "children"]);
    return (0, import_react18.createElement)("svg", wn(Ui(wn({ ref: n }, An), { width: l, height: l, stroke: s, strokeWidth: i, className: `tabler-icon tabler-icon-${e}` }), c), [...t.map(([d, x]) => (0, import_react18.createElement)(d, x)), ...u2 || []]);
  });
  return r.propTypes = { color: import_prop_types7.default.string, size: import_prop_types7.default.oneOfType([import_prop_types7.default.string, import_prop_types7.default.number]), stroke: import_prop_types7.default.oneOfType([import_prop_types7.default.string, import_prop_types7.default.number]) }, r.displayName = `${o}`, r;
};
var Tr = p("adjustments-horizontal", "IconAdjustmentsHorizontal", [["path", { d: "M14 6m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0", key: "svg-0" }], ["path", { d: "M4 6l8 0", key: "svg-1" }], ["path", { d: "M16 6l4 0", key: "svg-2" }], ["path", { d: "M8 12m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0", key: "svg-3" }], ["path", { d: "M4 12l2 0", key: "svg-4" }], ["path", { d: "M10 12l10 0", key: "svg-5" }], ["path", { d: "M17 18m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0", key: "svg-6" }], ["path", { d: "M4 18l11 0", key: "svg-7" }], ["path", { d: "M19 18l1 0", key: "svg-8" }]]);
var no = p("alert-circle", "IconAlertCircle", [["path", { d: "M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0", key: "svg-0" }], ["path", { d: "M12 8v4", key: "svg-1" }], ["path", { d: "M12 16h.01", key: "svg-2" }]]);
var kr2 = p("arrow-down", "IconArrowDown", [["path", { d: "M12 5l0 14", key: "svg-0" }], ["path", { d: "M18 13l-6 6", key: "svg-1" }], ["path", { d: "M6 13l6 6", key: "svg-2" }]]);
var Br = p("arrow-up", "IconArrowUp", [["path", { d: "M12 5l0 14", key: "svg-0" }], ["path", { d: "M18 11l-6 -6", key: "svg-1" }], ["path", { d: "M6 11l6 -6", key: "svg-2" }]]);
var Ar = p("bleach-off", "IconBleachOff", [["path", { d: "M5 19h14m1.986 -1.977a2 2 0 0 0 -.146 -.773l-7.1 -12.25a2 2 0 0 0 -3.5 0l-.815 1.405m-1.488 2.568l-4.797 8.277a2 2 0 0 0 1.75 2.75", key: "svg-0" }], ["path", { d: "M3 3l18 18", key: "svg-1" }]]);
var Mr = p("bleach", "IconBleach", [["path", { d: "M5 19h14a2 2 0 0 0 1.84 -2.75l-7.1 -12.25a2 2 0 0 0 -3.5 0l-7.1 12.25a2 2 0 0 0 1.75 2.75", key: "svg-0" }]]);
var Fr = p("box-multiple", "IconBoxMultiple", [["path", { d: "M7 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z", key: "svg-0" }], ["path", { d: "M17 17v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-10a2 2 0 0 1 2 -2h2", key: "svg-1" }]]);
var wr = p("brackets-contain", "IconBracketsContain", [["path", { d: "M7 4h-4v16h4", key: "svg-0" }], ["path", { d: "M17 4h4v16h-4", key: "svg-1" }], ["path", { d: "M8 16h.01", key: "svg-2" }], ["path", { d: "M12 16h.01", key: "svg-3" }], ["path", { d: "M16 16h.01", key: "svg-4" }]]);
var Or2 = p("bucket-off", "IconBucketOff", [["path", { d: "M5.029 5.036c-.655 .58 -1.029 1.25 -1.029 1.964c0 2.033 3.033 3.712 6.96 3.967m3.788 -.21c3.064 -.559 5.252 -2.029 5.252 -3.757c0 -2.21 -3.582 -4 -8 -4c-1.605 0 -3.1 .236 -4.352 .643", key: "svg-0" }], ["path", { d: "M4 7c0 .664 .088 1.324 .263 1.965l2.737 10.035c.5 1.5 2.239 2 5 2s4.5 -.5 5 -2c.1 -.3 .252 -.812 .457 -1.535m.862 -3.146c.262 -.975 .735 -2.76 1.418 -5.354a7.45 7.45 0 0 0 .263 -1.965", key: "svg-1" }], ["path", { d: "M3 3l18 18", key: "svg-2" }]]);
var Er = p("bucket", "IconBucket", [["path", { d: "M12 7m-8 0a8 4 0 1 0 16 0a8 4 0 1 0 -16 0", key: "svg-0" }], ["path", { d: "M4 7c0 .664 .088 1.324 .263 1.965l2.737 10.035c.5 1.5 2.239 2 5 2s4.5 -.5 5 -2c.333 -1 1.246 -4.345 2.737 -10.035a7.45 7.45 0 0 0 .263 -1.965", key: "svg-1" }]]);
var He = p("calendar", "IconCalendar", [["path", { d: "M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z", key: "svg-0" }], ["path", { d: "M16 3v4", key: "svg-1" }], ["path", { d: "M8 3v4", key: "svg-2" }], ["path", { d: "M4 11h16", key: "svg-3" }], ["path", { d: "M11 15h1", key: "svg-4" }], ["path", { d: "M12 15v3", key: "svg-5" }]]);
var $o = p("check", "IconCheck", [["path", { d: "M5 12l5 5l10 -10", key: "svg-0" }]]);
var Lr = p("checkbox", "IconCheckbox", [["path", { d: "M9 11l3 3l8 -8", key: "svg-0" }], ["path", { d: "M20 12v6a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h9", key: "svg-1" }]]);
var Rr = p("chevron-down", "IconChevronDown", [["path", { d: "M6 9l6 6l6 -6", key: "svg-0" }]]);
var We = p("circle-minus", "IconCircleMinus", [["path", { d: "M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0", key: "svg-0" }], ["path", { d: "M9 12l6 0", key: "svg-1" }]]);
var go = p("circle-plus", "IconCirclePlus", [["path", { d: "M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0", key: "svg-0" }], ["path", { d: "M9 12h6", key: "svg-1" }], ["path", { d: "M12 9v6", key: "svg-2" }]]);
var Ko = p("cloud-upload", "IconCloudUpload", [["path", { d: "M7 18a4.6 4.4 0 0 1 0 -9a5 4.5 0 0 1 11 2h1a3.5 3.5 0 0 1 0 7h-1", key: "svg-0" }], ["path", { d: "M9 15l3 -3l3 3", key: "svg-1" }], ["path", { d: "M12 12l0 9", key: "svg-2" }]]);
var Nr = p("columns", "IconColumns", [["path", { d: "M4 6l5.5 0", key: "svg-0" }], ["path", { d: "M4 10l5.5 0", key: "svg-1" }], ["path", { d: "M4 14l5.5 0", key: "svg-2" }], ["path", { d: "M4 18l5.5 0", key: "svg-3" }], ["path", { d: "M14.5 6l5.5 0", key: "svg-4" }], ["path", { d: "M14.5 10l5.5 0", key: "svg-5" }], ["path", { d: "M14.5 14l5.5 0", key: "svg-6" }], ["path", { d: "M14.5 18l5.5 0", key: "svg-7" }]]);
var Hr = p("copy", "IconCopy", [["path", { d: "M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z", key: "svg-0" }], ["path", { d: "M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2", key: "svg-1" }]]);
var Vr = p("currency-dollar", "IconCurrencyDollar", [["path", { d: "M16.7 8a3 3 0 0 0 -2.7 -2h-4a3 3 0 0 0 0 6h4a3 3 0 0 1 0 6h-4a3 3 0 0 1 -2.7 -2", key: "svg-0" }], ["path", { d: "M12 3v3m0 12v3", key: "svg-1" }]]);
var qr = p("dots", "IconDots", [["path", { d: "M5 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0", key: "svg-0" }], ["path", { d: "M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0", key: "svg-1" }], ["path", { d: "M19 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0", key: "svg-2" }]]);
var Gr = p("edit", "IconEdit", [["path", { d: "M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1", key: "svg-0" }], ["path", { d: "M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z", key: "svg-1" }], ["path", { d: "M16 5l3 3", key: "svg-2" }]]);
var ho = p("equal-not", "IconEqualNot", [["path", { d: "M5 10h14", key: "svg-0" }], ["path", { d: "M5 14h14", key: "svg-1" }], ["path", { d: "M5 19l14 -14", key: "svg-2" }]]);
var Co = p("equal", "IconEqual", [["path", { d: "M5 10h14", key: "svg-0" }], ["path", { d: "M5 14h14", key: "svg-1" }]]);
var Ct = p("file-alert", "IconFileAlert", [["path", { d: "M14 3v4a1 1 0 0 0 1 1h4", key: "svg-0" }], ["path", { d: "M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z", key: "svg-1" }], ["path", { d: "M12 17l.01 0", key: "svg-2" }], ["path", { d: "M12 11l0 3", key: "svg-3" }]]);
var Ur = p("file-plus", "IconFilePlus", [["path", { d: "M14 3v4a1 1 0 0 0 1 1h4", key: "svg-0" }], ["path", { d: "M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z", key: "svg-1" }], ["path", { d: "M12 11l0 6", key: "svg-2" }], ["path", { d: "M9 14l6 0", key: "svg-3" }]]);
var Qr = p("filter", "IconFilter", [["path", { d: "M4 4h16v2.172a2 2 0 0 1 -.586 1.414l-4.414 4.414v7l-6 2v-8.5l-4.48 -4.928a2 2 0 0 1 -.52 -1.345v-2.227z", key: "svg-0" }]]);
var zr = p("list-details", "IconListDetails", [["path", { d: "M13 5h8", key: "svg-0" }], ["path", { d: "M13 9h5", key: "svg-1" }], ["path", { d: "M13 15h8", key: "svg-2" }], ["path", { d: "M13 19h5", key: "svg-3" }], ["path", { d: "M3 4m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z", key: "svg-4" }], ["path", { d: "M3 14m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z", key: "svg-5" }]]);
var Wr = p("logout", "IconLogout", [["path", { d: "M14 8v-2a2 2 0 0 0 -2 -2h-7a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h7a2 2 0 0 0 2 -2v-2", key: "svg-0" }], ["path", { d: "M9 12h12l-3 -3", key: "svg-1" }], ["path", { d: "M18 15l3 -3", key: "svg-2" }]]);
var yt2 = p("math-greater", "IconMathGreater", [["path", { d: "M5 18l14 -6l-14 -6", key: "svg-0" }]]);
var vt = p("math-lower", "IconMathLower", [["path", { d: "M19 18l-14 -6l14 -6", key: "svg-0" }]]);
var Xr = p("message", "IconMessage", [["path", { d: "M8 9h8", key: "svg-0" }], ["path", { d: "M8 13h6", key: "svg-1" }], ["path", { d: "M18 4a3 3 0 0 1 3 3v8a3 3 0 0 1 -3 3h-5l-5 3v-3h-2a3 3 0 0 1 -3 -3v-8a3 3 0 0 1 3 -3h12z", key: "svg-2" }]]);
var Jr = p("pin", "IconPin", [["path", { d: "M15 4.5l-4 4l-4 1.5l-1.5 1.5l7 7l1.5 -1.5l1.5 -4l4 -4", key: "svg-0" }], ["path", { d: "M9 15l-4.5 4.5", key: "svg-1" }], ["path", { d: "M14.5 4l5.5 5.5", key: "svg-2" }]]);
var $r = p("pinned-off", "IconPinnedOff", [["path", { d: "M3 3l18 18", key: "svg-0" }], ["path", { d: "M15 4.5l-3.249 3.249m-2.57 1.433l-2.181 .818l-1.5 1.5l7 7l1.5 -1.5l.82 -2.186m1.43 -2.563l3.25 -3.251", key: "svg-1" }], ["path", { d: "M9 15l-4.5 4.5", key: "svg-2" }], ["path", { d: "M14.5 4l5.5 5.5", key: "svg-3" }]]);
var Kr = p("plus", "IconPlus", [["path", { d: "M12 5l0 14", key: "svg-0" }], ["path", { d: "M5 12l14 0", key: "svg-1" }]]);
var jr = p("refresh", "IconRefresh", [["path", { d: "M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4", key: "svg-0" }], ["path", { d: "M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4", key: "svg-1" }]]);
var _r = p("search", "IconSearch", [["path", { d: "M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0", key: "svg-0" }], ["path", { d: "M21 21l-6 -6", key: "svg-1" }]]);
var yo = p("settings", "IconSettings", [["path", { d: "M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z", key: "svg-0" }], ["path", { d: "M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0", key: "svg-1" }]]);
var jo = p("sort-ascending", "IconSortAscending", [["path", { d: "M4 6l7 0", key: "svg-0" }], ["path", { d: "M4 12l7 0", key: "svg-1" }], ["path", { d: "M4 18l9 0", key: "svg-2" }], ["path", { d: "M15 9l3 -3l3 3", key: "svg-3" }], ["path", { d: "M18 6l0 12", key: "svg-4" }]]);
var _o = p("sort-descending", "IconSortDescending", [["path", { d: "M4 6l9 0", key: "svg-0" }], ["path", { d: "M4 12l7 0", key: "svg-1" }], ["path", { d: "M4 18l7 0", key: "svg-2" }], ["path", { d: "M15 15l3 3l3 -3", key: "svg-3" }], ["path", { d: "M18 6l0 12", key: "svg-4" }]]);
var Zr = p("square", "IconSquare", [["path", { d: "M3 3m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z", key: "svg-0" }]]);
var Yr = p("switch-horizontal", "IconSwitchHorizontal", [["path", { d: "M16 3l4 4l-4 4", key: "svg-0" }], ["path", { d: "M10 7l10 0", key: "svg-1" }], ["path", { d: "M8 13l-4 4l4 4", key: "svg-2" }], ["path", { d: "M4 17l9 0", key: "svg-3" }]]);
var ea = p("table-export", "IconTableExport", [["path", { d: "M12.5 21h-7.5a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v7.5", key: "svg-0" }], ["path", { d: "M3 10h18", key: "svg-1" }], ["path", { d: "M10 3v18", key: "svg-2" }], ["path", { d: "M16 19h6", key: "svg-3" }], ["path", { d: "M19 16l3 3l-3 3", key: "svg-4" }]]);
var Zo = p("trash", "IconTrash", [["path", { d: "M4 7l16 0", key: "svg-0" }], ["path", { d: "M10 11l0 6", key: "svg-1" }], ["path", { d: "M14 11l0 6", key: "svg-2" }], ["path", { d: "M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12", key: "svg-3" }], ["path", { d: "M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3", key: "svg-4" }]]);
var oa = p("x", "IconX", [["path", { d: "M18 6l-12 12", key: "svg-0" }], ["path", { d: "M6 6l12 12", key: "svg-1" }]]);
var vo = class extends import_react19.default.Component {
  constructor(t) {
    super(t);
    this.state = {};
  }
  static getDerivedStateFromError(t) {
    return { error: t };
  }
  componentDidCatch(t, r) {
    console.error("Uncaught error:", t, r);
  }
  render() {
    return this.state.error ? import_react19.default.createElement(Alert, { icon: import_react19.default.createElement(no, { size: 16 }), title: "Something went wrong", color: "red" }, Kn(this.state.error)) : this.props.children;
  }
};
function ra() {
  return import_react20.default.createElement(Center, { style: { width: "100%", height: "100vh" } }, import_react20.default.createElement(Loader, null));
}
function St(e) {
  let o = e.value;
  return o ? import_react22.default.createElement(import_react22.default.Fragment, null, Re(o, e.options)) : null;
}
function R(e) {
  e.preventDefault(), e.stopPropagation();
}
function bt(e) {
  if (Nn2(e))
    return true;
  if (e instanceof HTMLTableCellElement) {
    let o = e.children;
    if (o.length === 1 && Nn2(o[0]))
      return true;
  }
  return false;
}
function Nn2(e) {
  return e instanceof HTMLInputElement && e.type === "checkbox";
}
function le(e) {
  let o = Qe(), { to: t, suffix: r, label: a, onClick: n, children: f, ...s } = e, l = Yi(t);
  return r && (l += "/" + r), import_react24.default.createElement(Anchor, { href: l, "aria-label": a, onClick: (i) => {
    R(i), n ? n(i) : t && o(l);
  }, ...s }, f);
}
function Yi(e) {
  if (e) {
    if (typeof e == "string")
      return eu(e);
    if (N(e))
      return ou(e);
    if (ae(e))
      return tu(e);
  }
  return "#";
}
function eu(e) {
  return e.startsWith("http://") || e.startsWith("https://") || e.startsWith("/") ? e : "/" + e;
}
function ou(e) {
  return `/${e.resourceType}/${e.id}`;
}
function tu(e) {
  return `/${e.reference}`;
}
function ge(e) {
  let o = z2(e.value), t = o ? hn(o) : e.alt ?? "", r = (o && Io(o)) ?? e.src, a = e.radius ?? "xl", n = { ...e };
  return delete n.value, delete n.link, e.link ? import_react23.default.createElement(le, { to: o }, import_react23.default.createElement(Avatar, { src: r, alt: t, radius: a, ...n })) : import_react23.default.createElement(Avatar, { src: r, alt: t, radius: a, ...n });
}
function Do(e) {
  let { defaultValue: o, toKey: t, toOption: r, loadOptions: a, onChange: n, onCreate: f, creatable: s, ...l } = e, i = uu(o), u2 = (0, import_react26.useRef)(null), [c, d] = (0, import_react26.useState)(), [x, y] = (0, import_react26.useState)(), [g, T2] = (0, import_react26.useState)(), [B, k2] = (0, import_react26.useState)(), [A, W] = (0, import_react26.useState)(i.map(r)), [v, L] = (0, import_react26.useState)([]), Z = (0, import_react26.useRef)();
  Z.current = c;
  let ae2 = (0, import_react26.useRef)();
  ae2.current = x;
  let Re2 = (0, import_react26.useRef)();
  Re2.current = g;
  let ro = (0, import_react26.useRef)();
  ro.current = B;
  let ce = (0, import_react26.useRef)();
  ce.current = v;
  let h = (0, import_react26.useCallback)(() => {
    var _a2;
    y(void 0);
    let ne = ((_a2 = u2.current) == null ? void 0 : _a2.value.trim()) || "";
    if (ne === Z.current)
      return;
    d(ne);
    let oe = new AbortController();
    T2(oe), a(ne, oe.signal).then((ve2) => {
      oe.signal.aborted || (L(ve2.map(r)), T2(void 0), ro.current && (ve2.length > 0 && n(ve2.slice(0, 1)), k2(false)));
    }).catch((ve2) => {
      oe.signal.aborted || ve2.message.includes("aborted") || showNotification({ color: "red", message: Kn(ve2) });
    });
  }, [a, n, r]), H = (0, import_react26.useCallback)(() => {
    Re2.current && (Re2.current.abort(), T2(void 0)), ae2.current !== void 0 && window.clearTimeout(ae2.current);
    let ne = window.setTimeout(() => h(), 100);
    y(ne);
  }, [h]), we = (0, import_react26.useCallback)((ne) => {
    var _a2;
    let oe = [], ve2 = [];
    for (let xn of ne) {
      let xt = (_a2 = ce.current) == null ? void 0 : _a2.find((mi) => mi.value === xn), Wo = xt == null ? void 0 : xt.resource;
      !Wo && s !== false && f && (Wo = f(xn), xt = r(Wo)), Wo && oe.push(Wo), xt && ve2.push(xt);
    }
    n(oe), W(ve2);
  }, [s, n, f, r]), C = (0, import_react26.useCallback)((ne) => {
    ne.key === "Enter" && (!ae2.current && !Re2.current ? (R(ne), ce.current && ce.current.length > 0 && (L(ce.current.slice(0, 1)), we([ce.current[0].value]))) : k2(true));
  }, [we]), U = (0, import_react26.useCallback)((ne) => {
    let oe = r(f(ne));
    return L([...ce.current, oe]), oe;
  }, [f, L, r]), Ne = (0, import_react26.useCallback)((ne, oe) => !oe, []);
  return (0, import_react26.useEffect)(() => () => {
    Re2.current && Re2.current.abort();
  }, []), import_react26.default.createElement(MultiSelect, { ...l, ref: u2, defaultValue: i.map(t), searchable: true, onKeyDown: C, onSearchChange: H, data: [...A, ...v], onFocus: h, onChange: we, onCreate: U, rightSectionWidth: 40, rightSection: g ? import_react26.default.createElement(Loader, { size: 16 }) : null, filter: Ne, creatable: true, withinPortal: true });
}
function uu(e) {
  return e ? Array.isArray(e) ? e : [e] : [];
}
var gu = createStyles(() => ({ searchInput: { input: { width: 220, transition: "width 0.2s" }, "input:focus": { width: 400 }, "@media (max-width: 800px)": { input: { width: 150 }, "input:focus": { width: 150 } } } }));
function hu(e) {
  return e.id;
}
function Cu(e) {
  return { value: e.id, label: hn(e), resource: e };
}
function Wn2(e) {
  let { classes: o } = gu(), t = Qe(), r = P2(), a = (0, import_react25.useCallback)(async (f, s) => {
    let l = vu(f), i = { signal: s }, u2 = await r.graphql(l, void 0, void 0, i);
    return Su(u2, f);
  }, [r]), n = (0, import_react25.useCallback)((f) => {
    f.length > 0 && t(`/${se(f[0])}`);
  }, [t]);
  return import_react25.default.createElement(Do, { key: `${e.pathname}?${e.searchParams}`, size: "sm", radius: "md", className: o.searchInput, icon: import_react25.default.createElement(_r, { size: 16 }), placeholder: "Search", itemComponent: yu, toKey: hu, toOption: Cu, onChange: n, loadOptions: a, maxSelectedValues: 0, clearSearchOnChange: true, clearable: false });
}
var yu = (0, import_react25.forwardRef)(({ resource: e, ...o }, t) => {
  var _a2;
  let r;
  return e.resourceType === "Patient" ? r = e.birthDate : e.resourceType === "ServiceRequest" && (r = (_a2 = e.subject) == null ? void 0 : _a2.display), import_react25.default.createElement("div", { ref: t, ...o }, import_react25.default.createElement(Group, { noWrap: true }, import_react25.default.createElement(ge, { value: e }), import_react25.default.createElement("div", null, import_react25.default.createElement(Text, null, hn(e)), import_react25.default.createElement(Text, { size: "xs", color: "dimmed" }, r))));
});
function vu(e) {
  let o = JSON.stringify(e);
  return Lo(e) ? `{
      Patients1: PatientList(_id: ${o}, _count: 1) {
        resourceType
        id
        identifier {
          system
          value
        }
        name {
          given
          family
        }
        birthDate
      }
      ServiceRequestList(_id: ${o}, _count: 1) {
        resourceType
        id
        identifier {
          system
          value
        }
        subject {
          display
        }
      }
    }`.replace(/\s+/g, " ") : `{
    Patients1: PatientList(name: ${o}, _count: 5) {
      resourceType
      id
      identifier {
        system
        value
      }
      name {
        given
        family
      }
      birthDate
    }
    Patients2: PatientList(identifier: ${o}, _count: 5) {
      resourceType
      id
      identifier {
        system
        value
      }
      name {
        given
        family
      }
      birthDate
    }
    ServiceRequestList(identifier: ${o}, _count: 5) {
      resourceType
      id
      identifier {
        system
        value
      }
      subject {
        display
      }
    }
  }`.replace(/\s+/g, " ");
}
function Su(e, o) {
  let t = [];
  return e.data.Patients1 && t.push(...e.data.Patients1), e.data.Patients2 && t.push(...e.data.Patients2), e.data.ServiceRequestList && t.push(...e.data.ServiceRequestList), Pu(bu(t), o).slice(0, 5);
}
function bu(e) {
  let o = /* @__PURE__ */ new Set(), t = [];
  for (let r of e)
    o.has(r.id) || (o.add(r.id), t.push(r));
  return t;
}
function Pu(e, o) {
  return e.sort((t, r) => Un(r, o) - Un(t, o));
}
function Un(e, o) {
  let t = 0;
  if (e.identifier)
    for (let r of e.identifier)
      t = Math.max(t, Qn(r.value, o));
  if (e.resourceType === "Patient" && e.name)
    for (let r of e.name)
      t = Math.max(t, Qn(Re(r), o));
  return t;
}
function Qn(e, o) {
  if (!e)
    return 0;
  let t = e.toLowerCase().indexOf(o.toLowerCase());
  return t < 0 ? 0 : 100 - t;
}
var Fu = createStyles((e) => ({ logoButton: { padding: `${e.spacing.xs} ${e.spacing.sm}`, borderRadius: e.radius.sm, transition: "background-color 100ms ease", "&:hover": { backgroundColor: e.fn.lighten(e.fn.variant({ variant: "filled", color: e.primaryColor }).background, 0.8) } }, user: { padding: `${e.spacing.xs} ${e.spacing.sm}`, borderRadius: e.radius.sm, transition: "background-color 100ms ease", "&:hover": { backgroundColor: e.fn.lighten(e.fn.variant({ variant: "filled", color: e.primaryColor }).background, 0.8) } }, userName: { fontWeight: 500, lineHeight: 1, marginRight: 3, [e.fn.smallerThan("xs")]: { display: "none" } }, userActive: { backgroundColor: e.fn.lighten(e.fn.variant({ variant: "filled", color: e.primaryColor }).background, 0.8) } }));
function $n(e) {
  var _a2, _b, _c2, _d2;
  let o = Xo(), { medplum: t, profile: r, navigate: a } = o, n = t.getLogins(), { classes: f, cx: s } = Fu(), [l, i] = (0, import_react21.useState)(false);
  return import_react21.default.createElement(Header, { height: 60, p: 8, style: { zIndex: 101 } }, import_react21.default.createElement(Group, { position: "apart" }, import_react21.default.createElement(Group, { spacing: "xs" }, import_react21.default.createElement(UnstyledButton, { className: f.logoButton, onClick: e.navbarToggle }, e.logo), !e.headerSearchDisabled && import_react21.default.createElement(Wn2, { pathname: e.pathname, searchParams: e.searchParams })), import_react21.default.createElement(Menu, { width: 260, shadow: "xl", position: "bottom-end", transitionProps: { transition: "pop-top-right" }, opened: l, onClose: () => i(false) }, import_react21.default.createElement(Menu.Target, null, import_react21.default.createElement(UnstyledButton, { className: s(f.user, { [f.userActive]: l }), onClick: () => i((u2) => !u2) }, import_react21.default.createElement(Group, { spacing: 7 }, import_react21.default.createElement(ge, { value: r, radius: "xl", size: 24 }), import_react21.default.createElement(Text, { size: "sm", className: f.userName }, Re((_a2 = r == null ? void 0 : r.name) == null ? void 0 : _a2[0])), import_react21.default.createElement(Rr, { size: 12, stroke: 1.5 })))), import_react21.default.createElement(Menu.Dropdown, null, import_react21.default.createElement(Stack, { align: "center", p: "xl" }, import_react21.default.createElement(ge, { size: "xl", radius: 100, value: o.profile }), import_react21.default.createElement(St, { value: (_c2 = (_b = o.profile) == null ? void 0 : _b.name) == null ? void 0 : _c2[0] }), import_react21.default.createElement(Text, { color: "dimmed", size: "xs" }, (_d2 = t.getActiveLogin()) == null ? void 0 : _d2.project.display)), n.length > 1 && import_react21.default.createElement(Menu.Divider, null), n.map((u2) => u2.profile.reference !== se(o.profile) && import_react21.default.createElement(Menu.Item, { key: u2.profile.reference, onClick: () => {
    t.setActiveLogin(u2).then(() => window.location.reload()).catch(console.log);
  } }, import_react21.default.createElement(Group, null, import_react21.default.createElement(Avatar, { radius: "xl" }), import_react21.default.createElement("div", { style: { flex: 1 } }, import_react21.default.createElement(Text, { size: "sm", weight: 500 }, u2.profile.display), import_react21.default.createElement(Text, { color: "dimmed", size: "xs" }, u2.project.display))))), import_react21.default.createElement(Menu.Divider, null), import_react21.default.createElement(Menu.Item, { icon: import_react21.default.createElement(Yr, { size: 14, stroke: 1.5 }), onClick: () => a("/signin") }, "Add another account"), import_react21.default.createElement(Menu.Item, { icon: import_react21.default.createElement(yo, { size: 14, stroke: 1.5 }), onClick: () => a(`/${se(r)}`) }, "Account settings"), import_react21.default.createElement(Menu.Item, { icon: import_react21.default.createElement(Wr, { size: 14, stroke: 1.5 }), onClick: async () => {
    await t.signOut(), a("/signin");
  } }, "Sign out"), import_react21.default.createElement(Text, { size: "xs", color: "dimmed", align: "center" }, e.version)))));
}
function Kn2(e) {
  let o = {};
  for (let t of Array.from(e.elements))
    t instanceof HTMLInputElement ? wu(o, t) : t instanceof HTMLTextAreaElement ? o[t.name] = t.value : t instanceof HTMLSelectElement && Ou(o, t);
  return o;
}
function wu(e, o) {
  o.disabled || (o.type === "checkbox" || o.type === "radio") && !o.checked || (e[o.name] = o.value);
}
function Ou(e, o) {
  e[o.name] = o.value;
}
function $(e) {
  return import_react29.default.createElement("form", { style: e.style, "data-testid": e.testid, onSubmit: (o) => {
    o.preventDefault();
    let t = Kn2(o.target);
    e.onSubmit && e.onSubmit(t);
  } }, e.children);
}
function _n2(e) {
  let o = P2(), t = o.getUserConfiguration();
  function r(a) {
    var _a2, _b, _c2;
    let { menuname: n, bookmarkname: f } = a, s = `${e.pathname}?${e.searchParams.toString()}`, l = it(t);
    (_c2 = (_b = (_a2 = l.menu) == null ? void 0 : _a2.find(({ title: u2 }) => u2 === n)) == null ? void 0 : _b.link) == null ? void 0 : _c2.push({ name: f, target: s }), o.updateResource(l).then((u2) => {
      t.menu = u2.menu, o.dispatchEvent({ type: "change" }), showNotification({ color: "green", message: "Success" }), e.onOk();
    }).catch((u2) => {
      showNotification({ color: "red", message: Kn(u2) });
    });
  }
  return import_react28.default.createElement(Modal, { title: "Add Bookmark", closeButtonProps: { "aria-label": "Close" }, opened: e.visible, onClose: e.onCancel }, import_react28.default.createElement($, { onSubmit: r }, import_react28.default.createElement(Stack, null, import_react28.default.createElement(Qu, { config: t }), import_react28.default.createElement(TextInput, { label: "Bookmark Name", type: "text", name: "bookmarkname", placeholder: "Bookmark Name", withAsterisk: true }), import_react28.default.createElement(Group, { position: "right" }, import_react28.default.createElement(Button, { mt: "sm", type: "submit" }, "OK")))));
}
function Qu(e) {
  function o(r) {
    var _a2;
    return (_a2 = r == null ? void 0 : r.menu) == null ? void 0 : _a2.map((a) => a.title);
  }
  let t = o(e.config);
  return import_react28.default.createElement(NativeSelect, { name: "menuname", defaultValue: t[0], label: "Select Menu Option", placeholder: "Menu", data: t, withAsterisk: true });
}
function na(e) {
  return typeof e.code == "string" ? e.code : JSON.stringify(e);
}
function Xu(e) {
  return typeof e.display == "string" ? e.display : na(e);
}
function Ju(e) {
  return { value: na(e), label: Xu(e), resource: e };
}
function $u(e) {
  return { code: e, display: e };
}
function To(e) {
  let o = P2(), { binding: t, creatable: r, clearable: a, ...n } = e, f = (0, import_react32.useCallback)(async (s, l) => {
    var _a2;
    if (!t)
      return [];
    let u2 = (_a2 = (await o.searchValueSet(t, s, { signal: l })).expansion) == null ? void 0 : _a2.contains, c = [];
    for (let d of u2)
      d.code && !c.some((x) => x.code === d.code) && c.push(d);
    return c;
  }, [o, t]);
  return import_react32.default.createElement(Do, { ...n, creatable: r ?? true, clearable: a ?? true, toKey: na, toOption: Ju, loadOptions: f, onCreate: $u, getCreateLabel: r === false ? void 0 : (s) => `+ Create ${s}` });
}
function Dt(e) {
  let [o, t] = (0, import_react31.useState)(e.defaultValue);
  function r(a) {
    let n = a[0], f = Zu(n);
    t(f), e.onChange && e.onChange(f);
  }
  return import_react31.default.createElement(To, { binding: e.binding, name: e.name, placeholder: e.placeholder, defaultValue: _u(o), onChange: r, creatable: e.creatable, maxSelectedValues: e.maxSelectedValues ?? 1, clearSearchOnChange: e.clearSearchOnChange, clearable: e.clearable });
}
function _u(e) {
  return e ? { code: e } : void 0;
}
function Zu(e) {
  return e == null ? void 0 : e.code;
}
function ko(e) {
  let [o, t] = (0, import_react30.useState)(e.defaultValue), r = e.onChange, a = (0, import_react30.useCallback)((n) => {
    t(n), r && r(n);
  }, [r]);
  return import_react30.default.createElement(Dt, { "data-autofocus": e.autoFocus, "data-testid": e.testId, defaultValue: o, onChange: a, name: e.name, placeholder: e.placeholder, binding: "https://medplum.com/fhir/ValueSet/resource-types", creatable: false, maxSelectedValues: 0, clearSearchOnChange: true, clearable: false });
}
var Zn = createStyles((e) => ({ menuTitle: { margin: "20px 0 4px 6px", fontSize: "9px", fontWeight: "normal", textTransform: "uppercase", letterSpacing: "2px" }, link: { ...e.fn.focusStyles(), display: "flex", alignItems: "center", textDecoration: "none", fontSize: e.fontSizes.sm, color: e.colorScheme === "dark" ? e.colors.dark[1] : e.colors.gray[7], padding: "8px 12px", borderRadius: e.radius.sm, fontWeight: 500, "&:hover": { backgroundColor: e.colorScheme === "dark" ? e.colors.dark[6] : e.colors.gray[0], color: e.colorScheme === "dark" ? e.white : e.black, textDecoration: "none", "& svg": { color: e.colorScheme === "dark" ? e.white : e.black } }, "& svg": { color: e.colorScheme === "dark" ? e.colors.dark[2] : e.colors.gray[6], marginRight: e.spacing.sm, strokeWidth: 1.5, width: 18, height: 18 } }, linkActive: { "&, &:hover": { backgroundColor: e.fn.variant({ variant: "light", color: e.primaryColor }).background, color: e.fn.variant({ variant: "light", color: e.primaryColor }).color, "& svg": { color: e.fn.variant({ variant: "light", color: e.primaryColor }).color } } } }));
function Yn(e) {
  var _a2;
  let { classes: o } = Zn(), t = Qe(), r = ud(e.pathname, e.searchParams, e.menus), [a, n] = (0, import_react27.useState)(false);
  function f(l, i) {
    l.stopPropagation(), l.preventDefault(), t(i), window.innerWidth < 768 && e.closeNavbar();
  }
  function s(l) {
    l && t(`/${l}`);
  }
  return import_react27.default.createElement(import_react27.default.Fragment, null, import_react27.default.createElement(Navbar, { width: { sm: 250 }, p: "xs" }, import_react27.default.createElement(ScrollArea, null, !e.resourceTypeSearchDisabled && import_react27.default.createElement(Navbar.Section, { mb: "sm" }, import_react27.default.createElement(ko, { key: window.location.pathname, name: "resourceType", placeholder: "Resource Type", onChange: (l) => s(l) })), import_react27.default.createElement(Navbar.Section, { grow: true }, (_a2 = e.menus) == null ? void 0 : _a2.map((l) => {
    var _a3;
    return import_react27.default.createElement(import_react27.default.Fragment, { key: `menu-${l.title}` }, import_react27.default.createElement(Text, { className: o.menuTitle }, l.title), (_a3 = l.links) == null ? void 0 : _a3.map((i) => import_react27.default.createElement(sd, { key: i.href, to: i.href, active: i.href === (r == null ? void 0 : r.href), onClick: (u2) => f(u2, i.href) }, import_react27.default.createElement(id, { to: i.href, icon: i.icon }), import_react27.default.createElement("span", null, i.label))));
  }), e.displayAddBookmark && import_react27.default.createElement(Button, { variant: "subtle", size: "xs", mt: "xl", leftIcon: import_react27.default.createElement(Kr, { size: "0.75rem" }), onClick: () => n(true) }, "Add Bookmark")))), e.pathname && e.searchParams && import_react27.default.createElement(_n2, { pathname: e.pathname, searchParams: e.searchParams, visible: a, onOk: () => n(false), onCancel: () => n(false) }));
}
function sd(e) {
  let { classes: o, cx: t } = Zn();
  return import_react27.default.createElement(le, { onClick: e.onClick, to: e.to, className: t(o.link, { [o.linkActive]: e.active }) }, e.children);
}
function id(e) {
  return e.icon ? e.icon : import_react27.default.createElement(Space, { w: 30 });
}
function ud(e, o, t) {
  if (!e || !o || !t)
    return;
  let r, a = 0;
  for (let n of t)
    if (n.links)
      for (let f of n.links) {
        let s = dd(e, o, f.href);
        s > a && (a = s, r = f);
      }
  return r;
}
function dd(e, o, t) {
  let r = new URL(t, "https://example.com");
  if (e !== r.pathname)
    return 0;
  let a = ["_count", "_offset"];
  for (let [f, s] of r.searchParams.entries())
    if (!a.includes(f) && o.get(f) !== s)
      return 0;
  let n = 1;
  for (let [f, s] of o.entries())
    a.includes(f) || r.searchParams.get(f) === s && n++;
  return n;
}
function pP(e) {
  var _a2;
  let o = useMantineTheme(), [t, r] = (0, import_react17.useState)(localStorage.navbarOpen === "true"), a = P2(), n = gt();
  (0, import_react17.useEffect)(() => {
    function i() {
      showNotification({ color: "red", message: "No connection to server", autoClose: false });
    }
    return a.addEventListener("offline", i), () => a.removeEventListener("offline", i);
  }, [a]);
  function f(i) {
    localStorage.navbarOpen = i.toString(), r(i);
  }
  function s() {
    f(false);
  }
  function l() {
    f(!t);
  }
  return a.isLoading() ? import_react17.default.createElement(ra, null) : import_react17.default.createElement(AppShell, { styles: { main: { background: o.colorScheme === "dark" ? o.colors.dark[8] : o.colors.gray[0] } }, padding: 0, fixed: true, header: n && import_react17.default.createElement($n, { pathname: e.pathname, searchParams: e.searchParams, headerSearchDisabled: e.headerSearchDisabled, logo: e.logo, version: e.version, navbarToggle: l }), navbar: n && t ? import_react17.default.createElement(Yn, { pathname: e.pathname, searchParams: e.searchParams, menus: e.menus, closeNavbar: s, displayAddBookmark: e.displayAddBookmark, resourceTypeSearchDisabled: e.resourceTypeSearchDisabled }) : void 0 }, import_react17.default.createElement(vo, { key: `${e.pathname}?${(_a2 = e.searchParams) == null ? void 0 : _a2.toString()}` }, import_react17.default.createElement(import_react17.Suspense, { fallback: import_react17.default.createElement(ra, null) }, e.children)));
}
function Oe2(e) {
  let { contentType: o, url: t, title: r } = e.value ?? {};
  return t ? import_react34.default.createElement("div", { "data-testid": "attachment-display" }, (o == null ? void 0 : o.startsWith("image/")) && import_react34.default.createElement("img", { "data-testid": "attachment-image", style: { maxWidth: e.maxWidth }, src: t, alt: r }), (o == null ? void 0 : o.startsWith("video/")) && import_react34.default.createElement("video", { "data-testid": "attachment-video", style: { maxWidth: e.maxWidth }, controls: true }, import_react34.default.createElement("source", { type: o, src: t })), o === "application/pdf" && import_react34.default.createElement("div", { "data-testid": "attachment-pdf", style: { maxWidth: e.maxWidth, minHeight: 400 } }, import_react34.default.createElement("iframe", { width: "100%", height: "400", src: t + "#navpanes=0", allowFullScreen: true, frameBorder: 0, seamless: true })), import_react34.default.createElement("div", { "data-testid": "download-link", style: { padding: "2px 16px 16px 16px" } }, import_react34.default.createElement(Anchor, { href: t, "data-testid": "attachment-details", target: "_blank", rel: "noopener noreferrer", download: Cd(r) }, r || "Download"))) : null;
}
function Cd(e) {
  return (e == null ? void 0 : e.includes(".")) ? e : void 0;
}
function ef(e) {
  var _a2;
  return import_react33.default.createElement("div", null, (_a2 = e.values) == null ? void 0 : _a2.map((o, t) => import_react33.default.createElement("div", { key: "attatchment-" + t }, import_react33.default.createElement(Oe2, { value: o, maxWidth: e.maxWidth }))));
}
function Bo(e) {
  let o = P2(), t = (0, import_react36.useRef)(null);
  function r(f) {
    var _a2;
    R(f), (_a2 = t.current) == null ? void 0 : _a2.click();
  }
  function a(f) {
    R(f);
    let s = f.target.files;
    s && Array.from(s).forEach(n);
  }
  function n(f) {
    if (!f || !f.name)
      return;
    e.onUploadStart && e.onUploadStart();
    let l = f.name, i = f.type || "application/octet-stream";
    o.createBinary(f, l, i, e.onUploadProgress).then((u2) => {
      e.onUpload({ contentType: u2.contentType, url: u2.url, title: l });
    }).catch((u2) => {
      e.onUploadError && e.onUploadError(Oe(u2));
    });
  }
  return import_react36.default.createElement(import_react36.default.Fragment, null, import_react36.default.createElement("input", { type: "file", "data-testid": "upload-file-input", style: { display: "none" }, ref: t, onChange: (f) => a(f) }), e.children({ onClick: r }));
}
function tf(e) {
  let [o, t] = (0, import_react35.useState)(e.defaultValue ?? []), r = (0, import_react35.useRef)();
  r.current = o;
  function a(n) {
    t(n), e.onChange && e.onChange(n);
  }
  return import_react35.default.createElement("table", { style: { width: "100%" } }, import_react35.default.createElement("colgroup", null, import_react35.default.createElement("col", { width: "97%" }), import_react35.default.createElement("col", { width: "3%" })), import_react35.default.createElement("tbody", null, o.map((n, f) => import_react35.default.createElement("tr", { key: `${f}-${o.length}` }, import_react35.default.createElement("td", null, import_react35.default.createElement(Oe2, { value: n, maxWidth: 200 })), import_react35.default.createElement("td", null, import_react35.default.createElement(ActionIcon, { title: "Remove", size: "sm", onClick: (s) => {
    R(s);
    let l = o.slice();
    l.splice(f, 1), a(l);
  } }, import_react35.default.createElement(We, null))))), import_react35.default.createElement("tr", null, import_react35.default.createElement("td", null), import_react35.default.createElement("td", null, import_react35.default.createElement(Bo, { onUpload: (n) => {
    a([...r.current, n]);
  } }, (n) => import_react35.default.createElement(ActionIcon, { ...n, title: "Add", size: "sm", color: "green" }, import_react35.default.createElement(Ko, { size: 16 })))))));
}
function Tt(e) {
  let [o, t] = (0, import_react37.useState)(e.defaultValue);
  function r(a) {
    t(a), e.onChange && e.onChange(a);
  }
  return o ? import_react37.default.createElement(import_react37.default.Fragment, null, import_react37.default.createElement(Oe2, { value: o, maxWidth: 200 }), import_react37.default.createElement(Button, { onClick: (a) => {
    R(a), r(void 0);
  } }, "Remove")) : import_react37.default.createElement(Bo, { onUpload: r }, (a) => import_react37.default.createElement(Button, { ...a }, "Upload..."));
}
var kt = ["meta", "implicitRules", "language", "text", "contained", "extension", "modifierExtension"];
var Td = createStyles((e) => ({ root: { display: "grid", gridTemplateColumns: "30% 70%", margin: 0, "& > dt, & > dd": { padding: `${e.spacing.sm} ${e.spacing.sm}`, borderTop: `0.1px solid ${e.colors.gray[3]}`, margin: 0 } }, compact: { gridTemplateColumns: "20% 80%", "& > dt, & > dd": { padding: `0 ${e.spacing.xs} ${e.spacing.xs} 0`, border: 0 } } }));
function af(e) {
  let { children: o, compact: t } = e, { classes: r, cx: a } = Td();
  return import_react39.default.createElement("dl", { className: a(r.root, { [r.compact]: t }) }, o);
}
function nf(e) {
  return import_react39.default.createElement(import_react39.default.Fragment, null, import_react39.default.createElement("dt", null, e.term), import_react39.default.createElement("dd", null, e.children));
}
function Mo(e) {
  return import_react41.default.createElement(import_react41.default.Fragment, null, Nn(e.value));
}
function sf(e) {
  return import_react42.default.createElement(import_react42.default.Fragment, null, Fn(e.value));
}
function Bt(e) {
  let o = e.value;
  if (!o)
    return null;
  let t = [];
  return o.value && t.push(o.value), (o.use || o.system) && (t.push(" ["), o.use && t.push(o.use), o.use && o.system && t.push(" "), o.system && t.push(o.system), t.push("]")), import_react44.default.createElement(import_react44.default.Fragment, null, t.join("").trim());
}
function df(e) {
  var _a2;
  let o = e.value;
  return o ? import_react43.default.createElement(import_react43.default.Fragment, null, o.name, o.name && ": ", (_a2 = o.telecom) == null ? void 0 : _a2.map((t) => import_react43.default.createElement(Bt, { key: `telecom-${o.name}-${t.value}`, value: t }))) : null;
}
function cf(e) {
  var _a2, _b;
  return import_react45.default.createElement("div", null, (_a2 = e.value) == null ? void 0 : _a2.system, ": ", (_b = e.value) == null ? void 0 : _b.value);
}
function pf(e) {
  return import_react46.default.createElement(import_react46.default.Fragment, null, ns(e.value));
}
function Ke(e) {
  return import_react47.default.createElement(import_react47.default.Fragment, null, z(e.value));
}
function At(e) {
  return import_react48.default.createElement(import_react48.default.Fragment, null, rs(e.value));
}
function gf(e) {
  let o = e.value;
  return o ? import_react49.default.createElement(import_react49.default.Fragment, null, import_react49.default.createElement(Ke, { value: o.numerator }), " / ", import_react49.default.createElement(Ke, { value: o.denominator })) : null;
}
function lo(e) {
  if (!e.value)
    return null;
  let o = e.value.display || e.value.reference || zt(e.value);
  return e.link !== false && e.value.reference ? import_react50.default.createElement(le, { to: e.value }, o) : import_react50.default.createElement(import_react50.default.Fragment, null, o);
}
function hf(e) {
  let { property: o, values: t } = e, r = o.type[0].code;
  return e.values ? import_react51.default.createElement(import_react51.default.Fragment, null, t.map((a, n) => import_react51.default.createElement("div", { key: `${n}-${t.length}` }, import_react51.default.createElement(me, { arrayElement: true, property: o, propertyType: r, value: a, ignoreMissingValues: e.ignoreMissingValues, link: e.link })))) : import_react51.default.createElement(import_react51.default.Fragment, null);
}
function me(e) {
  var _a2;
  let { property: o, propertyType: t, value: r } = e;
  if ((_a2 = o == null ? void 0 : o.path) == null ? void 0 : _a2.endsWith(".id"))
    return import_react40.default.createElement(Box, { component: "div", sx: { display: "flex", gap: 3, alignItems: "center" } }, r, import_react40.default.createElement(CopyButton, { value: r, timeout: 2e3 }, ({ copied: n, copy: f }) => import_react40.default.createElement(Tooltip, { label: n ? "Copied" : "Copy", withArrow: true, position: "right" }, import_react40.default.createElement(ActionIcon, { color: n ? "teal" : "gray", onClick: f }, n ? import_react40.default.createElement($o, { size: "1rem" }) : import_react40.default.createElement(Hr, { size: "1rem" })))));
  if ((o == null ? void 0 : o.max) && o.max > 1 && !e.arrayElement)
    return t === u.Attachment ? import_react40.default.createElement(ef, { values: r, maxWidth: e.maxWidth }) : import_react40.default.createElement(hf, { property: o, values: r, ignoreMissingValues: e.ignoreMissingValues, link: e.link });
  switch (t) {
    case u.boolean:
      return import_react40.default.createElement(import_react40.default.Fragment, null, r === void 0 ? "" : (!!r).toString());
    case u.SystemString:
    case u.string:
      return import_react40.default.createElement("div", { style: { whiteSpace: "pre-wrap" } }, r);
    case u.code:
    case u.date:
    case u.decimal:
    case u.integer:
    case u.positiveInt:
    case u.unsignedInt:
    case u.uri:
    case u.url:
      return import_react40.default.createElement(import_react40.default.Fragment, null, r);
    case u.canonical:
      return import_react40.default.createElement(lo, { value: { reference: r }, link: e.link });
    case u.dateTime:
    case u.instant:
      return import_react40.default.createElement(import_react40.default.Fragment, null, st(r));
    case u.markdown:
      return import_react40.default.createElement("pre", null, r);
    case u.Address:
      return import_react40.default.createElement(bn, { value: r });
    case u.Annotation:
      return import_react40.default.createElement(import_react40.default.Fragment, null, r == null ? void 0 : r.text);
    case u.Attachment:
      return import_react40.default.createElement(Oe2, { value: r, maxWidth: e.maxWidth });
    case u.CodeableConcept:
      return import_react40.default.createElement(Mo, { value: r });
    case u.Coding:
      return import_react40.default.createElement(sf, { value: r });
    case u.ContactDetail:
      return import_react40.default.createElement(df, { value: r });
    case u.ContactPoint:
      return import_react40.default.createElement(Bt, { value: r });
    case u.HumanName:
      return import_react40.default.createElement(St, { value: r });
    case u.Identifier:
      return import_react40.default.createElement(cf, { value: r });
    case u.Money:
      return import_react40.default.createElement(pf, { value: r });
    case u.Period:
      return import_react40.default.createElement(import_react40.default.Fragment, null, es(r));
    case u.Quantity:
    case u.Duration:
      return import_react40.default.createElement(Ke, { value: r });
    case u.Range:
      return import_react40.default.createElement(At, { value: r });
    case u.Ratio:
      return import_react40.default.createElement(gf, { value: r });
    case u.Reference:
      return import_react40.default.createElement(lo, { value: r, link: e.link });
    case u.Timing:
      return import_react40.default.createElement(import_react40.default.Fragment, null, ts(r));
    case u.Dosage:
    case u.UsageContext:
      return import_react40.default.createElement(ot, { value: { type: t, value: r }, compact: true, ignoreMissingValues: e.ignoreMissingValues });
    default:
      if (!o)
        throw Error(`Displaying property of type ${e.propertyType} requires element schema`);
      return import_react40.default.createElement(ot, { value: { type: o.type[0].code, value: r }, compact: true, ignoreMissingValues: e.ignoreMissingValues });
  }
}
function Ce2(e, o) {
  let t = I(e, o);
  return t ? Array.isArray(t) ? [t.map((r) => r.value), t[0].type] : [t.value, t.type] : [void 0, "undefined"];
}
function ot(e) {
  let o = e.value, t = o.value;
  if (!t)
    return null;
  let r = o.type, a = Pr(r);
  return a ? typeof t == "object" && "name" in t && Object.keys(t).length === 1 && typeof t.name == "string" ? import_react38.default.createElement("div", null, t.name) : import_react38.default.createElement(af, { compact: e.compact }, Object.entries(a.elements).map((n) => {
    let [f, s] = n;
    if (kt.includes(f))
      return null;
    let [l, i] = Ce2(o, f);
    return e.ignoreMissingValues && (!l || Array.isArray(l) && l.length === 0) ? null : import_react38.default.createElement(nf, { key: f, term: Hs(f) }, import_react38.default.createElement(me, { property: s, propertyType: i, value: l, ignoreMissingValues: e.ignoreMissingValues, link: e.link }));
  })) : import_react38.default.createElement("div", null, r, " not implemented");
}
function wt(e) {
  return import_react53.default.createElement(Group, { noWrap: true }, import_react53.default.createElement("div", null, e.children), import_react53.default.createElement("div", null, import_react53.default.createElement(Input.Wrapper, { id: e.htmlFor, label: e.title, description: e.description, withAsterisk: e.withAsterisk }, (() => null)())));
}
function pe2(e, o) {
  var _a2, _b, _c2;
  return (_c2 = (_b = (_a2 = e == null ? void 0 : e.issue) == null ? void 0 : _a2.filter((t) => {
    var _a3;
    return Cf((_a3 = t.expression) == null ? void 0 : _a3[0], o);
  })) == null ? void 0 : _b.map((t) => {
    var _a3;
    return (_a3 = t.details) == null ? void 0 : _a3.text;
  })) == null ? void 0 : _c2.join(`
`);
}
function Ot(e, o) {
  var _a2;
  return (_a2 = e == null ? void 0 : e.issue) == null ? void 0 : _a2.filter((t) => {
    var _a3;
    return Cf((_a3 = t.expression) == null ? void 0 : _a3[0], o);
  });
}
function Cf(e, o) {
  if (e === o)
    return true;
  if (!e || !o)
    return false;
  let t = e.indexOf(".");
  if (t >= 0 && e.substring(t + 1) === o)
    return true;
  let r = o.indexOf(".");
  return r >= 0 && o.substring(r + 1) === e;
}
function ye(e) {
  return import_react54.default.createElement(Input.Wrapper, { id: e.htmlFor, label: e.title, description: e.description, withAsterisk: e.withAsterisk, error: pe2(e.outcome, e.htmlFor) }, e.children);
}
function rt(e, o, t, r, a) {
  let n = r.type;
  if (n.length > 1)
    for (let f of n) {
      let s = o.replace("[x]", P(f.code));
      s in e && delete e[s];
    }
  return e[t] = a, e;
}
function yf(e) {
  let [o, t] = (0, import_react56.useState)(e.defaultValue);
  function r(a) {
    let n = Zd(a);
    t(n), e.onChange && e.onChange(n);
  }
  return import_react56.default.createElement(To, { binding: e.binding, name: e.name, placeholder: e.placeholder, defaultValue: o && _d(o), maxSelectedValues: 1, onChange: r });
}
function _d(e) {
  var _a2;
  return (_a2 = e.coding) == null ? void 0 : _a2.map((o) => ({ system: o.system, code: o.code, display: o.display }));
}
function Zd(e) {
  if (e.length !== 0)
    return { coding: e.map((o) => ({ system: o.system, code: o.code, display: o.display })) };
}
function Et(e) {
  let [o, t] = (0, import_react57.useState)(e.defaultValue);
  function r(a) {
    let n = a[0], f = n && tc(n);
    t(f), e.onChange && e.onChange(f);
  }
  return import_react57.default.createElement(To, { binding: e.binding, name: e.name, placeholder: e.placeholder, defaultValue: o && oc(o), maxSelectedValues: 1, onChange: r });
}
function oc(e) {
  return { system: e.system, code: e.code, display: e.display };
}
function tc(e) {
  return { system: e.system, code: e.code, display: e.display };
}
function Rt(e) {
  let [o, t] = (0, import_react59.useState)(e.defaultValue), r = (0, import_react59.useRef)();
  r.current = o;
  function a(l) {
    l && Object.keys(l).length === 0 && (l = void 0), t(l), e.onChange && e.onChange(l);
  }
  function n(l) {
    let i = { ...r.current, system: l };
    l || delete i.system, a(i);
  }
  function f(l) {
    let i = { ...r.current, use: l };
    l || delete i.use, a(i);
  }
  function s(l) {
    let i = { ...r.current, value: l };
    l || delete i.value, a(i);
  }
  return import_react59.default.createElement(Group, { spacing: "xs", grow: true, noWrap: true }, import_react59.default.createElement(NativeSelect, { "data-testid": "system", defaultValue: o == null ? void 0 : o.system, onChange: (l) => n(l.currentTarget.value), data: ["", "email", "phone", "fax", "pager", "sms", "other"] }), import_react59.default.createElement(NativeSelect, { "data-testid": "use", defaultValue: o == null ? void 0 : o.use, onChange: (l) => f(l.currentTarget.value), data: ["", "home", "work", "temp", "old", "mobile"] }), import_react59.default.createElement(TextInput, { placeholder: "Value", defaultValue: o == null ? void 0 : o.value, onChange: (l) => s(l.currentTarget.value) }));
}
function Sf(e) {
  var _a2;
  let [o, t] = (0, import_react58.useState)(e.defaultValue), r = (0, import_react58.useRef)();
  r.current = o;
  function a(s) {
    t(s), e.onChange && e.onChange(s);
  }
  function n(s) {
    let l = { ...r.current, name: s };
    s || delete l.name, a(l);
  }
  function f(s) {
    let l = { ...r.current, telecom: s && [s] };
    s || delete l.telecom, a(l);
  }
  return import_react58.default.createElement(Group, { spacing: "xs", grow: true, noWrap: true }, import_react58.default.createElement(TextInput, { "data-testid": e.name + "-name", name: e.name + "-name", placeholder: "Name", style: { width: 180 }, defaultValue: o == null ? void 0 : o.name, onChange: (s) => n(s.currentTarget.value) }), import_react58.default.createElement(Rt, { name: e.name + "-telecom", defaultValue: (_a2 = o == null ? void 0 : o.telecom) == null ? void 0 : _a2[0], onChange: f }));
}
function Pf(e) {
  if (!e)
    return "";
  let o = new Date(e);
  return at(o) ? o.toLocaleDateString("sv") + "T" + o.toLocaleTimeString("sv") : "";
}
function Df(e) {
  if (!e)
    return "";
  let o = new Date(e);
  return at(o) ? o.toISOString() : "";
}
function ke(e) {
  return import_react60.default.createElement(TextInput, { id: e.name, name: e.name, "data-autofocus": e.autoFocus, "data-testid": e.name, placeholder: e.placeholder, required: e.required, type: mc(), defaultValue: Pf(e.defaultValue), autoFocus: e.autoFocus, error: pe2(e.outcome, e.name), onChange: (o) => {
    if (e.onChange) {
      let t = o.currentTarget.value;
      e.onChange(Df(t));
    }
  } });
}
function mc() {
  return "datetime-local";
}
function Tf(e) {
  return import_react61.default.createElement(JsonInput, { id: e.name, name: e.name, "data-testid": "extension-input", defaultValue: zt(e.defaultValue), deserialize: JSON.parse, onChange: (o) => {
    e.onChange && e.onChange(JSON.parse(o));
  } });
}
function kf(e) {
  var _a2, _b, _c2;
  let [o, t] = (0, import_react62.useState)(e.defaultValue), r = (0, import_react62.useRef)();
  r.current = o;
  function a(u2) {
    t(u2), e.onChange && e.onChange(u2);
  }
  function n(u2) {
    a({ ...r.current, use: u2 || void 0 });
  }
  function f(u2) {
    a({ ...r.current, prefix: u2 ? u2.split(" ") : void 0 });
  }
  function s(u2) {
    a({ ...r.current, given: u2 ? u2.split(" ") : void 0 });
  }
  function l(u2) {
    a({ ...r.current, family: u2 || void 0 });
  }
  function i(u2) {
    a({ ...r.current, suffix: u2 ? u2.split(" ") : void 0 });
  }
  return import_react62.default.createElement(Group, { spacing: "xs", grow: true, noWrap: true }, import_react62.default.createElement(NativeSelect, { defaultValue: o == null ? void 0 : o.use, name: e.name + "-use", "data-testid": "use", onChange: (u2) => n(u2.currentTarget.value), data: ["", "temp", "old", "usual", "official", "nickname", "anonymous", "maiden"] }), import_react62.default.createElement(TextInput, { placeholder: "Prefix", name: e.name + "-prefix", defaultValue: (_a2 = o == null ? void 0 : o.prefix) == null ? void 0 : _a2.join(" "), onChange: (u2) => f(u2.currentTarget.value) }), import_react62.default.createElement(TextInput, { placeholder: "Given", name: e.name + "-given", defaultValue: (_b = o == null ? void 0 : o.given) == null ? void 0 : _b.join(" "), onChange: (u2) => s(u2.currentTarget.value) }), import_react62.default.createElement(TextInput, { name: e.name + "-family", placeholder: "Family", defaultValue: o == null ? void 0 : o.family, onChange: (u2) => l(u2.currentTarget.value) }), import_react62.default.createElement(TextInput, { placeholder: "Suffix", name: e.name + "-suffix", defaultValue: (_c2 = o == null ? void 0 : o.suffix) == null ? void 0 : _c2.join(" "), onChange: (u2) => i(u2.currentTarget.value) }));
}
function Af(e) {
  let [o, t] = (0, import_react63.useState)(e.defaultValue);
  function r(a) {
    t(a), e.onChange && e.onChange(a);
  }
  return import_react63.default.createElement(Group, { spacing: "xs", grow: true, noWrap: true }, import_react63.default.createElement(TextInput, { placeholder: "System", defaultValue: o == null ? void 0 : o.system, onChange: (a) => r({ ...o, system: a.currentTarget.value }) }), import_react63.default.createElement(TextInput, { placeholder: "Value", defaultValue: o == null ? void 0 : o.value, onChange: (a) => r({ ...o, value: a.currentTarget.value }) }));
}
var Tc = ["USD", "EUR", "CAD", "GBP", "AUD"];
function Mf(e) {
  var _a2;
  let { onChange: o } = e, [t, r] = (0, import_react64.useState)(e.defaultValue), a = (0, import_react64.useCallback)((l) => {
    r(l), o && o(l);
  }, [o]), n = (0, import_react64.useCallback)((l) => {
    a({ ...t, currency: l.currentTarget.value });
  }, [t, a]), f = (0, import_react64.useCallback)((l) => {
    a({ ...t, value: l.currentTarget.valueAsNumber });
  }, [t, a]), s = import_react64.default.createElement(NativeSelect, { defaultValue: t == null ? void 0 : t.currency, data: Tc, styles: { input: { fontWeight: 500, borderTopLeftRadius: 0, borderBottomLeftRadius: 0, width: 92 } }, onChange: n });
  return import_react64.default.createElement(TextInput, { type: "number", label: e.label, placeholder: e.placeholder ?? "Value", defaultValue: ((_a2 = t == null ? void 0 : t.value) == null ? void 0 : _a2.toString()) ?? "USD", icon: import_react64.default.createElement(Vr, { size: 14 }), rightSection: s, rightSectionWidth: 92, onChange: f });
}
function Ff(e) {
  let [o, t] = (0, import_react65.useState)(e.defaultValue);
  function r(a) {
    t(a), e.onChange && e.onChange(a);
  }
  return import_react65.default.createElement(Group, { spacing: "xs", grow: true, noWrap: true }, import_react65.default.createElement(ke, { name: e.name + ".start", placeholder: "Start", defaultValue: o == null ? void 0 : o.start, onChange: (a) => r({ ...o, start: a }) }), import_react65.default.createElement(ke, { name: e.name + ".end", placeholder: "End", defaultValue: o == null ? void 0 : o.end, onChange: (a) => r({ ...o, end: a }) }));
}
function Se(e) {
  let [o, t] = (0, import_react66.useState)(e.defaultValue);
  function r(a) {
    t(a), e.onChange && e.onChange(a);
  }
  return import_react66.default.createElement(Group, { spacing: "xs", grow: true, noWrap: true }, import_react66.default.createElement(NativeSelect, { style: { width: 80 }, "data-testid": e.name + "-comparator", defaultValue: o == null ? void 0 : o.comparator, data: ["", "<", "<=", ">=", ">"], onChange: (a) => r({ ...o, comparator: a.currentTarget.value }) }), import_react66.default.createElement(TextInput, { id: e.name, name: e.name, required: e.required, "data-autofocus": e.autoFocus, "data-testid": e.name + "-value", type: "number", placeholder: "Value", defaultValue: o == null ? void 0 : o.value, autoFocus: e.autoFocus, step: "any", onWheel: (a) => {
    e.disableWheel && a.currentTarget.blur();
  }, onChange: (a) => {
    r({ ...o, value: wc(a.currentTarget.value) });
  } }), import_react66.default.createElement(TextInput, { placeholder: "Unit", "data-testid": e.name + "-unit", defaultValue: o == null ? void 0 : o.unit, onChange: (a) => r({ ...o, unit: a.currentTarget.value }) }));
}
function wc(e) {
  if (e)
    return parseFloat(e);
}
function at2(e) {
  let [o, t] = (0, import_react67.useState)(e.defaultValue);
  function r(a) {
    t(a), e.onChange && e.onChange(a);
  }
  return import_react67.default.createElement(Group, { spacing: "xs", grow: true, noWrap: true }, import_react67.default.createElement(Se, { name: e.name + "-low", defaultValue: o == null ? void 0 : o.low, onChange: (a) => r({ ...o, low: a }) }), import_react67.default.createElement(Se, { name: e.name + "-high", defaultValue: o == null ? void 0 : o.high, onChange: (a) => r({ ...o, high: a }) }));
}
function Of(e) {
  let [o, t] = (0, import_react68.useState)(e.defaultValue);
  function r(a) {
    t(a), e.onChange && e.onChange(a);
  }
  return import_react68.default.createElement(Group, { spacing: "xs", grow: true, noWrap: true }, import_react68.default.createElement(Se, { name: e.name + "-numerator", defaultValue: o == null ? void 0 : o.numerator, onChange: (a) => r({ ...o, numerator: a }) }), import_react68.default.createElement(Se, { name: e.name + "-denominator", defaultValue: o == null ? void 0 : o.denominator, onChange: (a) => r({ ...o, denominator: a }) }));
}
var Gc = { Observation: "code", User: "email:contains" };
var Uc = ["AccessPolicy", "Account", "ActivityDefinition", "Bot", "CapabilityStatement", "ClientApplication", "CodeSystem", "CompartmentDefinition", "ConceptMap", "EffectEvidenceSynthesis", "Endpoint", "EventDefinition", "Evidence", "EvidenceVariable", "ExampleScenario", "GraphDefinition", "HealthcareService", "ImplementationGuide", "InsurancePlan", "Library", "Location", "Measure", "MedicinalProduct", "MessageDefinition", "NamingSystem", "OperationDefinition", "Organization", "Patient", "Person", "PlanDefinition", "Practitioner", "Project", "Questionnaire", "RelatedPerson", "ResearchDefinition", "ResearchElementDefinition", "RiskEvidenceSynthesis", "SearchParameter", "StructureDefinition", "StructureMap", "TerminologyCapabilities", "TestScript", "UserConfiguration", "ValueSet"];
function Qc(e) {
  return { value: se(e), label: hn(e), resource: e };
}
function Vt(e) {
  let o = P2(), t = e.resourceType, [r, a] = (0, import_react70.useState)(), n = z2(e.defaultValue, a), f = e.onChange, s = (0, import_react70.useCallback)(async (i, u2) => {
    let c = Wc(t), d = new URLSearchParams({ [c]: i, _count: "10" });
    return await o.searchResources(t, d, { signal: u2 });
  }, [o, t]), l = (0, import_react70.useCallback)((i) => {
    f && f(i[0]);
  }, [f]);
  return e.defaultValue && !r && !n ? null : import_react70.default.createElement(Do, { name: e.name, required: e.required, itemComponent: zc, defaultValue: n, placeholder: e.placeholder, maxSelectedValues: 1, toKey: se, toOption: Qc, loadOptions: s, onChange: l, clearable: true });
}
var zc = (0, import_react70.forwardRef)(({ label: e, resource: o, ...t }, r) => import_react70.default.createElement("div", { ref: r, ...t }, import_react70.default.createElement(Group, { noWrap: true }, import_react70.default.createElement(ge, { value: o }), import_react70.default.createElement("div", null, import_react70.default.createElement(Text, null, e), import_react70.default.createElement(Text, { size: "xs", color: "dimmed" }, o.birthDate)))));
function Wc(e) {
  return Gc[e] ?? (Uc.includes(e) ? "name" : "_id");
}
function Oo(e) {
  let o = Kc(e.targetTypes), t = jc(e.defaultValue, o), [r, a] = (0, import_react69.useState)(e.defaultValue), [n, f] = (0, import_react69.useState)(t);
  function s(l) {
    a(l), e.onChange && e.onChange(l);
  }
  return import_react69.default.createElement(Group, { spacing: "xs", grow: true, noWrap: true }, o && o.length > 1 && import_react69.default.createElement(NativeSelect, { "data-autofocus": e.autoFocus, "data-testid": "reference-input-resource-type-select", defaultValue: n, autoFocus: e.autoFocus, onChange: (l) => f(l.currentTarget.value), data: o }), !o && import_react69.default.createElement(ko, { autoFocus: e.autoFocus, testId: "reference-input-resource-type-input", defaultValue: n, onChange: f, name: e.name + "-resourceType", placeholder: "Resource Type" }), import_react69.default.createElement(Vt, { resourceType: n, name: e.name + "-id", required: e.required, placeholder: e.placeholder, defaultValue: r, onChange: (l) => {
    s(l ? G(l) : void 0);
  } }));
}
function Kc(e) {
  if (!(!e || e.length === 0 || e.length === 1 && e[0] === "Resource"))
    return e;
}
function jc(e, o) {
  var _a2;
  let t = (_a2 = e == null ? void 0 : e.reference) == null ? void 0 : _a2.split("/")[0];
  if (t)
    return t;
  if (o && o.length > 0)
    return o[0];
}
function Vf(e) {
  let [o, t] = (0, import_react71.useState)(e.defaultValue && Array.isArray(e.defaultValue) ? e.defaultValue : []), r = (0, import_react71.useRef)();
  r.current = o;
  function a(n) {
    t(n), e.onChange && e.onChange(n);
  }
  return import_react71.default.createElement("table", { style: { width: "100%", borderCollapse: "collapse" } }, import_react71.default.createElement("colgroup", null, import_react71.default.createElement("col", { width: "97%" }), import_react71.default.createElement("col", { width: "3%" })), import_react71.default.createElement("tbody", null, o.map((n, f) => import_react71.default.createElement("tr", { key: `${f}-${o.length}` }, import_react71.default.createElement("td", null, import_react71.default.createElement(qe, { arrayElement: true, property: e.property, name: e.name + "." + f, defaultValue: n, onChange: (s) => {
    let l = [...r.current];
    l[f] = s, a(l);
  } })), import_react71.default.createElement("td", { style: { textAlign: "right" } }, import_react71.default.createElement(ActionIcon, { title: "Remove", size: "sm", onClick: (s) => {
    R(s);
    let l = [...r.current];
    l.splice(f, 1), a(l);
  } }, import_react71.default.createElement(We, null))))), import_react71.default.createElement("tr", null, import_react71.default.createElement("td", null), import_react71.default.createElement("td", { style: { textAlign: "right" } }, import_react71.default.createElement(ActionIcon, { title: "Add", size: "sm", color: "green", onClick: (n) => {
    R(n);
    let f = [...r.current];
    f.push(void 0), a(f);
  } }, import_react71.default.createElement(go, null))))));
}
var nm = ["sun", "mon", "tue", "wed", "thu", "fri", "sat"];
function zf(e) {
  let [o, t] = (0, import_react72.useState)(e.defaultValue), [r, a] = (0, import_react72.useState)(false), n = (0, import_react72.useRef)();
  return n.current = o, import_react72.default.createElement(import_react72.default.Fragment, null, import_react72.default.createElement(Group, { spacing: "xs", grow: true, noWrap: true }, import_react72.default.createElement("span", null, ts(n.current) || "No repeat"), import_react72.default.createElement(Button, { onClick: () => a(true) }, "Edit")), import_react72.default.createElement(fm, { visible: r, defaultValue: n.current, onOk: (f) => {
    e.onChange && e.onChange(f), t(f), a(false);
  }, onCancel: () => a(false) }));
}
var Gf = { repeat: { period: 1, periodUnit: "d" } };
function fm(e) {
  let [o, t] = (0, import_react72.useState)(e.defaultValue || Gf), r = (0, import_react72.useRef)();
  r.current = o;
  function a(i) {
    t({ ...r.current, event: [i] });
  }
  function n(i) {
    t({ ...r.current, repeat: i });
  }
  function f(i) {
    var _a2;
    n({ ...(_a2 = r.current) == null ? void 0 : _a2.repeat, period: i });
  }
  function s(i) {
    var _a2;
    n({ ...(_a2 = r.current) == null ? void 0 : _a2.repeat, periodUnit: i });
  }
  function l(i) {
    var _a2;
    n({ ...(_a2 = r.current) == null ? void 0 : _a2.repeat, dayOfWeek: i });
  }
  return import_react72.default.createElement(Modal, { title: "Timing", closeButtonProps: { "aria-label": "Close" }, opened: e.visible, onClose: () => e.onCancel() }, import_react72.default.createElement(Stack, null, import_react72.default.createElement(ye, { title: "Starts on", htmlFor: "timing-dialog-start" }, import_react72.default.createElement(ke, { name: "timing-dialog-start", onChange: (i) => a(i) })), import_react72.default.createElement(Switch, { label: "Repeat", checked: !!o.repeat, onChange: (i) => n(i.currentTarget.checked ? Gf.repeat : void 0) }), o.repeat && import_react72.default.createElement(import_react72.default.Fragment, null, import_react72.default.createElement(ye, { title: "Repeat every", htmlFor: "timing-dialog-period" }, import_react72.default.createElement(Group, { spacing: "xs", grow: true, noWrap: true }, import_react72.default.createElement(TextInput, { type: "number", step: 1, id: "timing-dialog-period", name: "timing-dialog-period", defaultValue: o.repeat.period || 1, onChange: (i) => f(parseInt(i.currentTarget.value, 10) || 1) }), import_react72.default.createElement(NativeSelect, { id: "timing-dialog-periodUnit", name: "timing-dialog-periodUnit", defaultValue: o.repeat.periodUnit, onChange: (i) => s(i.currentTarget.value), data: [{ label: "second", value: "s" }, { label: "minute", value: "min" }, { label: "hour", value: "h" }, { label: "day", value: "d" }, { label: "week", value: "wk" }, { label: "month", value: "mo" }, { label: "year", value: "a" }] }))), o.repeat.periodUnit === "wk" && import_react72.default.createElement(ye, { title: "Repeat on" }, import_react72.default.createElement(Chip.Group, { multiple: true, onChange: l }, import_react72.default.createElement(Group, { position: "apart", mt: "md", spacing: "xs" }, nm.map((i) => import_react72.default.createElement(Chip, { key: i, value: i, size: "xs", radius: "xl" }, i.charAt(0).toUpperCase())))))), import_react72.default.createElement(Group, { position: "right" }, import_react72.default.createElement(Button, { onClick: () => e.onOk(o) }, "OK"))));
}
function qe(e) {
  let o = e.property, t = e.defaultPropertyType ?? o.type[0].code, r = e.name, a = e.defaultValue;
  if (o.max > 1 && !e.arrayElement)
    return t === u.Attachment ? import_react55.default.createElement(tf, { name: r, defaultValue: a, onChange: e.onChange }) : import_react55.default.createElement(Vf, { property: o, name: r, defaultValue: a, onChange: e.onChange });
  let n = o.type;
  return n.length > 1 ? import_react55.default.createElement(mm, { elementDefinitionTypes: n, ...e }) : import_react55.default.createElement(Wf, { elementDefinitionType: n[0], ...e });
}
function mm(e) {
  let o = e.elementDefinitionTypes, t;
  e.defaultPropertyType && (t = o.find((n) => n.code === e.defaultPropertyType)), t || (t = o[0]);
  let [r, a] = (0, import_react55.useState)(t);
  return import_react55.default.createElement(Group, { spacing: "xs", grow: true, noWrap: true }, import_react55.default.createElement(NativeSelect, { style: { width: "200px" }, defaultValue: r.code, onChange: (n) => {
    a(o.find((f) => f.code === n.currentTarget.value));
  }, data: o.map((n) => ({ value: n.code, label: n.code })) }), import_react55.default.createElement(Wf, { ...e, elementDefinitionType: r, onChange: (n) => {
    e.onChange && e.onChange(n, e.name.replace("[x]", P(r.code)));
  } }));
}
function Wf(e) {
  var _a2, _b, _c2;
  let o = e.property, t = e.elementDefinitionType.code, r = e.name, a = e.defaultValue, n = o.min !== void 0 && o.min > 0;
  switch (t) {
    case u.SystemString:
    case u.canonical:
    case u.string:
    case u.time:
    case u.uri:
    case u.url:
      return import_react55.default.createElement(TextInput, { id: r, name: r, "data-testid": r, defaultValue: a, required: n, onChange: (f) => {
        e.onChange && e.onChange(f.currentTarget.value);
      }, error: pe2(e.outcome, r) });
    case u.date:
      return import_react55.default.createElement(TextInput, { type: "date", id: r, name: r, "data-testid": r, defaultValue: a, required: n, onChange: (f) => {
        e.onChange && e.onChange(f.currentTarget.value);
      }, error: pe2(e.outcome, r) });
    case u.dateTime:
    case u.instant:
      return import_react55.default.createElement(ke, { name: r, defaultValue: a, onChange: e.onChange, outcome: e.outcome });
    case u.decimal:
    case u.integer:
    case u.positiveInt:
    case u.unsignedInt:
      return import_react55.default.createElement(TextInput, { type: "number", step: t === u.decimal ? "any" : "1", id: r, name: r, "data-testid": r, defaultValue: a, required: n, onChange: (f) => {
        e.onChange && e.onChange(f.currentTarget.valueAsNumber);
      } });
    case u.code:
      return import_react55.default.createElement(Dt, { binding: (_a2 = o.binding) == null ? void 0 : _a2.valueSet, name: r, defaultValue: a, onChange: e.onChange });
    case u.boolean:
      return import_react55.default.createElement(Checkbox, { id: r, name: r, "data-testid": r, defaultChecked: !!a, onChange: (f) => {
        e.onChange && e.onChange(f.currentTarget.checked);
      } });
    case u.markdown:
      return import_react55.default.createElement(Textarea, { id: r, name: r, "data-testid": r, defaultValue: a, required: n, onChange: (f) => {
        e.onChange && e.onChange(f.currentTarget.value);
      } });
    case u.Address:
      return import_react55.default.createElement(kn, { name: r, defaultValue: a, onChange: e.onChange });
    case u.Annotation:
      return import_react55.default.createElement(Bn, { name: r, defaultValue: a, onChange: e.onChange });
    case u.Attachment:
      return import_react55.default.createElement(Tt, { name: r, defaultValue: a, onChange: e.onChange });
    case u.CodeableConcept:
      return import_react55.default.createElement(yf, { binding: (_b = o.binding) == null ? void 0 : _b.valueSet, name: r, defaultValue: a, onChange: e.onChange });
    case u.Coding:
      return import_react55.default.createElement(Et, { binding: (_c2 = o.binding) == null ? void 0 : _c2.valueSet, name: r, defaultValue: a, onChange: e.onChange });
    case u.ContactDetail:
      return import_react55.default.createElement(Sf, { name: r, defaultValue: a, onChange: e.onChange });
    case u.ContactPoint:
      return import_react55.default.createElement(Rt, { name: r, defaultValue: a, onChange: e.onChange });
    case u.Extension:
      return import_react55.default.createElement(Tf, { name: r, defaultValue: a, onChange: e.onChange });
    case u.HumanName:
      return import_react55.default.createElement(kf, { name: r, defaultValue: a, onChange: e.onChange });
    case u.Identifier:
      return import_react55.default.createElement(Af, { name: r, defaultValue: a, onChange: e.onChange });
    case u.Money:
      return import_react55.default.createElement(Mf, { name: r, defaultValue: a, onChange: e.onChange });
    case u.Period:
      return import_react55.default.createElement(Ff, { name: r, defaultValue: a, onChange: e.onChange });
    case u.Duration:
    case u.Quantity:
      return import_react55.default.createElement(Se, { name: r, defaultValue: a, onChange: e.onChange });
    case u.Range:
      return import_react55.default.createElement(at2, { name: r, defaultValue: a, onChange: e.onChange });
    case u.Ratio:
      return import_react55.default.createElement(Of, { name: r, defaultValue: a, onChange: e.onChange });
    case u.Reference:
      return import_react55.default.createElement(Oo, { name: r, defaultValue: a, targetTypes: pm(o), onChange: e.onChange });
    case u.Timing:
      return import_react55.default.createElement(zf, { name: r, defaultValue: a, onChange: e.onChange });
    case u.Dosage:
    case u.UsageContext:
      return import_react55.default.createElement(nt2, { typeName: t, defaultValue: a, onChange: e.onChange, outcome: e.outcome });
    default:
      return import_react55.default.createElement(nt2, { typeName: o.type[0].code, defaultValue: a, onChange: e.onChange, outcome: e.outcome });
  }
}
function pm(e) {
  var _a2, _b, _c2;
  return (_c2 = (_b = (_a2 = e == null ? void 0 : e.type) == null ? void 0 : _a2[0]) == null ? void 0 : _b.targetProfile) == null ? void 0 : _c2.map((o) => o.split("/").pop());
}
function nt2(e) {
  let [o, t] = (0, import_react52.useState)(e.defaultValue ?? {});
  function r(s) {
    t(s), e.onChange && e.onChange(s);
  }
  let a = e.typeName, n = Pr(a);
  if (!n)
    return import_react52.default.createElement("div", null, a, " not implemented");
  let f = { type: a, value: o };
  return import_react52.default.createElement(Stack, null, Object.entries(n.elements).map(([s, l]) => {
    if (s === "id" || kt.includes(s) || !l.type)
      return null;
    let [i, u2] = Ce2(f, s), c = l.min !== void 0 && l.min > 0;
    return l.type.length === 1 && l.type[0].code === "boolean" ? import_react52.default.createElement(wt, { key: s, title: Hs(s), description: l.description, htmlFor: s }, import_react52.default.createElement(qe, { property: l, name: s, defaultValue: i, defaultPropertyType: u2, outcome: e.outcome, onChange: (d, x) => {
      r(rt(o, s, x ?? s, l, d));
    } })) : import_react52.default.createElement(ye, { key: s, title: Hs(s), description: l.description, withAsterisk: c, htmlFor: s, outcome: e.outcome }, import_react52.default.createElement(qe, { property: l, name: s, defaultValue: i, defaultPropertyType: u2, onChange: (d, x) => {
      r(rt(o, s, x ?? s, l, d));
    } }));
  }));
}
function Jf(e) {
  return e.toLocaleString("default", { month: "long" }) + " " + e.getFullYear();
}
function Ut() {
  let e = /* @__PURE__ */ new Date();
  return e.setDate(1), e.setHours(0, 0, 0, 0), e;
}
var vm = createStyles((e) => ({ table: { width: 350, "& th": { fontWeight: "normal", fontSize: 11, padding: 8, textAlign: "center" }, "& td": { padding: "2px 4px" }, "& td button": { width: 44, height: 44, color: e.colors[e.primaryColor][5], fontSize: 16, fontWeight: 500, textAlign: "center", padding: 0, backgroundColor: e.colors[e.primaryColor][0], border: 0, borderRadius: "50%", cursor: "pointer" }, "& td button:hover": { backgroundColor: e.colors[e.primaryColor][1] }, "& td button:disabled": { backgroundColor: "transparent", cursor: "default", color: e.colors.gray[4], fontWeight: "normal" } } }));
function Kf(e) {
  let { classes: o } = vm(), { onChangeMonth: t, onClick: r } = e, [a, n] = (0, import_react73.useState)(Ut);
  function f(l) {
    n((i) => {
      let u2 = new Date(i.getTime());
      return u2.setMonth(i.getMonth() + l), t(u2), u2;
    });
  }
  let s = (0, import_react73.useMemo)(() => Sm(a, e.slots), [a, e.slots]);
  return import_react73.default.createElement("div", null, import_react73.default.createElement(Group, { position: "apart", spacing: "xs", grow: true, noWrap: true }, import_react73.default.createElement("p", { style: { flex: 1 } }, Jf(a)), import_react73.default.createElement(Group, { position: "right", spacing: "xs" }, import_react73.default.createElement(Button, { variant: "outline", "aria-label": "Previous month", onClick: () => f(-1) }, "<"), import_react73.default.createElement(Button, { variant: "outline", "aria-label": "Next month", onClick: () => f(1) }, ">"))), import_react73.default.createElement("table", { className: o.table }, import_react73.default.createElement("thead", null, import_react73.default.createElement("tr", null, import_react73.default.createElement("th", null, "SUN"), import_react73.default.createElement("th", null, "MON"), import_react73.default.createElement("th", null, "TUE"), import_react73.default.createElement("th", null, "WED"), import_react73.default.createElement("th", null, "THU"), import_react73.default.createElement("th", null, "FRI"), import_react73.default.createElement("th", null, "SAT"))), import_react73.default.createElement("tbody", null, s.map((l, i) => import_react73.default.createElement("tr", { key: "week-" + i }, l.map((u2, c) => import_react73.default.createElement("td", { key: "day-" + c }, u2 && import_react73.default.createElement(Button, { disabled: !u2.available, onClick: () => r(u2.date) }, u2.date.getDate()))))))));
}
function Sm(e, o) {
  let t = new Date(e.getFullYear(), e.getMonth()), r = [], a = [];
  for (let n = 0; n < t.getDay(); n++)
    a.push(void 0);
  for (; t.getMonth() === e.getMonth(); )
    a.push({ date: new Date(t.getTime()), available: bm(t, o) }), t.getDay() === 6 && (r.push(a), a = []), t.setDate(t.getDate() + 1);
  if (t.getDay() !== 0) {
    for (let n = t.getDay(); n < 7; n++)
      a.push(void 0);
    r.push(a);
  }
  return r;
}
function bm(e, o) {
  for (let t of o) {
    let r = new Date(t.start);
    if (r.getFullYear() === e.getFullYear() && r.getMonth() === e.getMonth() && r.getDate() === e.getDate())
      return true;
  }
  return false;
}
var km = createStyles(() => ({ root: { "@media (max-width: 800px)": { paddingLeft: 4, paddingRight: 4 } } }));
function je(e) {
  let { children: o, ...t } = e, { classes: r } = km();
  return import_react74.default.createElement(Container, { className: r.root, ...t }, o);
}
var Fm = createStyles((e) => ({ noteBody: { fontSize: e.fontSizes.sm }, noteCite: { fontSize: e.fontSizes.xs, marginBlockStart: 3 }, noteRoot: { padding: 5 } }));
function va({ value: e }) {
  let { classes: o } = Fm();
  return e ? import_react78.default.createElement(Stack, { justify: "flex-start", spacing: "xs" }, e.map((t) => {
    var _a2;
    return t.text && import_react78.default.createElement(Blockquote, { key: `note-${t.text}`, classNames: { cite: o.noteCite, body: o.noteBody, root: o.noteRoot }, cite: ((_a2 = t.authorReference) == null ? void 0 : _a2.display) || t.authorString, icon: null }, t.text);
  })) : null;
}
function Ee(e) {
  let { value: o, link: t, ...r } = e, [a, n] = (0, import_react80.useState)(), f = z2(o, n), s;
  if (a && !yt(a))
    s = `[${Kn(a)}]`;
  else if (f)
    s = hn(f);
  else
    return null;
  return t ? import_react80.default.createElement(le, { to: o, ...r }, s) : import_react80.default.createElement(Text, { component: "span", ...r }, s);
}
function _e(e) {
  return import_react79.default.createElement(Group, { spacing: "xs" }, import_react79.default.createElement(ge, { size: 24, radius: 12, value: e.value, link: e.link }), import_react79.default.createElement(Ee, { value: e.value, link: e.link }));
}
var qm = { draft: "blue", active: "blue", "on-hold": "yellow", revoked: "red", completed: "green", "entered-in-error": "red", unknown: "gray", retired: "gray", registered: "blue", preliminary: "blue", final: "green", amended: "yellow", corrected: "yellow", cancelled: "red", requested: "blue", received: "blue", accepted: "blue", rejected: "red", ready: "blue", "in-progress": "blue", failed: "red", proposed: "blue", pending: "blue", booked: "blue", arrived: "blue", fulfilled: "green", noshow: "red", "checked-in": "blue", waitlist: "gray", routine: "gray", urgent: "red", asap: "red", stat: "red" };
function Qt(e) {
  return import_react81.default.createElement(Badge, { color: qm[e.status] }, e.status);
}
var ol = createStyles((e) => ({ table: { border: `0.1px solid ${e.colors.gray[5]}`, borderCollapse: "collapse", "& td, & th": { border: `0.1px solid ${e.colors.gray[5]}`, padding: 4 } }, criticalRow: { background: e.colorScheme === "dark" ? e.colors.red[7] : e.colors.red[1], border: `0.1px solid ${e.colors.red[5]}`, color: e.colors.red[5], fontWeight: 500, "& td": { border: `0.1px solid ${e.colors.red[5]}` } }, noteBody: { fontSize: e.fontSizes.sm }, noteCite: { fontSize: e.fontSizes.xs, marginBlockStart: 3 }, noteRoot: { padding: 5 } }));
Pa.defaultProps = { hideObservationNotes: false, hideSpecimenInfo: false };
function Pa(e) {
  var _a2;
  let o = P2(), t = z2(e.value), [r, a] = (0, import_react77.useState)();
  if ((0, import_react77.useEffect)(() => {
    (t == null ? void 0 : t.specimen) && Promise.allSettled(t.specimen.map((f) => o.readReference(f))).then((f) => f.filter((s) => s.status === "fulfilled").map((s) => s.value)).then(a).catch(console.error);
  }, [o, t]), !t)
    return null;
  let n = (r == null ? void 0 : r.flatMap((f) => f.note || [])) || [];
  if (t.presentedForm && t.presentedForm.length > 0) {
    let f = t.presentedForm[0];
    ((_a2 = f.contentType) == null ? void 0 : _a2.startsWith("text/plain")) && f.data && n.push({ text: window.atob(f.data) });
  }
  return import_react77.default.createElement(Stack, null, import_react77.default.createElement(Title, null, "Diagnostic Report"), import_react77.default.createElement($m, { value: t }), r && !e.hideSpecimenInfo && Km(r), t.result && import_react77.default.createElement(jm, { hideObservationNotes: e.hideObservationNotes, value: t.result }), n.length > 0 && import_react77.default.createElement(va, { value: n }));
}
function $m({ value: e }) {
  var _a2, _b;
  return import_react77.default.createElement(Group, { mt: "md", spacing: 30 }, e.subject && import_react77.default.createElement("div", null, import_react77.default.createElement(Text, { size: "xs", transform: "uppercase", color: "dimmed" }, "Subject"), import_react77.default.createElement(Text, null, import_react77.default.createElement(_e, { value: e.subject, link: true }))), (_a2 = e.resultsInterpreter) == null ? void 0 : _a2.map((o) => import_react77.default.createElement("div", { key: o.reference }, import_react77.default.createElement(Text, { size: "xs", transform: "uppercase", color: "dimmed" }, "Interpreter"), import_react77.default.createElement(Text, null, import_react77.default.createElement(_e, { value: o, link: true })))), (_b = e.performer) == null ? void 0 : _b.map((o) => import_react77.default.createElement("div", { key: o.reference }, import_react77.default.createElement(Text, { size: "xs", transform: "uppercase", color: "dimmed" }, "Performer"), import_react77.default.createElement(Text, null, import_react77.default.createElement(_e, { value: o, link: true })))), e.issued && import_react77.default.createElement("div", null, import_react77.default.createElement(Text, { size: "xs", transform: "uppercase", color: "dimmed" }, "Issued"), import_react77.default.createElement(Text, null, st(e.issued))), e.status && import_react77.default.createElement("div", null, import_react77.default.createElement(Text, { size: "xs", transform: "uppercase", color: "dimmed" }, "Status"), import_react77.default.createElement(Text, null, P(e.status))));
}
function Km(e) {
  return import_react77.default.createElement(Stack, { spacing: "xs" }, import_react77.default.createElement(Title, { order: 2, size: "h6" }, "Specimens"), import_react77.default.createElement(List, { type: "ordered" }, e == null ? void 0 : e.map((o) => {
    var _a2;
    return import_react77.default.createElement(List.Item, { ml: "sm", key: `specimen-${o.id}` }, import_react77.default.createElement(Group, { spacing: 20 }, import_react77.default.createElement(Group, { spacing: 5 }, import_react77.default.createElement(Text, { fw: 500 }, "Collected:"), " ", st((_a2 = o.collection) == null ? void 0 : _a2.collectedDateTime)), import_react77.default.createElement(Group, { spacing: 5 }, import_react77.default.createElement(Text, { fw: 500 }, "Received:"), " ", st(o.receivedTime))));
  })));
}
function jm(e) {
  let { classes: o } = ol();
  return import_react77.default.createElement("table", { className: o.table }, import_react77.default.createElement("thead", null, import_react77.default.createElement("tr", null, import_react77.default.createElement("th", null, "Test"), import_react77.default.createElement("th", null, "Value"), import_react77.default.createElement("th", null, "Reference Range"), import_react77.default.createElement("th", null, "Interpretation"), import_react77.default.createElement("th", null, "Category"), import_react77.default.createElement("th", null, "Performer"), import_react77.default.createElement("th", null, "Status"))), import_react77.default.createElement("tbody", null, import_react77.default.createElement(tl, { value: e.value, ancestorIds: e.ancestorIds, hideObservationNotes: e.hideObservationNotes })));
}
function tl(e) {
  var _a2;
  return import_react77.default.createElement(import_react77.default.Fragment, null, (_a2 = e.value) == null ? void 0 : _a2.map((o) => import_react77.default.createElement(_m, { key: `obs-${ae(o) ? o.reference : o.id}`, value: o, ancestorIds: e.ancestorIds, hideObservationNotes: e.hideObservationNotes })));
}
function _m(e) {
  var _a2, _b;
  let { classes: o, cx: t } = ol(), r = z2(e.value);
  if (!r || ((_a2 = e.ancestorIds) == null ? void 0 : _a2.includes(r.id)))
    return null;
  let a = !e.hideObservationNotes && r.note, n = ep(r);
  return import_react77.default.createElement(import_react77.default.Fragment, null, import_react77.default.createElement("tr", { className: t({ [o.criticalRow]: n }) }, import_react77.default.createElement("td", { rowSpan: a ? 2 : 1 }, import_react77.default.createElement(le, { to: r }, import_react77.default.createElement(Mo, { value: r.code }))), import_react77.default.createElement("td", null, import_react77.default.createElement(Zm, { value: r })), import_react77.default.createElement("td", null, import_react77.default.createElement(Ym, { value: r.referenceRange })), import_react77.default.createElement("td", null, r.interpretation && r.interpretation.length > 0 && import_react77.default.createElement(Mo, { value: r.interpretation[0] })), import_react77.default.createElement("td", null, r.category && r.category.length > 0 && import_react77.default.createElement(import_react77.default.Fragment, null, r.category.map((f) => import_react77.default.createElement("div", { key: `category-${Nn(f)}` }, import_react77.default.createElement(Mo, { value: f }))))), import_react77.default.createElement("td", null, (_b = r.performer) == null ? void 0 : _b.map((f) => import_react77.default.createElement(lo, { key: f.reference, value: f }))), import_react77.default.createElement("td", null, r.status && import_react77.default.createElement(Qt, { status: r.status }))), r.hasMember && import_react77.default.createElement(tl, { value: r.hasMember, ancestorIds: e.ancestorIds ? [...e.ancestorIds, r.id] : [r.id], hideObservationNotes: e.hideObservationNotes }), a && import_react77.default.createElement("tr", null, import_react77.default.createElement("td", { colSpan: 6 }, import_react77.default.createElement(va, { value: r.note }))));
}
function Zm(e) {
  let o = e.value;
  return import_react77.default.createElement(import_react77.default.Fragment, null, _n(o));
}
function Ym(e) {
  let o = e.value && e.value.length > 0 && e.value[0];
  return o ? o.text ? import_react77.default.createElement(import_react77.default.Fragment, null, o.text) : import_react77.default.createElement(At, { value: o }) : null;
}
function ep(e) {
  var _a2, _b, _c2, _d2;
  let o = (_d2 = (_c2 = (_b = (_a2 = e.interpretation) == null ? void 0 : _a2[0]) == null ? void 0 : _b.coding) == null ? void 0 : _c2[0]) == null ? void 0 : _d2.code;
  return o === "AA" || o === "LL" || o === "HH" || o === "A";
}
var np = createStyles((e, { width: o, fill: t }) => ({ paper: { maxWidth: o, margin: `${e.spacing.xl} auto`, padding: t ? 0 : e.spacing.md, "@media (max-width: 800px)": { padding: t ? 0 : 8 }, "& img": { width: "100%", maxWidth: "100%" }, "& video": { width: "100%", maxWidth: "100%" } } }));
var fp = { shadow: "xs", radius: "md", withBorder: true };
function Lo2(e) {
  let { className: o, children: t, width: r, fill: a, unstyled: n, ...f } = useComponentDefaultProps("Panel", fp, e), { classes: s, cx: l } = np({ width: r, fill: a }, { name: "Panel", unstyled: n });
  return import_react82.default.createElement(Paper, { className: l(s.paper, o), ...f }, t);
}
var cp = createStyles((e) => ({ root: { borderCollapse: "collapse", width: "100%", "& tr": { borderTop: `0.1px solid ${e.colors.gray[3]}` }, "& th, & td": { padding: `${e.spacing.sm} ${e.spacing.sm}`, verticalAlign: "top" } }, removed: { color: e.colors.red[7], textDecoration: "line-through" }, added: { color: e.colors.green[7] } }));
function fl(e) {
  let { classes: o } = cp(), t = P2(), [r, a] = (0, import_react83.useState)(false);
  if ((0, import_react83.useEffect)(() => {
    t.requestSchema(e.original.resourceType).then(() => a(true)).catch(console.log);
  }, [t, e.original.resourceType]), !r)
    return null;
  let n = te(e.original.resourceType);
  return import_react83.default.createElement("table", { className: o.root }, import_react83.default.createElement("colgroup", null, import_react83.default.createElement("col", { style: { width: "30%" } }), import_react83.default.createElement("col", { style: { width: "35%" } }), import_react83.default.createElement("col", { style: { width: "35%" } })), import_react83.default.createElement("thead", null, import_react83.default.createElement("tr", null, import_react83.default.createElement("th", null, "Property"), import_react83.default.createElement("th", null, "Before"), import_react83.default.createElement("th", null, "After"))), import_react83.default.createElement("tbody", null, Object.entries(n.elements).map(([f, s]) => {
    if (f === "id" || f === "meta")
      return null;
    let [l, i] = Ce2(T(e.original), f), [u2, c] = Ce2(T(e.revised), f);
    return nl(l) && nl(u2) || zt(l) === zt(u2) ? null : import_react83.default.createElement("tr", { key: f }, import_react83.default.createElement("td", null, Hs(f)), import_react83.default.createElement("td", { className: o.removed }, import_react83.default.createElement(me, { property: s, propertyType: i, value: l, ignoreMissingValues: true })), import_react83.default.createElement("td", { className: o.added }, import_react83.default.createElement(me, { property: s, propertyType: c, value: u2, ignoreMissingValues: true })));
  })));
}
function nl(e) {
  return !e || Array.isArray(e) && e.length === 0 || typeof e == "object" && Object.keys(e).length === 0;
}
function Da(e) {
  let o = P2(), t = z2(e.value), [r, a] = (0, import_react84.useState)(false);
  return (0, import_react84.useEffect)(() => {
    t && o.requestSchema(t.resourceType).then(() => a(true)).catch(console.log);
  }, [o, t]), !r || !t ? null : import_react84.default.createElement(ot, { value: { type: t.resourceType, value: e.forceUseInput ? e.value : t }, ignoreMissingValues: e.ignoreMissingValues });
}
function sl(e) {
  return import_react85.default.createElement(je, null, e.children);
}
function Ze(e) {
  var _a2, _b;
  let { resource: o, profile: t, padding: r, popupMenuItems: a, ...n } = e, f = t ?? ((_a2 = o.meta) == null ? void 0 : _a2.author), s = e.dateTime ?? ((_b = o.meta) == null ? void 0 : _b.lastUpdated);
  return import_react85.default.createElement(Lo2, { "data-testid": "timeline-item", fill: true, ...n }, import_react85.default.createElement(Group, { position: "apart", spacing: 8, mx: "xs", my: "sm" }, import_react85.default.createElement(ge, { value: f, link: true, size: "md" }), import_react85.default.createElement("div", { style: { flex: 1 } }, import_react85.default.createElement(Text, { size: "sm" }, import_react85.default.createElement(Ee, { color: "dark", weight: 500, value: f, link: true })), import_react85.default.createElement(Text, { size: "xs" }, import_react85.default.createElement(le, { color: "dimmed", to: e.resource }, st(s)), import_react85.default.createElement(Text, { component: "span", color: "dimmed", mx: 8 }, "·"), import_react85.default.createElement(le, { color: "dimmed", to: e.resource }, e.resource.resourceType))), a && import_react85.default.createElement(Menu, { position: "bottom-end", shadow: "md", width: 200 }, import_react85.default.createElement(Menu.Target, null, import_react85.default.createElement(ActionIcon, { radius: "xl", "aria-label": `Actions for ${se(e.resource)}` }, import_react85.default.createElement(qr, null))), a)), import_react85.default.createElement(vo, null, r && import_react85.default.createElement("div", { style: { padding: "0 16px 16px 16px" } }, e.children), !r && import_react85.default.createElement(import_react85.default.Fragment, null, e.children)));
}
function dl(e, o) {
  e.sort((t, r) => {
    let a = il(t, o), n = il(r, o);
    return a > n ? 1 : a < n ? -1 : ul(t, o) - ul(r, o);
  });
}
function il(e, o) {
  if (!cl(e, o)) {
    let t = e.priority;
    if (typeof t == "string")
      return { stat: 4, asap: 3, urgent: 2 }[t] ?? 0;
  }
  return 0;
}
function ul(e, o) {
  var _a2;
  if (!cl(e, o)) {
    if (e.resourceType === "Communication" && e.sent)
      return new Date(e.sent).getTime();
    if ((e.resourceType === "DiagnosticReport" || e.resourceType === "Media" || e.resourceType === "Observation") && e.issued)
      return new Date(e.issued).getTime();
    if (e.resourceType === "DocumentReference" && e.date)
      return new Date(e.date).getTime();
  }
  let t = (_a2 = e.meta) == null ? void 0 : _a2.lastUpdated;
  return t ? new Date(t).getTime() : 0;
}
function cl(e, o) {
  return !!o && e.resourceType === o.resourceType && e.id === o.id;
}
var Bp = createStyles((e) => ({ pinnedComment: { backgroundColor: e.colors.blue[0] } }));
function Ye(e) {
  let o = P2(), t = Qe(), r = o.getProfile(), a = (0, import_react76.useRef)(null), n = z2(e.value), [f, s] = (0, import_react76.useState)(), [l, i] = (0, import_react76.useState)([]), u2 = e.loadTimelineResources, c = (0, import_react76.useRef)(l);
  c.current = l;
  let d = (0, import_react76.useCallback)((h) => {
    dl(h, n), h.reverse(), i(h);
  }, [n]), x = (0, import_react76.useCallback)((h) => {
    let H = [];
    for (let we of h) {
      if (we.status !== "fulfilled")
        continue;
      let C = we.value;
      if (C.type === "history" && s(C), C.entry)
        for (let U of C.entry)
          H.push(U.resource);
    }
    d(H);
  }, [d]), y = (0, import_react76.useCallback)((h) => d([...c.current, h]), [d]), g = (0, import_react76.useCallback)(() => {
    var _a2;
    let h, H;
    "resourceType" in e.value ? (h = e.value.resourceType, H = e.value.id) : [h, H] = (_a2 = e.value.reference) == null ? void 0 : _a2.split("/"), u2(o, h, H).then(x).catch(console.log);
  }, [o, e.value, u2, x]);
  (0, import_react76.useEffect)(() => g(), [g]);
  function T2(h) {
    !n || !e.createCommunication || o.createResource(e.createCommunication(n, r, h)).then((H) => y(H)).catch(console.log);
  }
  function B(h) {
    !n || !e.createMedia || o.createResource(e.createMedia(n, r, h)).then((H) => y(H)).then(() => updateNotification({ id: "upload-notification", color: "teal", title: "Upload complete", message: "", icon: import_react76.default.createElement($o, { size: 16 }), autoClose: 2e3 })).catch((H) => updateNotification({ id: "upload-notification", color: "red", title: "Upload error", message: Kn(H), icon: import_react76.default.createElement(Ct, { size: 16 }), autoClose: 2e3 }));
  }
  function k2(h, H) {
    return o.updateResource({ ...h, priority: H });
  }
  function A(h) {
    k2(h, "stat").then(g).catch(console.log);
  }
  function W(h) {
    k2(h, "routine").then(g).catch(console.log);
  }
  function v(h) {
    t(`/${h.resourceType}/${h.id}`);
  }
  function L(h) {
    t(`/${h.resourceType}/${h.id}/edit`);
  }
  function Z(h) {
    t(`/${h.resourceType}/${h.id}/delete`);
  }
  function ae2(h) {
    var _a2;
    t(`/${h.resourceType}/${h.id}/_history/${(_a2 = h.meta) == null ? void 0 : _a2.versionId}`);
  }
  function Re2() {
    showNotification({ id: "upload-notification", loading: true, title: "Initializing upload...", message: "Please wait...", autoClose: false, withCloseButton: false });
  }
  function ro(h) {
    updateNotification({ id: "upload-notification", loading: true, title: "Uploading...", message: Lp(h), autoClose: false, withCloseButton: false });
  }
  function ce(h) {
    updateNotification({ id: "upload-notification", color: "red", title: "Upload error", message: Kn(h), icon: import_react76.default.createElement(Ct, { size: 16 }), autoClose: 2e3 });
  }
  return n ? import_react76.default.createElement(sl, null, e.createCommunication && import_react76.default.createElement(Lo2, null, import_react76.default.createElement($, { testid: "timeline-form", onSubmit: (h) => {
    T2(h.text);
    let H = a.current;
    H && (H.value = "", H.focus());
  } }, import_react76.default.createElement(Group, { spacing: "xs", noWrap: true, style: { width: "100%" } }, import_react76.default.createElement(ge, { value: r }), import_react76.default.createElement(TextInput, { name: "text", ref: a, placeholder: "Add comment", style: { width: "100%", maxWidth: 300 } }), import_react76.default.createElement(ActionIcon, { type: "submit", radius: "xl", color: "blue", variant: "filled" }, import_react76.default.createElement(Xr, { size: 16 })), import_react76.default.createElement(Bo, { onUpload: B, onUploadStart: Re2, onUploadProgress: ro, onUploadError: ce }, (h) => import_react76.default.createElement(ActionIcon, { ...h, radius: "xl", color: "blue", variant: "filled" }, import_react76.default.createElement(Ko, { size: 16 })))))), l.map((h) => {
    var _a2;
    if (!h)
      return null;
    let H = `${h.resourceType}/${h.id}/${(_a2 = h.meta) == null ? void 0 : _a2.versionId}`;
    if (h.resourceType === n.resourceType && h.id === n.id)
      return import_react76.default.createElement(Ap, { key: H, history: f, resource: h, onDetails: ae2 });
    switch (h.resourceType) {
      case "AuditEvent":
        return import_react76.default.createElement(Op, { key: H, resource: h, onDetails: v });
      case "Communication":
        return import_react76.default.createElement(Fp, { key: H, resource: h, onPin: h.priority !== "stat" ? A : void 0, onUnpin: h.priority === "stat" ? W : void 0, onDetails: v, onEdit: L, onDelete: Z });
      case "DiagnosticReport":
        return import_react76.default.createElement(Ep, { key: H, resource: h, onDetails: v, onEdit: L, onDelete: Z });
      case "Media":
        return import_react76.default.createElement(wp, { key: H, resource: h, onDetails: v, onEdit: L, onDelete: Z });
      default:
        return import_react76.default.createElement(Ze, { key: H, resource: h, padding: true }, import_react76.default.createElement(Da, { value: h, ignoreMissingValues: true }));
    }
  })) : import_react76.default.createElement(Center, { style: { width: "100%", height: "100%" } }, import_react76.default.createElement(Loader, null));
}
function Ro(e) {
  return import_react76.default.createElement(Menu.Dropdown, null, import_react76.default.createElement(Menu.Label, null, "Resource"), e.onPin && import_react76.default.createElement(Menu.Item, { icon: import_react76.default.createElement(Jr, { size: 14 }), onClick: () => e.onPin(e.resource), "aria-label": `Pin ${se(e.resource)}` }, "Pin"), e.onUnpin && import_react76.default.createElement(Menu.Item, { icon: import_react76.default.createElement($r, { size: 14 }), onClick: () => e.onUnpin(e.resource), "aria-label": `Unpin ${se(e.resource)}` }, "Unpin"), e.onDetails && import_react76.default.createElement(Menu.Item, { icon: import_react76.default.createElement(zr, { size: 14 }), onClick: () => e.onDetails(e.resource), "aria-label": `Details ${se(e.resource)}` }, "Details"), e.onEdit && import_react76.default.createElement(Menu.Item, { icon: import_react76.default.createElement(Gr, { size: 14 }), onClick: () => e.onEdit(e.resource), "aria-label": `Edit ${se(e.resource)}` }, "Edit"), e.onDelete && import_react76.default.createElement(import_react76.default.Fragment, null, import_react76.default.createElement(Menu.Divider, null), import_react76.default.createElement(Menu.Label, null, "Danger zone"), import_react76.default.createElement(Menu.Item, { color: "red", icon: import_react76.default.createElement(Zo, { size: 14 }), onClick: () => e.onDelete(e.resource), "aria-label": `Delete ${se(e.resource)}` }, "Delete")));
}
function Ap(e) {
  let o = Mp(e.history, e.resource);
  return o ? import_react76.default.createElement(Ze, { resource: e.resource, padding: true, popupMenuItems: import_react76.default.createElement(Ro, { ...e }) }, import_react76.default.createElement(fl, { original: o, revised: e.resource })) : import_react76.default.createElement(Ze, { resource: e.resource, padding: true, popupMenuItems: import_react76.default.createElement(Ro, { ...e }) }, import_react76.default.createElement("h3", null, "Created"), import_react76.default.createElement(Da, { value: e.resource, ignoreMissingValues: true, forceUseInput: true }));
}
function Mp(e, o) {
  let t = e.entry, r = t.findIndex((a) => {
    var _a2, _b, _c2;
    return ((_b = (_a2 = a.resource) == null ? void 0 : _a2.meta) == null ? void 0 : _b.versionId) === ((_c2 = o.meta) == null ? void 0 : _c2.versionId);
  });
  if (!(r >= t.length - 1))
    return t[r + 1].resource;
}
function Fp(e) {
  var _a2, _b;
  let { classes: o } = Bp(), r = !e.resource.priority || e.resource.priority === "routine" ? void 0 : o.pinnedComment;
  return import_react76.default.createElement(Ze, { resource: e.resource, profile: e.resource.sender, dateTime: e.resource.sent, padding: true, className: r, popupMenuItems: import_react76.default.createElement(Ro, { ...e }) }, import_react76.default.createElement("p", null, (_b = (_a2 = e.resource.payload) == null ? void 0 : _a2[0]) == null ? void 0 : _b.contentString));
}
function wp(e) {
  var _a2;
  let o = (_a2 = e.resource.content) == null ? void 0 : _a2.contentType, t = o && !o.startsWith("image/") && !o.startsWith("video/") && o !== "application/pdf";
  return import_react76.default.createElement(Ze, { resource: e.resource, padding: !!t, popupMenuItems: import_react76.default.createElement(Ro, { ...e }) }, import_react76.default.createElement(Oe2, { value: e.resource.content }));
}
function Op(e) {
  return import_react76.default.createElement(Ze, { resource: e.resource, padding: true, popupMenuItems: import_react76.default.createElement(Ro, { ...e }) }, import_react76.default.createElement(ScrollArea, null, import_react76.default.createElement("pre", null, e.resource.outcomeDesc)));
}
function Ep(e) {
  return import_react76.default.createElement(Ze, { resource: e.resource, padding: true, popupMenuItems: import_react76.default.createElement(Ro, { ...e }) }, import_react76.default.createElement(Pa, { value: e.resource }));
}
function Lp(e) {
  if (e.lengthComputable) {
    let o = 100 * e.loaded / e.total;
    return `Uploaded: ${ka(e.loaded)} / ${ka(e.total)} ${o.toFixed(2)}%`;
  }
  return `Uploaded: ${ka(e.loaded)}`;
}
function ka(e) {
  if (e === 0)
    return "0.00 B";
  let o = Math.floor(Math.log(e) / Math.log(1024));
  return (e / Math.pow(1024, o)).toFixed(2) + " " + " KMGTP".charAt(o) + "B";
}
function YA(e) {
  return import_react75.default.createElement(Ye, { value: e.resource, loadTimelineResources: async (o, t, r) => {
    let a = `${t}/${r}`, n = 100;
    return Promise.allSettled([o.readHistory(t, r), o.search("Task", { _filter: `based-on eq ${a} or focus eq ${a} or subject eq ${a}`, _count: n })]);
  } });
}
function Jt(e) {
  let { children: o, ...t } = e;
  return import_react86.default.createElement(je, null, import_react86.default.createElement(Lo2, { ...t }, o));
}
function dM(e) {
  return import_react87.default.createElement(Ye, { value: e.encounter, loadTimelineResources: async (o, t, r) => Promise.allSettled([o.readHistory("Encounter", r), o.search("Communication", "encounter=Encounter/" + r), o.search("Media", "encounter=Encounter/" + r)]), createCommunication: (o, t, r) => ({ resourceType: "Communication", status: "completed", encounter: G(o), subject: o.subject, sender: G(t), sent: (/* @__PURE__ */ new Date()).toISOString(), payload: [{ contentString: r }] }), createMedia: (o, t, r) => ({ resourceType: "Media", status: "completed", encounter: G(o), subject: o.subject, operator: G(t), issued: (/* @__PURE__ */ new Date()).toISOString(), content: r }) });
}
function hl(e) {
  let o;
  try {
    o = ie(e.path, e.resource);
  } catch (t) {
    return console.warn("FhirPathDisplay:", t), null;
  }
  if (o.length > 1)
    throw new Error(`Component "path" for "FhirPathDisplay" must resolve to a single element.        Received ${o.length} elements        [${JSON.stringify(o, null, 2)}]`);
  return import_react89.default.createElement(me, { value: o[0] || "", propertyType: e.propertyType });
}
function yl(e) {
  return import_react91.default.createElement(Modal, { title: "Export", closeButtonProps: { "aria-label": "Close" }, opened: e.visible, onClose: e.onCancel }, import_react91.default.createElement(Box, { display: "flex", sx: { justifyContent: "space-between" } }, e.exportCsv && import_react91.default.createElement(Cl, { text: "CSV", exportLogic: e.exportCsv, onCancel: e.onCancel }), e.exportTransactionBundle && import_react91.default.createElement(Cl, { text: "Transaction Bundle", exportLogic: e.exportTransactionBundle, onCancel: e.onCancel })), import_react91.default.createElement(Text, { sx: { marginTop: "10px", marginLeft: "2px" } }, "Limited to 1000 records"));
}
function Cl(e) {
  return import_react91.default.createElement(Button, { onClick: () => {
    e.exportLogic(), e.onCancel();
  } }, `Export as ${e.text}`);
}
var $p = { string: [hi.EQUALS, hi.NOT, hi.CONTAINS, hi.EXACT], fulltext: [hi.EQUALS, hi.NOT, hi.CONTAINS, hi.EXACT], token: [hi.EQUALS, hi.NOT], reference: [hi.EQUALS, hi.NOT], numeric: [hi.EQUALS, hi.NOT_EQUALS, hi.GREATER_THAN, hi.LESS_THAN, hi.GREATER_THAN_OR_EQUALS, hi.LESS_THAN_OR_EQUALS], quantity: [hi.EQUALS, hi.NOT_EQUALS, hi.GREATER_THAN, hi.LESS_THAN, hi.GREATER_THAN_OR_EQUALS, hi.LESS_THAN_OR_EQUALS], date: [hi.EQUALS, hi.NOT_EQUALS, hi.GREATER_THAN, hi.LESS_THAN, hi.GREATER_THAN_OR_EQUALS, hi.LESS_THAN_OR_EQUALS, hi.STARTS_AFTER, hi.ENDS_BEFORE, hi.APPROXIMATELY], datetime: [hi.EQUALS, hi.NOT_EQUALS, hi.GREATER_THAN, hi.LESS_THAN, hi.GREATER_THAN_OR_EQUALS, hi.LESS_THAN_OR_EQUALS, hi.STARTS_AFTER, hi.ENDS_BEFORE, hi.APPROXIMATELY] };
var Kp = { eq: "equals", ne: "not equals", gt: "greater than", lt: "less than", ge: "greater than or equals", le: "less than or equals", sa: "starts after", eb: "ends before", ap: "approximately", contains: "contains", exact: "exact", text: "text", not: "not", above: "above", below: "below", in: "in", "not-in": "not in", "of-type": "of type", missing: "missing", identifier: "identifier", iterate: "iterate" };
function lt(e, o) {
  return { ...e, filters: o, offset: 0, name: void 0 };
}
function kM(e) {
  return lt(e, []);
}
function jt(e, o) {
  return lt(e, (e.filters ?? []).filter((t) => t.code !== o));
}
function Ho(e, o, t, r, a) {
  a && (e = jt(e, o));
  let n = [];
  return e.filters && n.push(...e.filters), n.push({ code: o, operator: t, value: r ?? "" }), lt(e, n);
}
function BM(e, o) {
  var _a2;
  if ((_a2 = e.fields) == null ? void 0 : _a2.includes(o))
    return e;
  let t = [];
  return e.fields && t.push(...e.fields), t.push(o), { ...e, fields: t, name: void 0 };
}
function Sl(e, o) {
  if (!e.filters)
    return e;
  let t = [...e.filters];
  return t.splice(o, 1), { ...e, filters: t, name: void 0 };
}
function bl(e, o) {
  return Ba(e, o, -1);
}
function Pl(e, o) {
  return Ba(e, o, 0);
}
function Dl(e, o) {
  return Ba(e, o, 1);
}
function Ba(e, o, t) {
  let r = /* @__PURE__ */ new Date();
  r.setDate(r.getDate() + t), r.setHours(0, 0, 0, 0);
  let a = new Date(r.getTime());
  return a.setDate(a.getDate() + 1), a.setTime(a.getTime() - 1), Ma2(e, o, r, a);
}
function Tl(e, o) {
  return Aa(e, o, -1);
}
function kl(e, o) {
  return Aa(e, o, 0);
}
function Bl(e, o) {
  return Aa(e, o, 1);
}
function Aa(e, o, t) {
  let r = /* @__PURE__ */ new Date();
  r.setMonth(r.getMonth() + t), r.setDate(1), r.setHours(0, 0, 0, 0);
  let a = new Date(r.getTime());
  return a.setMonth(a.getMonth() + 1), a.setDate(1), a.setHours(0, 0, 0, 0), a.setTime(a.getTime() - 1), Ma2(e, o, r, a);
}
function Al(e, o) {
  let t = /* @__PURE__ */ new Date();
  return t.setMonth(0), t.setDate(1), t.setHours(0, 0, 0, 0), Ma2(e, o, t, /* @__PURE__ */ new Date());
}
function Ma2(e, o, t, r) {
  return e = jt(e, o), e = vl(e, o, hi.GREATER_THAN_OR_EQUALS, t), e = vl(e, o, hi.LESS_THAN_OR_EQUALS, r), e;
}
function vl(e, o, t, r) {
  return Ho(e, o, t, r.toISOString());
}
function Fa2(e, o, t = true) {
  return Ho(e, o, hi.MISSING, t.toString());
}
function jp(e, o) {
  return e.offset === o ? e : { ...e, offset: o, name: void 0 };
}
function Ml(e, o) {
  let t = e.count ?? Fa, r = (o - 1) * t;
  return jp(e, r);
}
function wa(e, o, t) {
  return o === Fl(e) && t !== void 0 && t === wl(e) ? e : { ...e, sortRules: [{ code: o, descending: !!t }], name: void 0 };
}
function AM(e, o) {
  let t = false;
  return Fl(e) === o && (t = !wl(e)), wa(e, o, t);
}
function Fl(e) {
  let o = e.sortRules;
  if (!o || o.length === 0)
    return;
  let t = o[0].code;
  return t.startsWith("-") ? t.substr(1) : t;
}
function wl(e) {
  let o = e.sortRules;
  return !o || o.length === 0 ? false : !!o[0].descending;
}
function Ol(e) {
  return $p[e.type];
}
function st2(e) {
  return Kp[e] ?? "";
}
function Pe(e) {
  let o = e;
  return o.includes(".") && (o = o.split(".").pop()), o === "versionId" ? "Version ID" : (o = o.replace("[x]", ""), o = o.replace(/([A-Z])/g, " $1"), o = o.replace(/[-_]/g, " "), o = o.replace(/\s+/g, " "), o = o.trim(), o.toLowerCase() === "id" ? "ID" : o.split(/\s/).map(P).join(" "));
}
function El(e, o) {
  var _a2, _b;
  let t = o.name;
  return t === "id" ? e.id : t === "meta.versionId" ? (_a2 = e.meta) == null ? void 0 : _a2.versionId : t === "_lastUpdated" ? st((_b = e.meta) == null ? void 0 : _b.lastUpdated) : o.elementDefinition && `${e.resourceType}.${o.name}` === o.elementDefinition.path ? _p(e, o.elementDefinition) : o.searchParams && o.searchParams.length === 1 && o.name === o.searchParams[0].code ? Zp(e, o.searchParams[0]) : null;
}
function _p(e, o) {
  var _a2, _b, _c2;
  let t = ((_c2 = (_b = (_a2 = o.path) == null ? void 0 : _a2.split(".")) == null ? void 0 : _b.pop()) == null ? void 0 : _c2.replaceAll("[x]", "")) ?? "", [r, a] = Ce2({ type: e.resourceType, value: e }, t);
  return r ? import_react93.default.createElement(me, { property: o, propertyType: a, value: r, maxWidth: 200, ignoreMissingValues: true, link: false }) : null;
}
function Zp(e, o) {
  let t = pe(o.expression, [{ type: e.resourceType, value: e }]);
  return !t || t.length === 0 ? null : import_react93.default.createElement(import_react93.default.Fragment, null, t.map((r, a) => import_react93.default.createElement(me, { key: `${a}-${t.length}`, propertyType: r.type, value: r.value, maxWidth: 200, ignoreMissingValues: true, link: false })));
}
function Rl(e) {
  let o = (0, import_react92.useRef)(false), [t, r] = (0, import_react92.useState)({ search: JSON.parse(zt(e.search)) }), [a, n] = (0, import_react92.useState)(false);
  (0, import_react92.useEffect)(() => {
    r({ search: e.search });
  }, [e.search]);
  let f = (0, import_react92.useMemo)(() => {
    if (!e.visible)
      return [];
    let l = e.search.resourceType, i = te(l), u2 = js(l);
    return ux(i, u2).sort((c, d) => c.localeCompare(d)).map((c) => ({ value: c, label: Pe(c) }));
  }, [e.visible, e.search.resourceType]);
  if (!e.visible)
    return null;
  function s(l) {
    r({ search: { ...t.search, fields: l } });
  }
  return import_react92.default.createElement(Modal, { title: "Fields", closeButtonProps: { "aria-label": "Close" }, opened: e.visible, onClose: () => {
    e.onCancel();
  }, size: "auto", withOverlay: true, closeOnClickOutside: false, overlayProps: { onMouseDownCapture: () => {
    o.current = a;
  }, onClick: () => {
    o.current || e.onCancel(), o.current = false;
  }, children: import_react92.default.createElement("div", { "data-testid": "overlay-child" }) } }, import_react92.default.createElement(Stack, null, import_react92.default.createElement(MultiSelect, { withinPortal: true, style: { width: 550 }, placeholder: "Select fields to display", data: f, value: t.search.fields ?? [], onChange: s, onDropdownOpen: () => n(true), onDropdownClose: () => n(false), maxDropdownHeight: "250px", dropdownPosition: "bottom", clearButtonProps: { "aria-label": "Clear selection" }, clearable: true, searchable: true }), import_react92.default.createElement(Group, { position: "right" }, import_react92.default.createElement(Button, { onClick: () => e.onOk(t.search) }, "OK"))));
}
function ux(e, o) {
  let t = [], r = /* @__PURE__ */ new Set(), a = /* @__PURE__ */ new Set();
  for (let n of Object.keys(e.elements))
    t.push(n), r.add(n.toLowerCase()), a.add(Pe(n));
  if (o)
    for (let n of Object.keys(o)) {
      let f = Pe(n);
      !r.has(n) && !a.has(f) && (t.push(n), r.add(n), a.add(f));
    }
  return t;
}
function _t(e) {
  var _a2;
  let { resourceType: o, filter: t } = e, r = (_a2 = k.types[o].searchParams) == null ? void 0 : _a2[t.code];
  if (r) {
    if (r.type === "reference" && (t.operator === hi.EQUALS || t.operator === hi.NOT_EQUALS))
      return import_react95.default.createElement(Ee, { value: { reference: t.value } });
    let a = Or(o, r);
    if (t.code === "_lastUpdated" || a.type === kr.DATETIME)
      return import_react95.default.createElement(import_react95.default.Fragment, null, st(t.value));
  }
  return import_react95.default.createElement(import_react95.default.Fragment, null, t.value);
}
function Zt(e) {
  let o = Or(e.resourceType, e.searchParam), t = "filter-value";
  switch (o.type) {
    case kr.REFERENCE:
      return import_react96.default.createElement(Oo, { name: t, defaultValue: e.defaultValue ? { reference: e.defaultValue } : void 0, targetTypes: e.searchParam.target, autoFocus: e.autoFocus, onChange: (r) => {
        r ? e.onChange(r.reference) : e.onChange("");
      } });
    case kr.BOOLEAN:
      return import_react96.default.createElement(Checkbox, { name: t, "data-autofocus": e.autoFocus, "data-testid": t, defaultChecked: e.defaultValue === "true", autoFocus: e.autoFocus, onChange: (r) => e.onChange(r.currentTarget.checked.toString()) });
    case kr.DATE:
      return import_react96.default.createElement(TextInput, { type: "date", name: t, "data-autofocus": e.autoFocus, "data-testid": t, defaultValue: e.defaultValue, autoFocus: e.autoFocus, onChange: (r) => e.onChange(r.currentTarget.value) });
    case kr.DATETIME:
      return import_react96.default.createElement(ke, { name: t, defaultValue: e.defaultValue, autoFocus: e.autoFocus, onChange: e.onChange });
    case kr.NUMBER:
      return import_react96.default.createElement(TextInput, { type: "number", name: t, "data-autofocus": e.autoFocus, "data-testid": t, defaultValue: e.defaultValue, autoFocus: e.autoFocus, onChange: (r) => e.onChange(r.currentTarget.value) });
    case kr.QUANTITY:
      return import_react96.default.createElement(Se, { name: t, defaultValue: gx(e.defaultValue), autoFocus: e.autoFocus, onChange: (r) => {
        r ? e.onChange(`${r.value}`) : e.onChange("");
      } });
    default:
      return import_react96.default.createElement(TextInput, { name: t, "data-autofocus": e.autoFocus, "data-testid": t, defaultValue: e.defaultValue, autoFocus: e.autoFocus, onChange: (r) => e.onChange(r.currentTarget.value), placeholder: "Search value" });
  }
}
function gx(e) {
  if (e) {
    let [o, t, r] = e.split("|");
    if (o)
      return { value: parseFloat(o), system: t, unit: r };
  }
}
function Ul(e) {
  let [o, t] = (0, import_react94.useState)(JSON.parse(zt(e.search))), [r, a] = (0, import_react94.useState)(-1), n = (0, import_react94.useRef)(o);
  n.current = o, (0, import_react94.useEffect)(() => {
    t(JSON.parse(zt(e.search)));
  }, [e.search]);
  function f(u2) {
    t(Ho(n.current, u2.code, u2.operator, u2.value));
  }
  if (!e.visible)
    return null;
  let s = e.search.resourceType, l = js(s) ?? {}, i = o.filters || [];
  return import_react94.default.createElement(Modal, { title: "Filters", closeButtonProps: { "aria-label": "Close" }, size: 900, opened: e.visible, onClose: e.onCancel }, import_react94.default.createElement("div", null, import_react94.default.createElement("table", null, import_react94.default.createElement("colgroup", null, import_react94.default.createElement("col", { style: { width: 200 } }), import_react94.default.createElement("col", { style: { width: 200 } }), import_react94.default.createElement("col", { style: { width: 380 } }), import_react94.default.createElement("col", { style: { width: 120 } })), import_react94.default.createElement("thead", null, import_react94.default.createElement("tr", null, import_react94.default.createElement("th", null, "Field"), import_react94.default.createElement("th", null, "Operation"), import_react94.default.createElement("th", null, "Value"), import_react94.default.createElement("th", null, "Actions"))), import_react94.default.createElement("tbody", null, i.map((u2, c) => c === r ? import_react94.default.createElement(ql, { key: `filter-${u2.code}-${u2.operator}-${u2.value}-input`, resourceType: s, searchParams: l, defaultValue: u2, okText: "Save", onOk: (d) => {
    let x = [...i];
    x[c] = d, t(lt(n.current, x)), a(-1);
  }, onCancel: () => a(-1) }) : import_react94.default.createElement(Sx, { key: `filter-${u2.code}-${u2.operator}-${u2.value}-display`, resourceType: s, searchParams: l, filter: u2, onEdit: () => a(c), onDelete: () => t(Sl(n.current, c)) })), import_react94.default.createElement(ql, { resourceType: s, searchParams: l, okText: "Add", onOk: f })))), import_react94.default.createElement(Group, { position: "right", mt: "xl" }, import_react94.default.createElement(Button, { onClick: () => e.onOk(n.current) }, "OK")));
}
function Sx(e) {
  let { filter: o } = e;
  return import_react94.default.createElement("tr", null, import_react94.default.createElement("td", null, Pe(o.code)), import_react94.default.createElement("td", null, st2(o.operator)), import_react94.default.createElement("td", null, import_react94.default.createElement(_t, { resourceType: e.resourceType, filter: o })), import_react94.default.createElement("td", null, import_react94.default.createElement(Button, { compact: true, variant: "outline", onClick: e.onEdit }, "Edit"), import_react94.default.createElement(Button, { compact: true, variant: "outline", onClick: e.onDelete }, "Delete")));
}
function ql(e) {
  let [o, t] = (0, import_react94.useState)(e.defaultValue ?? {}), r = (0, import_react94.useRef)(o);
  r.current = o;
  function a(i) {
    t({ ...r.current, code: i });
  }
  function n(i) {
    t({ ...r.current, operator: i });
  }
  function f(i) {
    t({ ...r.current, value: i });
  }
  let s = e.searchParams[o.code], l = s && Ol(s);
  return import_react94.default.createElement("tr", null, import_react94.default.createElement("td", null, import_react94.default.createElement(NativeSelect, { "data-testid": "filter-field", defaultValue: r.current.code, onChange: (i) => a(i.currentTarget.value), data: ["", ...Object.keys(e.searchParams).map((i) => ({ value: i, label: Pe(i) }))] })), import_react94.default.createElement("td", null, l && import_react94.default.createElement(NativeSelect, { "data-testid": "filter-operation", defaultValue: o.operator, onChange: (i) => n(i.currentTarget.value), data: ["", ...l.map((i) => ({ value: i, label: st2(i) }))] })), import_react94.default.createElement("td", null, s && o.operator && import_react94.default.createElement(Zt, { resourceType: e.resourceType, searchParam: s, defaultValue: o.value, onChange: f })), import_react94.default.createElement("td", null, o.code && o.operator && import_react94.default.createElement(Button, { compact: true, variant: "outline", onClick: () => {
    e.onOk(r.current), t({});
  } }, e.okText), e.onCancel && import_react94.default.createElement(Button, { compact: true, variant: "outline", onClick: e.onCancel }, "Cancel")));
}
function Ql(e) {
  let [o, t] = (0, import_react97.useState)(e.defaultValue ?? "");
  if (!e.visible || !e.searchParam || !e.filter)
    return null;
  function r() {
    e.onOk({ ...e.filter, value: o });
  }
  return import_react97.default.createElement(Modal, { title: e.title, size: "xl", opened: e.visible, onClose: e.onCancel }, import_react97.default.createElement($, { onSubmit: r }, import_react97.default.createElement(Grid, null, import_react97.default.createElement(Grid.Col, { span: 10 }, import_react97.default.createElement(Zt, { resourceType: e.resourceType, searchParam: e.searchParam, defaultValue: o, autoFocus: true, onChange: t })), import_react97.default.createElement(Grid.Col, { span: 2 }, import_react97.default.createElement(Button, { onClick: r, fullWidth: true }, "OK")))));
}
function zl(e) {
  if (!e.searchParams)
    return null;
  function o(n, f) {
    a(wa(e.search, n.code, f));
  }
  function t(n) {
    a(jt(e.search, n.code));
  }
  function r(n, f) {
    e.onPrompt(n, { code: n.code, operator: f, value: "" });
  }
  function a(n) {
    e.onChange(n);
  }
  return e.searchParams.length === 1 ? import_react98.default.createElement(Tx, { search: e.search, searchParam: e.searchParams[0], onSort: o, onPrompt: r, onChange: a, onClear: t }) : import_react98.default.createElement(Menu.Dropdown, null, e.searchParams.map((n) => import_react98.default.createElement(Menu.Item, { key: n.code }, Pe(n.code))));
}
function Tx(e) {
  switch (e.searchParam.type) {
    case "date":
      return import_react98.default.createElement(kx, { ...e });
    case "number":
    case "quantity":
      return import_react98.default.createElement(Bx, { ...e });
    case "reference":
      return import_react98.default.createElement(Ax, { ...e });
    case "string":
    case "token":
    case "uri":
      return import_react98.default.createElement(Mx, { ...e });
    default:
      return import_react98.default.createElement(import_react98.default.Fragment, null, "Unknown search param type: ", e.searchParam.type);
  }
}
function kx(e) {
  let { searchParam: o } = e, t = o.code;
  return import_react98.default.createElement(Menu.Dropdown, null, import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(jo, { size: 14 }), onClick: () => e.onSort(o, false) }, "Sort Oldest to Newest"), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(_o, { size: 14 }), onClick: () => e.onSort(o, true) }, "Sort Newest to Oldest"), import_react98.default.createElement(Menu.Divider, null), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(Co, { size: 14 }), onClick: () => e.onPrompt(o, hi.EQUALS) }, "Equals..."), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(ho, { size: 14 }), onClick: () => e.onPrompt(o, hi.NOT_EQUALS) }, "Does not equal..."), import_react98.default.createElement(Menu.Divider, null), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(vt, { size: 14 }), onClick: () => e.onPrompt(o, hi.ENDS_BEFORE) }, "Before..."), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(yt2, { size: 14 }), onClick: () => e.onPrompt(o, hi.STARTS_AFTER) }, "After..."), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(wr, { size: 14 }), onClick: () => e.onPrompt(o, hi.EQUALS) }, "Between..."), import_react98.default.createElement(Menu.Divider, null), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(He, { size: 14 }), onClick: () => e.onChange(Dl(e.search, t)) }, "Tomorrow"), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(He, { size: 14 }), onClick: () => e.onChange(Pl(e.search, t)) }, "Today"), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(He, { size: 14 }), onClick: () => e.onChange(bl(e.search, t)) }, "Yesterday"), import_react98.default.createElement(Menu.Divider, null), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(He, { size: 14 }), onClick: () => e.onChange(Bl(e.search, t)) }, "Next Month"), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(He, { size: 14 }), onClick: () => e.onChange(kl(e.search, t)) }, "This Month"), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(He, { size: 14 }), onClick: () => e.onChange(Tl(e.search, t)) }, "Last Month"), import_react98.default.createElement(Menu.Divider, null), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(He, { size: 14 }), onClick: () => e.onChange(Al(e.search, t)) }, "Year to date"), import_react98.default.createElement(Yt, { ...e }));
}
function Bx(e) {
  let { searchParam: o } = e;
  return import_react98.default.createElement(Menu.Dropdown, null, import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(jo, { size: 14 }), onClick: () => e.onSort(o, false) }, "Sort Smallest to Largest"), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(_o, { size: 14 }), onClick: () => e.onSort(o, true) }, "Sort Largest to Smallest"), import_react98.default.createElement(Menu.Divider, null), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(Co, { size: 14 }), onClick: () => e.onPrompt(o, hi.EQUALS) }, "Equals..."), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(ho, { size: 14 }), onClick: () => e.onPrompt(o, hi.NOT_EQUALS) }, "Does not equal..."), import_react98.default.createElement(Menu.Divider, null), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(yt2, { size: 14 }), onClick: () => e.onPrompt(o, hi.GREATER_THAN) }, "Greater than..."), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(yo, { size: 14 }), onClick: () => e.onPrompt(o, hi.GREATER_THAN_OR_EQUALS) }, "Greater than or equal to..."), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(vt, { size: 14 }), onClick: () => e.onPrompt(o, hi.LESS_THAN) }, "Less than..."), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(yo, { size: 14 }), onClick: () => e.onPrompt(o, hi.LESS_THAN_OR_EQUALS) }, "Less than or equal to..."), import_react98.default.createElement(Yt, { ...e }));
}
function Ax(e) {
  let { searchParam: o } = e;
  return import_react98.default.createElement(Menu.Dropdown, null, import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(Co, { size: 14 }), onClick: () => e.onPrompt(o, hi.EQUALS) }, "Equals..."), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(ho, { size: 14 }), onClick: () => e.onPrompt(o, hi.NOT) }, "Does not equal..."), import_react98.default.createElement(Yt, { ...e }));
}
function Mx(e) {
  let { searchParam: o } = e;
  return import_react98.default.createElement(Menu.Dropdown, null, import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(jo, { size: 14 }), onClick: () => e.onSort(o, false) }, "Sort A to Z"), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(_o, { size: 14 }), onClick: () => e.onSort(o, true) }, "Sort Z to A"), import_react98.default.createElement(Menu.Divider, null), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(Co, { size: 14 }), onClick: () => e.onPrompt(o, hi.EQUALS) }, "Equals..."), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(ho, { size: 14 }), onClick: () => e.onPrompt(o, hi.NOT) }, "Does not equal..."), import_react98.default.createElement(Menu.Divider, null), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(Er, { size: 14 }), onClick: () => e.onPrompt(o, hi.CONTAINS) }, "Contains..."), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(Or2, { size: 14 }), onClick: () => e.onPrompt(o, hi.EQUALS) }, "Does not contain..."), import_react98.default.createElement(Yt, { ...e }));
}
function Yt(e) {
  let { searchParam: o } = e, t = o.code;
  return import_react98.default.createElement(import_react98.default.Fragment, null, import_react98.default.createElement(Menu.Divider, null), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(Mr, { size: 14 }), onClick: () => e.onChange(Fa2(e.search, t)) }, "Missing"), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(Ar, { size: 14 }), onClick: () => e.onChange(Fa2(e.search, t, false)) }, "Not missing"), import_react98.default.createElement(Menu.Divider, null), import_react98.default.createElement(Menu.Item, { icon: import_react98.default.createElement(oa, { size: 14 }), onClick: () => e.onClear(o) }, "Clear filters"));
}
function Wl(e) {
  let o = e.resourceType, t = [];
  for (let r of e.fields || ["id", "_lastUpdated"])
    t.push(Lx(o, r));
  return t;
}
function Lx(e, o) {
  var _a2;
  if (o === "_lastUpdated")
    return { name: "_lastUpdated", searchParams: [{ resourceType: "SearchParameter", base: ["Resource"], code: "_lastUpdated", name: "_lastUpdated", type: "date", expression: "Resource.meta.lastUpdated" }] };
  if (o === "meta.versionId")
    return { name: "meta.versionId", searchParams: [{ resourceType: "SearchParameter", base: ["Resource"], code: "_versionId", name: "_versionId", type: "token", expression: "Resource.meta.versionId" }] };
  let t = Ce(e, o), r = Qs(e, o.toLowerCase());
  if (t && r)
    return { name: o, elementDefinition: t, searchParams: [r] };
  if (t) {
    let a = js(e), n;
    if (a) {
      let f = new RegExp(`${e}\\.${o.replaceAll("[x]", "")}([^\\w-]|$)`);
      n = Object.values(a).filter((s) => !!s.expression && f.test(s == null ? void 0 : s.expression)), n.length === 0 && (n = void 0);
    }
    return { name: o, elementDefinition: t, searchParams: n };
  }
  if (r) {
    let a = Or(e, r);
    return { name: o, elementDefinition: (_a2 = a.elementDefinitions) == null ? void 0 : _a2[0], searchParams: [r] };
  }
  return { name: o };
}
var Ha = class extends Event {
  constructor(t) {
    super("change");
    this.definition = t;
  }
};
var Va = class extends Event {
  constructor(t) {
    super("load");
    this.response = t;
  }
};
var co = class extends Event {
  constructor(t, r) {
    super("click");
    this.resource = t, this.browserEvent = r;
  }
};
var zx = createStyles((e) => ({ root: { maxWidth: "100%", overflow: "auto", textAlign: "left", marginBottom: "20px" }, table: { cursor: "pointer" }, tr: { "&:hover": { backgroundColor: e.colorScheme === "dark" ? e.colors.dark[7] : e.colors.gray[0] } }, th: { padding: "0 !important" }, control: { width: "100%", padding: `${e.spacing.xs} ${e.spacing.md}`, "&:hover": { backgroundColor: e.colorScheme === "dark" ? e.colors.dark[6] : e.colors.gray[0] } }, icon: { width: 21, height: 21, borderRadius: 21 } }));
function Wx(e) {
  var _a2, _b, _c2, _d2;
  let { classes: o } = zx(), t = P2(), [r, a] = (0, import_react90.useState)(false), [n, f] = (0, import_react90.useState)(), { search: s, onLoad: l } = e, [i, u2] = (0, import_react90.useState)({ selected: {}, fieldEditorVisible: false, filterEditorVisible: false, exportDialogVisible: false, filterDialogVisible: false }), c = (0, import_react90.useRef)(i);
  c.current = i;
  let d = s.total ?? "accurate", x = (0, import_react90.useCallback)((C) => {
    f(void 0), t.search(s.resourceType, Ma({ ...s, total: d, fields: void 0 }), C).then((U) => {
      u2({ ...c.current, searchResponse: U }), l && l(new Va(U));
    }).catch((U) => {
      u2({ ...c.current, searchResponse: void 0 }), f(U);
    });
  }, [t, s, d, l]), y = (0, import_react90.useCallback)(() => {
    u2({ ...c.current, searchResponse: void 0 }), x({ cache: "reload" });
  }, [x]);
  (0, import_react90.useEffect)(() => {
    x();
  }, [x]);
  function g(C, U) {
    C.stopPropagation();
    let ne = C.target.checked, oe = { ...c.current.selected };
    ne ? oe[U] = true : delete oe[U], u2({ ...c.current, selected: oe });
  }
  function T2(C) {
    C.stopPropagation();
    let Ne = C.target.checked, ne = {}, oe = c.current.searchResponse;
    Ne && (oe == null ? void 0 : oe.entry) && oe.entry.forEach((ve2) => {
      var _a3;
      ((_a3 = ve2.resource) == null ? void 0 : _a3.id) && (ne[ve2.resource.id] = true);
    }), u2({ ...c.current, selected: ne });
  }
  function B() {
    var _a3, _b2;
    let C = c.current;
    if (!((_a3 = C.searchResponse) == null ? void 0 : _a3.entry) || C.searchResponse.entry.length === 0)
      return false;
    for (let U of C.searchResponse.entry)
      if (((_b2 = U.resource) == null ? void 0 : _b2.id) && !C.selected[U.resource.id])
        return false;
    return true;
  }
  function k2(C) {
    e.onChange && e.onChange(new Ha(C));
  }
  function A(C, U) {
    if (bt(C.target) || C.button === 2)
      return;
    R(C);
    let Ne = C.button === 1 || C.ctrlKey || C.metaKey;
    !Ne && e.onClick && e.onClick(new co(U, C)), Ne && e.onAuxClick && e.onAuxClick(new co(U, C));
  }
  function W() {
    return !!(e.onExport ?? e.onExportCsv ?? e.onExportTransactionBundle);
  }
  if ((0, import_react90.useEffect)(() => {
    a(false), t.requestSchema(e.search.resourceType).then(() => a(true)).catch(console.log);
  }, [t, e.search.resourceType]), !r)
    return import_react90.default.createElement(Center, { style: { width: "100%", height: "100%" } }, import_react90.default.createElement(Loader, null));
  let v = e.checkboxesEnabled, L = Wl(s), Z = s.resourceType, ae2 = i.searchResponse, ro = (_a2 = ae2 == null ? void 0 : ae2.entry) == null ? void 0 : _a2.map((C) => C.resource), ce = "subtle", h = "gray", H = 16, we = window.innerWidth < 768;
  return import_react90.default.createElement("div", { className: o.root, "data-testid": "search-control" }, !e.hideToolbar && import_react90.default.createElement(Group, { position: "apart", mb: "xl" }, import_react90.default.createElement(Group, { spacing: 2 }, import_react90.default.createElement(Button, { compact: true, variant: ce, color: h, leftIcon: import_react90.default.createElement(Nr, { size: H }), onClick: () => u2({ ...c.current, fieldEditorVisible: true }) }, "Fields"), import_react90.default.createElement(Button, { compact: true, variant: ce, color: h, leftIcon: import_react90.default.createElement(Qr, { size: H }), onClick: () => u2({ ...c.current, filterEditorVisible: true }) }, "Filters"), e.onNew && import_react90.default.createElement(Button, { compact: true, variant: ce, color: h, leftIcon: import_react90.default.createElement(Ur, { size: H }), onClick: e.onNew }, "New..."), !we && W() && import_react90.default.createElement(Button, { compact: true, variant: ce, color: h, leftIcon: import_react90.default.createElement(ea, { size: H }), onClick: e.onExport ? e.onExport : () => u2({ ...c.current, exportDialogVisible: true }) }, "Export..."), !we && e.onDelete && import_react90.default.createElement(Button, { compact: true, variant: ce, color: h, leftIcon: import_react90.default.createElement(Zo, { size: H }), onClick: () => e.onDelete(Object.keys(i.selected)) }, "Delete..."), !we && e.onBulk && import_react90.default.createElement(Button, { compact: true, variant: ce, color: h, leftIcon: import_react90.default.createElement(Fr, { size: H }), onClick: () => e.onBulk(Object.keys(i.selected)) }, "Bulk...")), import_react90.default.createElement(Group, { spacing: 2 }, ae2 && import_react90.default.createElement(Text, { size: "xs", color: "dimmed" }, Kx(s, ae2.total), "-", jx(s, ae2.total), " of", " ", `${d === "estimate" ? "~" : ""}${(_b = ae2.total) == null ? void 0 : _b.toLocaleString()}`), import_react90.default.createElement(ActionIcon, { title: "Refresh", onClick: y }, import_react90.default.createElement(jr, { size: "1.125rem" })))), import_react90.default.createElement(Table, { className: o.table }, import_react90.default.createElement("thead", null, import_react90.default.createElement("tr", null, v && import_react90.default.createElement("th", null, import_react90.default.createElement("input", { type: "checkbox", value: "checked", "aria-label": "all-checkbox", "data-testid": "all-checkbox", checked: B(), onChange: (C) => T2(C) })), L.map((C) => import_react90.default.createElement("th", { key: C.name }, import_react90.default.createElement(Menu, { shadow: "md", width: 240, position: "bottom-end" }, import_react90.default.createElement(Menu.Target, null, import_react90.default.createElement(UnstyledButton, { className: o.control }, import_react90.default.createElement(Group, { position: "apart", noWrap: true }, import_react90.default.createElement(Text, { weight: 500, size: "sm" }, Pe(C.name)), import_react90.default.createElement(Center, { className: o.icon }, import_react90.default.createElement(Tr, { size: 14, stroke: 1.5 }))))), import_react90.default.createElement(zl, { search: e.search, searchParams: C.searchParams, onPrompt: (U, Ne) => {
    u2({ ...c.current, filterDialogVisible: true, filterDialogSearchParam: U, filterDialogFilter: Ne });
  }, onChange: (U) => {
    k2(U);
  } }))))), !e.hideFilters && import_react90.default.createElement("tr", null, v && import_react90.default.createElement("th", null), L.map((C) => import_react90.default.createElement("th", { key: C.name }, C.searchParams && import_react90.default.createElement(Xx, { resourceType: Z, searchParams: C.searchParams, filters: e.search.filters }))))), import_react90.default.createElement("tbody", null, ro == null ? void 0 : ro.map((C) => C && import_react90.default.createElement("tr", { key: C.id, className: o.tr, "data-testid": "search-control-row", onClick: (U) => A(U, C), onAuxClick: (U) => A(U, C) }, v && import_react90.default.createElement("td", null, import_react90.default.createElement("input", { type: "checkbox", value: "checked", "data-testid": "row-checkbox", "aria-label": `Checkbox for ${C.id}`, checked: !!i.selected[C.id], onChange: (U) => g(U, C.id) })), L.map((U) => import_react90.default.createElement("td", { key: U.name }, El(C, U))))))), (ro == null ? void 0 : ro.length) === 0 && import_react90.default.createElement(je, null, import_react90.default.createElement(Center, { style: { height: 150 } }, import_react90.default.createElement(Text, { size: "xl", color: "dimmed" }, "No results"))), (ae2 == null ? void 0 : ae2.total) !== void 0 && ae2.total > 0 && import_react90.default.createElement(Center, { m: "md", p: "md" }, import_react90.default.createElement(Pagination, { value: Jx(s), total: $x(s, ae2.total), onChange: (C) => k2(Ml(s, C)), getControlProps: (C) => {
    switch (C) {
      case "previous":
        return { "aria-label": "Previous page" };
      case "next":
        return { "aria-label": "Next page" };
      default:
        return {};
    }
  } })), n && import_react90.default.createElement("div", { "data-testid": "search-error" }, import_react90.default.createElement("pre", { style: { textAlign: "left" } }, JSON.stringify(n, void 0, 2))), import_react90.default.createElement(Rl, { search: e.search, visible: c.current.fieldEditorVisible, onOk: (C) => {
    k2(C), u2({ ...c.current, fieldEditorVisible: false });
  }, onCancel: () => {
    u2({ ...c.current, fieldEditorVisible: false });
  } }), import_react90.default.createElement(Ul, { search: e.search, visible: c.current.filterEditorVisible, onOk: (C) => {
    k2(C), u2({ ...c.current, filterEditorVisible: false });
  }, onCancel: () => {
    u2({ ...c.current, filterEditorVisible: false });
  } }), import_react90.default.createElement(yl, { visible: c.current.exportDialogVisible, exportCsv: e.onExportCsv, exportTransactionBundle: e.onExportTransactionBundle, onCancel: () => {
    u2({ ...c.current, exportDialogVisible: false });
  } }), import_react90.default.createElement(Ql, { key: (_c2 = i.filterDialogSearchParam) == null ? void 0 : _c2.code, visible: c.current.filterDialogVisible, title: ((_d2 = i.filterDialogSearchParam) == null ? void 0 : _d2.code) ? Pe(i.filterDialogSearchParam.code) : "", resourceType: Z, searchParam: i.filterDialogSearchParam, filter: i.filterDialogFilter, defaultValue: "", onOk: (C) => {
    k2(Ho(e.search, C.code, C.operator, C.value)), u2({ ...c.current, filterDialogVisible: false });
  }, onCancel: () => {
    u2({ ...c.current, filterDialogVisible: false });
  } }));
}
var qF = import_react90.default.memo(Wx);
function Xx(e) {
  let o = (e.filters ?? []).filter((t) => e.searchParams.find((r) => r.code === t.code));
  return o.length === 0 ? import_react90.default.createElement("span", null, "no filters") : import_react90.default.createElement(import_react90.default.Fragment, null, o.map((t) => import_react90.default.createElement("div", { key: `filter-${t.code}-${t.operator}-${t.value}` }, st2(t.operator), " ", import_react90.default.createElement(_t, { resourceType: e.resourceType, filter: t }))));
}
function Jx(e) {
  return Math.floor((e.offset ?? 0) / (e.count ?? Fa)) + 1;
}
function $x(e, o) {
  let t = e.count ?? Fa;
  return Math.ceil(o / t);
}
function Kx(e, o) {
  return Math.min(o, (e.offset ?? 0) + 1);
}
function jx(e, o) {
  return Math.min(o, ((e.offset ?? 0) + 1) * (e.count ?? Fa));
}
function oI(e) {
  let o = P2(), [t, r] = (0, import_react88.useState)(false), [a, n] = (0, import_react88.useState)(), { query: f, fields: s } = e, [l, i] = (0, import_react88.useState)(), [u2, c] = (0, import_react88.useState)({}), d = (0, import_react88.useRef)();
  d.current = l;
  let x = (0, import_react88.useRef)({});
  x.current = u2, (0, import_react88.useEffect)(() => {
    n(void 0), o.graphql(f).then(i).catch((A) => n(Oe(A)));
  }, [o, f]);
  function y(A, W) {
    A.stopPropagation();
    let L = A.target.checked, Z = { ...x.current };
    L ? Z[W] = true : delete Z[W], c(Z);
  }
  function g(A) {
    var _a2;
    A.stopPropagation();
    let v = A.target.checked, L = {}, Z = (_a2 = d.current) == null ? void 0 : _a2.data.ResourceList;
    v && Z && Z.forEach((ae2) => {
      ae2.id && (L[ae2.id] = true);
    }), c(L);
  }
  function T2() {
    var _a2;
    let A = (_a2 = d.current) == null ? void 0 : _a2.data.ResourceList;
    if (!A || A.length === 0)
      return false;
    for (let W of A)
      if (W.id && !x.current[W.id])
        return false;
    return true;
  }
  function B(A, W) {
    bt(A.target) || (R(A), A.button !== 1 && e.onClick && e.onClick(new co(W, A)), A.button === 1 && e.onAuxClick && e.onAuxClick(new co(W, A)));
  }
  if ((0, import_react88.useEffect)(() => {
    o.requestSchema(e.resourceType).then(() => r(true)).catch(console.log);
  }, [o, e.resourceType]), !t)
    return import_react88.default.createElement(Loader, null);
  let k2 = e.checkboxesEnabled;
  return import_react88.default.createElement("div", { onContextMenu: (A) => R(A), "data-testid": "search-control" }, import_react88.default.createElement(Table, null, import_react88.default.createElement("thead", null, import_react88.default.createElement("tr", null, k2 && import_react88.default.createElement("th", null, import_react88.default.createElement("input", { type: "checkbox", value: "checked", "aria-label": "all-checkbox", "data-testid": "all-checkbox", checked: T2(), onChange: (A) => g(A) })), s.map((A) => import_react88.default.createElement("th", { key: A.name }, A.name)))), import_react88.default.createElement("tbody", null, l == null ? void 0 : l.data.ResourceList.map((A) => A && import_react88.default.createElement("tr", { key: A.id, "data-testid": "search-control-row", onClick: (W) => B(W, A), onAuxClick: (W) => B(W, A) }, k2 && import_react88.default.createElement("td", null, import_react88.default.createElement("input", { type: "checkbox", value: "checked", "data-testid": "row-checkbox", "aria-label": `Checkbox for ${A.id}`, checked: !!u2[A.id], onChange: (W) => y(W, A.id) })), s.map((W) => import_react88.default.createElement("td", { key: W.name }, import_react88.default.createElement(hl, { propertyType: W.propertyType, path: W.fhirPath, resource: A }))))))), (l == null ? void 0 : l.data.ResourceList.length) === 0 && import_react88.default.createElement("div", { "data-testid": "empty-search" }, "No results"), a && import_react88.default.createElement("div", { "data-testid": "search-error" }, import_react88.default.createElement("pre", { style: { textAlign: "left" } }, JSON.stringify(a, void 0, 2))), e.onBulk && import_react88.default.createElement(Button, { onClick: () => e.onBulk(Object.keys(x.current)) }, "Bulk..."));
}
var KF = import_react88.default.memo(oI);
function eo(e) {
  return import_react99.default.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 491 491", style: { width: e.size, height: e.size } }, import_react99.default.createElement("title", null, "Medplum Logo"), import_react99.default.createElement("path", { fill: e.fill ?? "#ad7136", d: "M282 67c6-16 16-29 29-40L289 0c-22 17-37 41-43 68l17 23 19-24z" }), import_react99.default.createElement("path", { fill: e.fill ?? "#946af9", d: "M311 63c-17 0-33 4-48 11-16-7-32-11-49-11-87 0-158 96-158 214s71 214 158 214c17 0 33-4 49-11 15 7 31 11 48 11 87 0 158-96 158-214S398 63 311 63z" }), import_react99.default.createElement("path", { fill: e.fill ?? "#7857c5", d: "M231 489l-17 2c-87 0-158-96-158-214S127 63 214 63l17 1c-39 12-70 102-70 213s31 201 70 212z" }), import_react99.default.createElement("path", { fill: e.fill ?? "#40bc26", d: "M207 220a176 176 0 01-177 43A176 176 0 01251 43l1 5c17 59 2 125-45 172z" }), import_react99.default.createElement("path", { fill: e.fill ?? "#33961e", d: "M252 48A421 421 0 0057 270l-27-7A176 176 0 01251 43l1 5z" }));
}
function es2(e) {
  let { group: o } = e;
  return import_react101.default.createElement(Paper, { withBorder: true, radius: "md", p: "xs", display: "flex", sx: { alignItems: "center", justifyContent: "center" } }, import_react101.default.createElement(Group, null, o.measureScore && import_react101.default.createElement(nI, { group: o }), !o.measureScore && import_react101.default.createElement(aI, { group: o })));
}
function os(e) {
  let { measure: o } = e;
  return import_react101.default.createElement(import_react101.default.Fragment, null, import_react101.default.createElement(Text, { fz: "md", fw: 500, mb: 8 }, o.title), import_react101.default.createElement(Text, { fz: "xs", c: "dimmed", mb: 8 }, o.subtitle));
}
function aI(e) {
  let { group: o } = e, t = o.population, r = t == null ? void 0 : t.find((l) => Nn(l.code) === "numerator"), a = t == null ? void 0 : t.find((l) => Nn(l.code) === "denominator"), n = r == null ? void 0 : r.count, f = a == null ? void 0 : a.count;
  if (f === 0)
    return import_react101.default.createElement(Box, null, import_react101.default.createElement(Title, { order: 3 }, "Not Applicable"), import_react101.default.createElement(Text, null, `Denominator: ${f}`));
  if (n === void 0 || f === void 0)
    return import_react101.default.createElement(Box, null, import_react101.default.createElement(Title, { order: 3 }, "Insufficient Data"), import_react101.default.createElement(Text, null, `Numerator: ${n}`), import_react101.default.createElement(Text, null, `Denominator: ${f}`));
  let s = n / f * 100;
  return import_react101.default.createElement(RingProgress, { size: 120, thickness: 12, roundCaps: true, sections: [{ value: s, color: ts2(s) }], label: import_react101.default.createElement(Flex, { justify: "center" }, import_react101.default.createElement(Text, { fw: 700, fz: 18 }, n, " / ", f)) });
}
function nI(e) {
  var _a2, _b, _c2;
  let { group: o } = e, t = ((_a2 = o.measureScore) == null ? void 0 : _a2.unit) ?? ((_b = o.measureScore) == null ? void 0 : _b.code);
  return import_react101.default.createElement(import_react101.default.Fragment, null, t === "%" ? import_react101.default.createElement(RingProgress, { size: 120, thickness: 12, roundCaps: true, sections: [{ value: fI(o), color: ts2(((_c2 = o == null ? void 0 : o.measureScore) == null ? void 0 : _c2.value) ?? 0) }], label: import_react101.default.createElement(Flex, { justify: "center" }, import_react101.default.createElement(Text, { fw: 700, fz: 18 }, import_react101.default.createElement(Ke, { value: o.measureScore }))) }) : import_react101.default.createElement(Flex, { h: 120, align: "center" }, import_react101.default.createElement(Title, { order: 3 }, import_react101.default.createElement(Ke, { value: o.measureScore }))));
}
function fI(e) {
  var _a2, _b;
  let o = (_a2 = e.measureScore) == null ? void 0 : _a2.value, t = (_b = e.measureScore) == null ? void 0 : _b.unit;
  return o ? o <= 1 && t === "%" ? o * 100 : o : 0;
}
function ts2(e) {
  return e <= 33 ? "red" : e <= 67 ? "yellow" : "green";
}
function sw(e) {
  var _a2;
  let o = z2(e.measureReport), [t] = yn("Measure", { url: o == null ? void 0 : o.measure });
  return o ? import_react100.default.createElement(Box, null, t && import_react100.default.createElement(os, { measure: t }), import_react100.default.createElement(SimpleGrid, { cols: 3, breakpoints: [{ maxWidth: "48rem", cols: 2, spacing: "md" }, { maxWidth: "36rem", cols: 1, spacing: "sm" }], spacing: "md" }, (_a2 = o.group) == null ? void 0 : _a2.map((r, a) => import_react100.default.createElement(es2, { key: r.id ?? a, group: r })))) : null;
}
function Uo2(e) {
  var _a2;
  let o = ((_a2 = e.outcome) == null ? void 0 : _a2.issue) || e.issues;
  return !o || o.length === 0 ? null : import_react102.default.createElement(Alert, { icon: import_react102.default.createElement(no, { size: 16 }), color: "red" }, o.map((t) => {
    var _a3;
    return import_react102.default.createElement("div", { "data-testid": "text-field-error", key: (_a3 = t.details) == null ? void 0 : _a3.text }, Wn(t));
  }));
}
function yw(e) {
  let o = (0, import_react103.useCallback)((t, r, a) => {
    let n = `${r}/${a}`, f = 100;
    return Promise.allSettled([t.readHistory("Patient", a), t.search("Communication", { subject: n, _count: f }), t.search("Device", { patient: n, _count: f }), t.search("DeviceRequest", { patient: n, _count: f }), t.search("DiagnosticReport", { subject: n, _count: f }), t.search("Media", { subject: n, _count: f }), t.search("ServiceRequest", { subject: n, _count: f }), t.search("Task", { subject: n, _count: f })]);
  }, []);
  return import_react103.default.createElement(Ye, { value: e.patient, loadTimelineResources: o, createCommunication: (t, r, a) => ({ resourceType: "Communication", status: "completed", subject: G(t), sender: G(r), sent: (/* @__PURE__ */ new Date()).toISOString(), payload: [{ contentString: a }] }), createMedia: (t, r, a) => ({ resourceType: "Media", status: "completed", subject: G(t), operator: G(r), issued: (/* @__PURE__ */ new Date()).toISOString(), content: a }) });
}
var fs = createStyles((e) => ({ section: { position: "relative", margin: "4px 4px 8px 0", padding: "6px 12px 16px 6px", border: `1.5px solid ${e.colors.gray[1]}`, borderRadius: e.radius.sm, transition: "all 0.1s" }, hovering: { border: `1.5px solid ${e.colors.blue[5]}` }, editing: { border: `1.5px solid ${e.colors.gray[1]}`, borderLeft: `4px solid ${e.colors.blue[5]}` }, bottomActions: { position: "absolute", right: 4, bottom: 0, fontSize: e.fontSizes.xs, "& a": { marginLeft: 8 } } }));
function Rw(e) {
  let o = P2(), t = z2(e.value), [r, a] = (0, import_react104.useState)(false), [n, f] = (0, import_react104.useState)(), [s, l] = (0, import_react104.useState)(), [i, u2] = (0, import_react104.useState)();
  function c() {
    l(void 0);
  }
  function d() {
    f(void 0);
  }
  let x = (0, import_react104.useRef)();
  if (x.current = i, (0, import_react104.useEffect)(() => {
    o.requestSchema("PlanDefinition").then(() => a(true)).catch(console.log);
  }, [o]), (0, import_react104.useEffect)(() => (u2(bI(t ?? { resourceType: "PlanDefinition" })), document.addEventListener("mouseover", c), document.addEventListener("click", d), () => {
    document.removeEventListener("mouseover", c), document.removeEventListener("click", d);
  }), [t]), !r || !i)
    return null;
  function y(g, T2) {
    u2({ ...x.current, [g]: T2 });
  }
  return import_react104.default.createElement("div", null, import_react104.default.createElement($, { testid: "questionnaire-form", onSubmit: () => e.onSubmit(i) }, import_react104.default.createElement(TextInput, { label: "Plan Title", defaultValue: i.title, onChange: (g) => y("title", g.currentTarget.value) }), import_react104.default.createElement(ls, { actions: i.action || [], selectedKey: n, setSelectedKey: f, hoverKey: s, setHoverKey: l, onChange: (g) => y("action", g) }), import_react104.default.createElement(Button, { type: "submit" }, "Save")));
}
function ls(e) {
  let { classes: o } = fs(), t = (0, import_react104.useRef)();
  t.current = e.actions;
  function r(f) {
    e.onChange(t.current.map((s) => s.id === f.id ? f : s));
  }
  function a(f) {
    e.onChange([...t.current, f]), e.setSelectedKey(f.id);
  }
  function n(f) {
    e.onChange(t.current.filter((s) => s !== f));
  }
  return import_react104.default.createElement("div", { className: o.section }, e.actions.map((f) => import_react104.default.createElement("div", { key: f.id }, import_react104.default.createElement(hI, { action: f, selectedKey: e.selectedKey, setSelectedKey: e.setSelectedKey, hoverKey: e.hoverKey, setHoverKey: e.setHoverKey, onChange: r, onRemove: () => n(f) }))), import_react104.default.createElement("div", { className: o.bottomActions }, import_react104.default.createElement(Anchor, { href: "#", onClick: (f) => {
    R(f), a({ id: is() });
  } }, "Add action")));
}
function hI(e) {
  let { classes: o, cx: t } = fs(), { action: r } = e, a = SI(r), n = e.selectedKey === e.action.id, f = e.hoverKey === e.action.id;
  function s(u2) {
    u2.stopPropagation(), e.setSelectedKey(e.action.id);
  }
  function l(u2) {
    R(u2), e.setHoverKey(e.action.id);
  }
  let i = t(o.section, { [o.editing]: n, [o.hovering]: f && !n });
  return import_react104.default.createElement("div", { "data-testid": r.id, className: i, onClick: s, onMouseOver: l }, n ? import_react104.default.createElement(yI, { action: r, actionType: a, onChange: e.onChange, selectedKey: e.selectedKey, setSelectedKey: e.setSelectedKey, hoverKey: e.hoverKey, setHoverKey: e.setHoverKey, onRemove: e.onRemove }) : import_react104.default.createElement(CI, { action: r, actionType: a }), import_react104.default.createElement("div", { className: o.bottomActions }, import_react104.default.createElement(Anchor, { href: "#", onClick: (u2) => {
    u2.preventDefault(), e.onRemove();
  } }, "Remove")));
}
var Xa = { path: "PlanDefinition.action.timing[x]", min: 0, max: 1, description: "", isArray: false, constraints: [], type: ["dateTime", "Period", "Range", "Timing"].map((e) => ({ code: e })) };
function CI(e) {
  let { action: o, actionType: t } = e, [r, a] = ss(o);
  return import_react104.default.createElement("div", null, import_react104.default.createElement("div", null, o.title || "Untitled", " ", t && `(${t})`), o.definitionCanonical && import_react104.default.createElement("div", null, import_react104.default.createElement(lo, { value: { reference: o.definitionCanonical } })), r && import_react104.default.createElement("div", null, import_react104.default.createElement(me, { property: Xa, propertyType: a, value: r })));
}
function yI(e) {
  let { action: o } = e, [t, r] = (0, import_react104.useState)(e.actionType);
  function a(n, f) {
    e.onChange({ ...o, [n]: f });
  }
  return import_react104.default.createElement(Stack, { spacing: "xl" }, import_react104.default.createElement(TextInput, { name: `actionTitle-${o.id}`, label: "Title", defaultValue: o.title, onChange: (n) => a("title", n.currentTarget.value) }), import_react104.default.createElement(TextInput, { name: `actionDescription-${o.id}`, label: "Description", defaultValue: o.description, onChange: (n) => a("description", n.currentTarget.value) }), import_react104.default.createElement(NativeSelect, { label: "Type of Action", description: "The type of the action to be performed.", name: `actionType-${o.id}`, defaultValue: t, onChange: (n) => r(n.currentTarget.value), data: ["", "appointment", "lab", "questionnaire", "task"] }), o.action && o.action.length > 0 && import_react104.default.createElement(ls, { actions: o.action, selectedKey: e.selectedKey, setSelectedKey: e.setSelectedKey, hoverKey: e.hoverKey, setHoverKey: e.setHoverKey, onChange: (n) => a("action", n) }), (() => {
    switch (t) {
      case "appointment":
        return import_react104.default.createElement(nr, { title: "Appointment", description: "The subject must schedule an appointment from the schedule.", resourceType: "Schedule", action: o, onChange: e.onChange });
      case "lab":
        return import_react104.default.createElement(nr, { title: "Lab", description: "The subject must complete the following lab panel.", resourceType: "ActivityDefinition", action: o, onChange: e.onChange });
      case "questionnaire":
        return import_react104.default.createElement(nr, { title: "Questionnaire", description: "The subject must complete the selected questionnaire.", resourceType: "Questionnaire", action: o, onChange: e.onChange });
      case "task":
        return import_react104.default.createElement(nr, { title: "Task", description: "The subject must complete the following task.", resourceType: "ActivityDefinition", action: o, onChange: e.onChange });
      default:
        return null;
    }
  })(), import_react104.default.createElement(ye, { title: "Timing", description: "When the action should take place." }, import_react104.default.createElement(vI, { name: "timing-" + o.id, action: o, onChange: e.onChange })));
}
function nr(e) {
  let { id: o, definitionCanonical: t } = e.action, r = (t == null ? void 0 : t.startsWith(e.resourceType + "/")) ? { reference: t } : void 0;
  return import_react104.default.createElement(Vt, { name: o, resourceType: e.resourceType, defaultValue: r, loadOnFocus: true, onChange: (a) => {
    a ? e.onChange({ ...e.action, definitionCanonical: se(a) }) : e.onChange({ ...e.action, definitionCanonical: void 0 });
  } });
}
function vI(e) {
  let o = e.action, t = "timing", [r, a] = ss(o);
  return import_react104.default.createElement(qe, { property: Xa, name: "timing[x]", defaultValue: r, defaultPropertyType: a, onChange: (n, f) => {
    e.onChange(rt(o, t, f ?? t, Xa, n));
  } });
}
function SI(e) {
  var _a2, _b, _c2;
  if ((_a2 = e.definitionCanonical) == null ? void 0 : _a2.startsWith("Schedule"))
    return "appointment";
  if ((_b = e.definitionCanonical) == null ? void 0 : _b.startsWith("Questionnaire/"))
    return "questionnaire";
  if ((_c2 = e.definitionCanonical) == null ? void 0 : _c2.startsWith("ActivityDefinition/"))
    return "task";
}
function ss(e) {
  return Ce2({ type: "PlanDefinitionAction", value: e }, "timing");
}
var za = 1;
function is(e) {
  if (e) {
    if (e.startsWith("id-")) {
      let o = parseInt(e.substring(3), 10);
      isNaN(o) || (za = Math.max(za, o + 1));
    }
    return e;
  }
  return "id-" + za++;
}
function bI(e) {
  return { ...e, action: us(e.action) };
}
function us(e) {
  if (e)
    return e.map((o) => ({ ...o, id: is(o.id), action: us(o.action) }));
}
var fr = ((B) => (B.group = "group", B.display = "display", B.question = "question", B.boolean = "boolean", B.decimal = "decimal", B.integer = "integer", B.date = "date", B.dateTime = "dateTime", B.time = "time", B.string = "string", B.text = "text", B.url = "url", B.choice = "choice", B.openChoice = "open-choice", B.attachment = "attachment", B.reference = "reference", B.quantity = "quantity", B))(fr || {});
function ds(e) {
  return e.type === "choice" || e.type === "open-choice";
}
function cs(e, o) {
  if (!e.enableWhen)
    return true;
  let t = e.enableBehavior ?? "any";
  for (let r of e.enableWhen) {
    let a = ps2(o, r.question);
    if (r.operator === "exists" && !r.answerBoolean && !(a == null ? void 0 : a.length)) {
      if (t === "any")
        return true;
      continue;
    }
    let { anyMatch: n, allMatch: f } = MI(r, a, t);
    if (t === "any" && n)
      return true;
    if (t === "all" && !f)
      return false;
  }
  return t !== "any";
}
function ms(e, o, t) {
  return e.map((r) => {
    var _a2;
    let a = (_a2 = t.answerOption) == null ? void 0 : _a2.find((f) => Fn(f.valueCoding) === r || f[o] === r), n = I({ type: "QuestionnaireItemAnswerOption", value: a }, "value");
    return { [o]: n == null ? void 0 : n.value };
  });
}
function ps2(e, o) {
  if (e)
    for (let t of e) {
      if (t.linkId === o)
        return t.answer;
      if (t.item) {
        let r = ps2(t.item, o);
        if (r)
          return r;
      }
    }
}
function AI(e, o, t) {
  if (t === "exists")
    return !!e === o.value;
  if (e) {
    let r = t === "=" || t === "!=" ? t == null ? void 0 : t.replace("=", "~") : t, [{ value: a }] = pe(`%actualAnswer ${r} %expectedAnswer`, [e], { actualAnswer: e, expectedAnswer: o });
    return a;
  } else
    return false;
}
function MI(e, o, t) {
  let r = o || [], a = I({ type: "QuestionnaireItemEnableWhen", value: e }, "answer[x]"), n = false, f = true;
  for (let s of r) {
    let l = I({ type: "QuestionnaireResponseItemAnswer", value: s }, "value[x]"), { operator: i } = e;
    if (AI(l, a, i) ? n = true : f = false, t === "any" && n)
      break;
  }
  return { anyMatch: n, allMatch: f };
}
function lr(e) {
  var _a2, _b;
  let o = Uo(e, "http://hl7.org/fhir/StructureDefinition/questionnaire-referenceResource");
  if (o) {
    if (o.valueCode !== void 0)
      return [o.valueCode];
    if (o.valueCodeableConcept)
      return (_b = (_a2 = o.valueCodeableConcept) == null ? void 0 : _a2.coding) == null ? void 0 : _b.map((t) => t.code);
  }
}
function sr(e, o) {
  var _a2;
  let t = it(e), r = Uo(t, "http://hl7.org/fhir/StructureDefinition/questionnaire-referenceResource");
  return !o || o.length === 0 ? (r && (t.extension = (_a2 = t.extension) == null ? void 0 : _a2.filter((a) => a !== r)), t) : (r || (t.extension || (t.extension = []), r = { url: "http://hl7.org/fhir/StructureDefinition/questionnaire-referenceResource" }, t.extension.push(r)), o.length === 1 ? (r.valueCode = o[0], delete r.valueCodeableConcept) : (r.valueCodeableConcept = { coding: o.map((a) => ({ code: a })) }, delete r.valueCode), t);
}
function xs(e) {
  return { resourceType: "QuestionnaireResponse", questionnaire: se(e), item: Is(e.item) };
}
function Is(e) {
  return (e == null ? void 0 : e.map(Ka)) ?? [];
}
function Ka(e) {
  var _a2;
  return { id: wI(), linkId: e.linkId, text: e.text, item: Is(e.item), answer: ((_a2 = e.initial) == null ? void 0 : _a2.map(OI)) ?? [] };
}
var FI = 1;
function wI() {
  return "id-" + FI++;
}
function OI(e) {
  return { ...e };
}
function gs(e) {
  return e.value.display || e.value.reference || zt(e.value);
}
function hs(e) {
  var _a2, _b, _c2, _d2, _e2;
  let o = (_a2 = e == null ? void 0 : e.item) == null ? void 0 : _a2[0];
  return o && ((_e2 = (_d2 = (_c2 = (_b = Uo(o, "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl")) == null ? void 0 : _b.valueCodeableConcept) == null ? void 0 : _c2.coding) == null ? void 0 : _d2[0]) == null ? void 0 : _e2.code) === "page" ? e.item.length : 1;
}
function ct(e) {
  let o = e.item, t = e.response;
  function r(l) {
    var _a2, _b, _c2, _d2;
    let i;
    Array.isArray(l) ? i = l : e.index >= (((_b = (_a2 = e.response) == null ? void 0 : _a2.answer) == null ? void 0 : _b.length) ?? 0) ? i = (((_c2 = e.response) == null ? void 0 : _c2.answer) ?? []).concat([l]) : i = (((_d2 = e.response) == null ? void 0 : _d2.answer) ?? []).map((c, d) => d === e.index ? l : c) ?? [], e.onChange({ id: t == null ? void 0 : t.id, linkId: t == null ? void 0 : t.linkId, text: o.text, answer: i });
  }
  let a = o.type;
  if (!a)
    return null;
  let n = o.linkId;
  if (!n)
    return null;
  let f = o.initial && o.initial.length > 0 ? o.initial[0] : void 0, s = _a(t, e.index) ?? I({ type: "QuestionnaireItemInitial", value: f }, "value");
  switch (a) {
    case "display":
      return import_react106.default.createElement("p", { key: e.item.linkId }, e.item.text);
    case "boolean":
      return import_react106.default.createElement(wt, { key: e.item.linkId, title: e.item.text, htmlFor: e.item.linkId }, import_react106.default.createElement(Checkbox, { id: e.item.linkId, name: e.item.linkId, defaultChecked: s == null ? void 0 : s.value, onChange: (l) => r({ valueBoolean: l.currentTarget.checked }) }));
    case "decimal":
      return import_react106.default.createElement(TextInput, { type: "number", step: "any", id: n, name: n, required: o.required, defaultValue: s == null ? void 0 : s.value, onChange: (l) => r({ valueDecimal: l.currentTarget.valueAsNumber }) });
    case "integer":
      return import_react106.default.createElement(TextInput, { type: "number", step: 1, id: n, name: n, required: o.required, defaultValue: s == null ? void 0 : s.value, onChange: (l) => r({ valueInteger: l.currentTarget.valueAsNumber }) });
    case "date":
      return import_react106.default.createElement(TextInput, { type: "date", id: n, name: n, required: o.required, defaultValue: s == null ? void 0 : s.value, onChange: (l) => r({ valueDate: l.currentTarget.value }) });
    case "dateTime":
      return import_react106.default.createElement(ke, { name: n, required: o.required, defaultValue: s == null ? void 0 : s.value, onChange: (l) => r({ valueDateTime: l }) });
    case "time":
      return import_react106.default.createElement(TextInput, { type: "time", id: n, name: n, required: o.required, defaultValue: s == null ? void 0 : s.value, onChange: (l) => r({ valueTime: l.currentTarget.value }) });
    case "string":
    case "url":
      return import_react106.default.createElement(TextInput, { id: n, name: n, required: o.required, defaultValue: s == null ? void 0 : s.value, onChange: (l) => r({ valueString: l.currentTarget.value }) });
    case "text":
      return import_react106.default.createElement(Textarea, { id: n, name: n, required: o.required, defaultValue: s == null ? void 0 : s.value, onChange: (l) => r({ valueString: l.currentTarget.value }) });
    case "attachment":
      return import_react106.default.createElement(Group, { py: 4 }, import_react106.default.createElement(Tt, { name: n, defaultValue: s == null ? void 0 : s.value, onChange: (l) => r({ valueAttachment: l }) }));
    case "reference":
      return import_react106.default.createElement(Oo, { name: n, required: o.required, targetTypes: lr(o), defaultValue: s == null ? void 0 : s.value, onChange: (l) => r({ valueReference: l }) });
    case "quantity":
      return import_react106.default.createElement(Se, { name: n, required: o.required, defaultValue: s == null ? void 0 : s.value, onChange: (l) => r({ valueQuantity: l }), disableWheel: true });
    case "choice":
    case "open-choice":
      return JI(o) && !o.answerValueSet ? import_react106.default.createElement(UI, { name: n, item: o, initial: f, response: t, onChangeAnswer: (l) => r(l) }) : import_react106.default.createElement(QI, { name: n, item: o, initial: f, response: t, onChangeAnswer: (l) => r(l) });
    default:
      return null;
  }
}
function UI(e) {
  var _a2;
  let { name: o, item: t, initial: r, response: a } = e;
  if (!((_a2 = t.answerOption) == null ? void 0 : _a2.length))
    return import_react106.default.createElement(bs, null);
  let n = I({ type: "QuestionnaireItemInitial", value: r }, "value"), f = [""];
  for (let l of t.answerOption) {
    let i = I({ type: "QuestionnaireItemAnswerOption", value: l }, "value");
    f.push(vs(i));
  }
  let s = _a(a) ?? n;
  if (t.repeats) {
    let { propertyName: l, data: i } = $I(e.item), u2 = WI(a);
    return import_react106.default.createElement(MultiSelect, { data: i, placeholder: "Select items", searchable: true, defaultValue: u2 || [vs(n)], onChange: (c) => {
      let d = ms(c, l, t);
      e.onChangeAnswer(d);
    } });
  }
  return import_react106.default.createElement(NativeSelect, { id: o, name: o, onChange: (l) => {
    let i = l.currentTarget.selectedIndex;
    if (i === 0) {
      e.onChangeAnswer({});
      return;
    }
    let u2 = t.answerOption[i - 1], c = I({ type: "QuestionnaireItemAnswerOption", value: u2 }, "value"), d = "value" + P(c.type);
    e.onChangeAnswer({ [d]: c.value });
  }, defaultValue: Fn(s == null ? void 0 : s.value) || (s == null ? void 0 : s.value), data: f });
}
function QI(e) {
  var _a2;
  let { name: o, item: t, initial: r, onChangeAnswer: a, response: n } = e;
  return !((_a2 = t.answerOption) == null ? void 0 : _a2.length) && !t.answerValueSet ? import_react106.default.createElement(bs, null) : t.answerValueSet ? import_react106.default.createElement(Et, { name: o, binding: t.answerValueSet, onChange: (f) => a({ valueCoding: f }) }) : import_react106.default.createElement(zI, { name: (n == null ? void 0 : n.id) ?? o, item: t, initial: r, response: n, onChangeAnswer: a });
}
function zI(e) {
  let { name: o, item: t, initial: r, onChangeAnswer: a, response: n } = e, f = Ce("QuestionnaireItemAnswerOption", "value[x]"), s = I({ type: "QuestionnaireItemInitial", value: r }, "value"), l = [], i;
  if (t.answerOption)
    for (let d = 0; d < t.answerOption.length; d++) {
      let x = t.answerOption[d], y = `${o}-option-${d}`, g = I({ type: "QuestionnaireItemAnswerOption", value: x }, "value");
      s && zt(g) === zt(s) && (i = y), l.push([y, g]);
    }
  let u2 = _a(n), c = XI(l, u2);
  return import_react106.default.createElement(Radio.Group, { name: o, value: c ?? i, onChange: (d) => {
    let x = l.find((y) => y[0] === d);
    if (x) {
      let y = x[1], g = "value" + P(y.type);
      a({ [g]: y.value });
    }
  } }, l.map(([d, x]) => import_react106.default.createElement(Radio, { key: d, id: d, value: d, py: 4, label: import_react106.default.createElement(me, { property: f, propertyType: x.type, value: x.value }) })));
}
function bs() {
  return import_react106.default.createElement(TextInput, { disabled: true, placeholder: "No Answers Defined" });
}
function Ps(e) {
  return I({ type: "QuestionnaireItemAnswer", value: e }, "value");
}
function _a(e, o = 0) {
  let t = e.answer;
  return Ps((t == null ? void 0 : t[o]) ?? {});
}
function WI(e) {
  let o = e.answer;
  return o ? o.map((r) => Ps(r)).map((r) => Fn(r == null ? void 0 : r.value) || (r == null ? void 0 : r.value)) : [];
}
function XI(e, o) {
  var _a2;
  return (_a2 = e.find((t) => ve(t[1].value, o == null ? void 0 : o.value))) == null ? void 0 : _a2[0];
}
function vs(e) {
  if (e)
    return e.type === "CodeableConcept" ? Nn(e.value) : e.type === "Coding" ? Fn(e.value) : e.type === "Reference" ? gs(e) : e.value.toString();
}
function JI(e) {
  var _a2;
  return !!((_a2 = e.extension) == null ? void 0 : _a2.some((o) => {
    var _a3, _b, _c2;
    return o.url === "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl" && ((_c2 = (_b = (_a3 = o.valueCodeableConcept) == null ? void 0 : _a3.coding) == null ? void 0 : _b[0]) == null ? void 0 : _c2.code) === "drop-down";
  }));
}
function $I(e) {
  var _a2;
  if (((_a2 = e.answerOption) == null ? void 0 : _a2.length) === 0)
    return { propertyName: "", data: [] };
  let o = e.answerOption[0], t = I({ type: "QuestionnaireItemAnswerOption", value: o }, "value"), r = "value" + P(t.type), a = (e.answerOption ?? []).map((n) => ({ value: Ss(n, r), label: Ss(n, r) }));
  return { propertyName: r, data: a };
}
function Ss(e, o) {
  var _a2;
  return Fn(e.valueCoding) || ((_a2 = e[o]) == null ? void 0 : _a2.toString());
}
var ng = createStyles((e) => ({ section: { position: "relative", margin: "4px 4px 8px 0", padding: "6px 12px 16px 6px", border: `1.5px solid ${e.colors.gray[1]}`, borderRadius: e.radius.sm, transition: "all 0.1s" }, hovering: { border: `1.5px solid ${e.colors.blue[5]}` }, editing: { border: `1.5px solid ${e.colors.gray[1]}`, borderLeft: `4px solid ${e.colors.blue[5]}` }, questionBody: { maxWidth: 600 }, topActions: { position: "absolute", right: 32, top: 1, padding: 4, color: e.colors.gray[5], fontSize: e.fontSizes.xs }, bottomActions: { position: "absolute", right: 4, bottom: 0, fontSize: e.fontSizes.xs, "& a": { marginLeft: 8 } }, movementActions: { position: "absolute", right: 8, top: 0, paddingTop: 8, fontSize: e.fontSizes.xs, "& a": { marginLeft: 8 } }, movementIcons: { color: e.colors.gray[5] }, columnAlignment: { display: "flex", flexDirection: "column" }, linkIdInput: { width: 100, marginBottom: 4 }, typeSelect: { width: 100 } }));
function mO(e) {
  let o = P2(), t = z2(e.questionnaire), [r, a] = (0, import_react105.useState)(false), [n, f] = (0, import_react105.useState)(), [s, l] = (0, import_react105.useState)(), [i, u2] = (0, import_react105.useState)();
  function c() {
    u2(void 0);
  }
  function d() {
    l(void 0);
  }
  return (0, import_react105.useEffect)(() => {
    o.requestSchema("Questionnaire").then(() => a(true)).catch(console.log);
  }, [o]), (0, import_react105.useEffect)(() => (f(ig(t ?? { resourceType: "Questionnaire" })), document.addEventListener("mouseover", c), document.addEventListener("click", d), () => {
    document.removeEventListener("mouseover", c), document.removeEventListener("click", d);
  }), [t]), !r || !n ? null : import_react105.default.createElement("div", null, import_react105.default.createElement($, { testid: "questionnaire-form", onSubmit: () => e.onSubmit(n) }, import_react105.default.createElement(Ts, { item: n, selectedKey: s, setSelectedKey: l, hoverKey: i, setHoverKey: u2, onChange: f }), import_react105.default.createElement(Button, { type: "submit" }, "Save")));
}
function Ts(e) {
  var _a2;
  let { classes: o, cx: t } = ng(), r = e.item, a = e.item, n = N(e.item), f = n || a.type === "group", s = a.linkId ?? "[untitled]", l = e.selectedKey === e.item.id, i = e.hoverKey === e.item.id, u2 = (0, import_react105.useRef)();
  u2.current = e.item;
  function c(v) {
    R(v), e.setSelectedKey(e.item.id);
  }
  function d(v) {
    R(v), e.setHoverKey(e.item.id);
  }
  function x(v) {
    var _a3;
    let L = u2.current;
    e.onChange({ ...L, item: (_a3 = L.item) == null ? void 0 : _a3.map((Z) => Z.id === v.id ? v : Z) });
  }
  function y(v) {
    e.onChange({ ...e.item, item: [...e.item.item ?? [], v] });
  }
  function g(v) {
    var _a3;
    e.onChange({ ...e.item, item: (_a3 = e.item.item) == null ? void 0 : _a3.filter((L) => L !== v) });
  }
  function T2(v, L) {
    e.onChange({ ...u2.current, [v]: L });
  }
  function B(v) {
    e.onChange({ ...e.item, ...v });
  }
  function k2(v) {
    var _a3;
    e.onChange({ ...e.item, item: (_a3 = e.item.item) == null ? void 0 : _a3.map((L) => L === v ? { ...L, repeats: !L.repeats } : L) });
  }
  function A(v, L) {
    let Z = cg(e.item.item, v, L);
    e.onChange({ ...e.item, item: Z });
  }
  let W = t(o.section, { [o.editing]: l, [o.hovering]: i && !l });
  return import_react105.default.createElement("div", { "data-testid": a.linkId, className: W, onClick: c, onMouseOver: d }, import_react105.default.createElement("div", { className: o.questionBody }, l ? import_react105.default.createElement(import_react105.default.Fragment, null, n && import_react105.default.createElement(TextInput, { size: "xl", defaultValue: r.title, onChange: (v) => T2("title", v.currentTarget.value) }), !n && import_react105.default.createElement(Textarea, { autosize: true, minRows: 2, defaultValue: a.text, onChange: (v) => T2("text", v.currentTarget.value) }), a.type === "reference" && import_react105.default.createElement(sg, { item: a, onChange: B }), ds(a) && import_react105.default.createElement(fg, { item: a, onChange: (v) => B(v) })) : import_react105.default.createElement(import_react105.default.Fragment, null, r.title && import_react105.default.createElement(Title, null, r.title), a.text && import_react105.default.createElement("div", null, a.text), !f && import_react105.default.createElement(ct, { item: a, index: 0, onChange: () => {
  }, response: {} }))), (_a2 = a.item) == null ? void 0 : _a2.map((v, L) => import_react105.default.createElement("div", { key: v.id }, import_react105.default.createElement(Ts, { item: v, selectedKey: e.selectedKey, setSelectedKey: e.setSelectedKey, hoverKey: e.hoverKey, isFirst: L === 0, isLast: L === (e.item.item ?? []).length - 1, setHoverKey: e.setHoverKey, onChange: x, onRemove: () => g(v), onRepeatable: k2, onMoveUp: () => A(L, -1), onMoveDown: () => A(L, 1) }))), !f && import_react105.default.createElement("div", { className: o.topActions }, l ? import_react105.default.createElement(import_react105.default.Fragment, null, import_react105.default.createElement(TextInput, { size: "xs", className: o.linkIdInput, defaultValue: a.linkId, onChange: (v) => T2("linkId", v.currentTarget.value) }), !f && import_react105.default.createElement(NativeSelect, { size: "xs", className: o.typeSelect, defaultValue: a.type, onChange: (v) => T2("type", v.currentTarget.value), data: [{ value: "display", label: "Display" }, { value: "boolean", label: "Boolean" }, { value: "decimal", label: "Decimal" }, { value: "integer", label: "Integer" }, { value: "date", label: "Date" }, { value: "dateTime", label: "Date/Time" }, { value: "time", label: "Time" }, { value: "string", label: "String" }, { value: "text", label: "Text" }, { value: "url", label: "URL" }, { value: "choice", label: "Choice" }, { value: "open-choice", label: "Open Choice" }, { value: "attachment", label: "Attachment" }, { value: "reference", label: "Reference" }, { value: "quantity", label: "Quantity" }] })) : import_react105.default.createElement("div", null, s)), !n && import_react105.default.createElement(Box, { className: o.movementActions }, import_react105.default.createElement(Box, { className: o.columnAlignment }, !e.isFirst && import_react105.default.createElement(Anchor, { href: "#", onClick: (v) => {
    v.preventDefault(), e.onMoveUp && e.onMoveUp();
  } }, import_react105.default.createElement(Br, { "data-testid": "up-button", size: 15, className: o.movementIcons })), !e.isLast && import_react105.default.createElement(Anchor, { href: "#", onClick: (v) => {
    v.preventDefault(), e.onMoveDown && e.onMoveDown();
  } }, import_react105.default.createElement(kr2, { "data-testid": "down-button", size: 15, className: o.movementIcons })))), import_react105.default.createElement("div", { className: o.bottomActions }, f && import_react105.default.createElement(import_react105.default.Fragment, null, import_react105.default.createElement(Anchor, { href: "#", onClick: (v) => {
    v.preventDefault(), y({ id: xo(), linkId: tn("q"), type: "string", text: "Question" });
  } }, "Add item"), import_react105.default.createElement(Anchor, { href: "#", onClick: (v) => {
    v.preventDefault(), y({ id: xo(), linkId: tn("g"), type: "group", text: "Group" });
  } }, "Add group")), n && import_react105.default.createElement(Anchor, { href: "#", onClick: (v) => {
    v.preventDefault(), y(dg());
  } }, "Add Page"), l && !n && import_react105.default.createElement(import_react105.default.Fragment, null, import_react105.default.createElement(Anchor, { href: "#", onClick: (v) => {
    v.preventDefault(), e.onRepeatable && e.onRepeatable(a);
  } }, a.repeats ? "Remove Repeatable" : "Make Repeatable"), import_react105.default.createElement(Anchor, { href: "#", onClick: (v) => {
    v.preventDefault(), e.onRemove && e.onRemove();
  } }, "Remove"))));
}
function fg(e) {
  let o = Ce("QuestionnaireItemAnswerOption", "value[x]"), t = e.item.answerOption ?? [];
  return import_react105.default.createElement("div", null, e.item.answerValueSet !== void 0 ? import_react105.default.createElement(TextInput, { placeholder: "Enter Value Set", defaultValue: e.item.answerValueSet, onChange: (r) => e.onChange({ ...e.item, answerValueSet: r.target.value }) }) : import_react105.default.createElement(lg, { options: t, property: o, item: e.item, onChange: e.onChange }), import_react105.default.createElement(Box, { display: "flex" }, import_react105.default.createElement(Anchor, { href: "#", onClick: (r) => {
    R(r), e.onChange({ ...e.item, answerValueSet: void 0, answerOption: [...t, { id: xo() }] });
  } }, "Add choice"), import_react105.default.createElement(Space, { w: "lg" }), import_react105.default.createElement(Anchor, { href: "#", onClick: (r) => {
    R(r), e.onChange({ ...e.item, answerOption: [], answerValueSet: "" });
  } }, "Add value set")));
}
function lg(e) {
  return import_react105.default.createElement("div", null, e.options.map((o) => {
    let [t, r] = Ce2({ type: "QuestionnaireItemAnswerOption", value: o }, "value");
    return import_react105.default.createElement("div", { key: o.id, style: { display: "flex", flexDirection: "row", justifyContent: "space-between", alignItems: "center", width: "80%" } }, import_react105.default.createElement("div", null, import_react105.default.createElement(qe, { key: o.id, name: "value[x]", property: e.property, defaultPropertyType: r, defaultValue: t, onChange: (a, n) => {
      let f = [...e.options], s = f.findIndex((l) => l.id === o.id);
      f[s] = { id: o.id, [n]: a }, e.onChange({ ...e.item, answerOption: f });
    } })), import_react105.default.createElement("div", null, import_react105.default.createElement(Anchor, { href: "#", onClick: (a) => {
      R(a), e.onChange({ ...e.item, answerOption: e.options.filter((n) => n.id !== o.id) });
    } }, "Remove")));
  }));
}
function sg(e) {
  let o = lr(e.item) ?? [];
  return import_react105.default.createElement(import_react105.default.Fragment, null, o.map((t, r) => import_react105.default.createElement(Group, { key: `${t}-${r}` }, import_react105.default.createElement(ko, { name: "resourceType", placeholder: "Resource Type", defaultValue: t, onChange: (a) => {
    e.onChange(sr(e.item, o.map((n) => n === t ? a : n)));
  } }), import_react105.default.createElement(Anchor, { href: "#", onClick: (a) => {
    R(a), e.onChange(sr(e.item, o.filter((n) => n !== t)));
  } }, "Remove"))), import_react105.default.createElement(Anchor, { href: "#", onClick: (t) => {
    R(t), e.onChange(sr(e.item, [...o, ""]));
  } }, "Add Resource Type"));
}
var en = 1;
var on = 1;
function tn(e) {
  return e + en++;
}
function xo() {
  return "id-" + on++;
}
function ig(e) {
  return { ...e, id: e.id || xo(), item: ks(e.item) };
}
function ks(e) {
  if (e)
    return e.forEach((o) => {
      var _a2, _b;
      ((_a2 = o.id) == null ? void 0 : _a2.match(/^id-\d+$/)) && (on = Math.max(on, parseInt(o.id.substring(3), 10) + 1)), ((_b = o.linkId) == null ? void 0 : _b.match(/^q\d+$/)) && (en = Math.max(en, parseInt(o.linkId.substring(1), 10) + 1));
    }), e.map((o) => ({ ...o, id: o.id || xo(), item: ks(o.item), answerOption: ug(o.answerOption) }));
}
function ug(e) {
  if (e)
    return e.map((o) => ({ ...o, id: o.id || xo() }));
}
function dg() {
  return { id: xo(), linkId: tn("s"), type: "group", text: "New Page", extension: [{ url: "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl", valueCodeableConcept: { coding: [{ system: "http://hl7.org/fhir/questionnaire-item-control", code: "page" }] } }] };
}
function cg(e, o, t) {
  let r = e ?? [], a = o + t;
  if (a < 0 || a >= r.length)
    return r;
  let n = [...r];
  return [n[o], n[a]] = [n[a], n[o]], n;
}
function dr(e) {
  let { item: o, response: t, onChange: r } = e, [a, n] = (0, import_react109.useState)(xg(o, t ?? {}));
  if (!e.checkForQuestionEnabled(o) || !t)
    return null;
  if (o.type === "display")
    return import_react109.default.createElement("p", { key: o.linkId }, o.text);
  let f = (o == null ? void 0 : o.repeats) && o.type !== "choice" && o.type !== "open-choice";
  return o.type === "boolean" ? import_react109.default.createElement(ct, { key: o.linkId, item: o, response: t, onChange: (s) => r([s]), index: 0 }) : import_react109.default.createElement(ye, { key: e.item.linkId, htmlFor: e.item.linkId, title: e.item.text, withAsterisk: e.item.required }, [...Array(a)].map((s, l) => import_react109.default.createElement(ct, { key: `${o.linkId}-${l}`, item: o, response: t, onChange: (i) => r([i]), index: l })), f && import_react109.default.createElement(Anchor, { onClick: () => n((s) => s + 1) }, "Add Item"));
}
function xg(e, o) {
  if (e.type === "choice" || e.type === "open-choice")
    return 1;
  let t = o.answer;
  return (t == null ? void 0 : t.length) ? t.length : 1;
}
function rn(e) {
  let [o, t] = (0, import_react110.useState)(e.response);
  if (o.length === 0)
    return null;
  function r(n, f) {
    let s = o.map((l, i) => i === f ? n[0] : l);
    t(s), e.onChange(s);
  }
  function a() {
    let n = Ka(e.item);
    t([...o, n]);
  }
  return import_react110.default.createElement(import_react110.default.Fragment, null, o.map((n, f) => import_react110.default.createElement(Bs, { key: n.id, item: e.item, response: n, checkForQuestionEnabled: e.checkForQuestionEnabled, onChange: (s) => r(s, f) })), e.item.repeats && import_react110.default.createElement(Anchor, { onClick: a }, `Add Group: ${e.item.text}`));
}
function Bs(e) {
  var _a2;
  let { response: o, checkForQuestionEnabled: t, onChange: r } = e;
  function a(n) {
    var _a3, _b;
    let s = (_b = (_a3 = o.item) == null ? void 0 : _a3.map((i) => n.find((c) => c.id === i.id) ?? i)) == null ? void 0 : _b.concat(n.slice(1)), l = { ...o, item: s };
    r([l]);
  }
  return e.checkForQuestionEnabled(e.item) ? import_react110.default.createElement("div", { key: e.item.linkId }, e.item.text && import_react110.default.createElement(Title, { order: 3, mb: "md" }, e.item.text), import_react110.default.createElement(Stack, null, (_a2 = e.item.item) == null ? void 0 : _a2.map((n) => {
    var _a3, _b, _c2;
    return n.type === "group" ? n.repeats ? import_react110.default.createElement(rn, { key: n.linkId, item: n, response: ((_a3 = o.item) == null ? void 0 : _a3.filter((f) => f.linkId === n.linkId)) ?? [], checkForQuestionEnabled: t, onChange: a }) : import_react110.default.createElement(Bs, { key: n.linkId, item: n, checkForQuestionEnabled: t, response: ((_b = o.item) == null ? void 0 : _b.find((f) => f.linkId === n.linkId)) ?? {}, onChange: a }) : import_react110.default.createElement(dr, { key: n.linkId, item: n, response: (_c2 = o.item) == null ? void 0 : _c2.find((f) => f.linkId === n.linkId), onChange: a, checkForQuestionEnabled: t });
  }))) : null;
}
function Ms(e) {
  let { items: o, response: t, activePage: r, onChange: a, nextStep: n, prevStep: f, numberOfPages: s, renderPages: l, submitButtonText: i, checkForQuestionEnabled: u2 } = e, c = o.map((d) => {
    var _a2;
    let x = ((_a2 = t == null ? void 0 : t.item) == null ? void 0 : _a2.filter((g) => g.linkId === d.linkId)) ?? [], y = d.type === "group" ? import_react108.default.createElement(rn, { key: d.linkId, item: d, response: x, onChange: a, checkForQuestionEnabled: u2 }) : import_react108.default.createElement(dr, { key: d.linkId, item: d, response: x == null ? void 0 : x[0], onChange: a, checkForQuestionEnabled: u2 });
    return l ? import_react108.default.createElement(Stepper.Step, { key: d.linkId, label: d.text }, y) : y;
  });
  return import_react108.default.createElement(import_react108.default.Fragment, null, l && import_react108.default.createElement(Stepper, { active: r ?? 0, allowNextStepsSelect: false, p: 6 }, c), !l && import_react108.default.createElement(Stack, null, c), import_react108.default.createElement(Sg, { activePage: r ?? 0, numberOfPages: s, nextStep: n, prevStep: f, submitButtonText: i }));
}
function Sg(e) {
  let o = e.activePage > 0, t = e.activePage < e.numberOfPages - 1, r = e.activePage === e.numberOfPages - 1;
  return import_react108.default.createElement(Group, { position: "right", mt: "xl", spacing: "xs" }, o && import_react108.default.createElement(Button, { onClick: e.prevStep }, "Back"), t && import_react108.default.createElement(Button, { onClick: (a) => {
    a.currentTarget.closest("form").reportValidity() && e.nextStep();
  } }, "Next"), r && import_react108.default.createElement(Button, { type: "submit" }, e.submitButtonText ?? "Submit"));
}
function ws(e) {
  let o = P2(), t = o.getProfile(), [r, a] = (0, import_react107.useState)(false), n = z2(e.questionnaire), [f, s] = (0, import_react107.useState)(), [l, i] = (0, import_react107.useState)(0);
  (0, import_react107.useEffect)(() => {
    o.requestSchema("Questionnaire").then(() => o.requestSchema("QuestionnaireResponse")).then(() => a(true)).catch(console.log);
  }, [o]), (0, import_react107.useEffect)(() => {
    s(n ? xs(n) : void 0);
  }, [n]);
  function u2(g) {
    let T2 = (f == null ? void 0 : f.item) ?? [], k2 = { resourceType: "QuestionnaireResponse", item: Os(T2, Array.isArray(g) ? g : [g]) };
    s(k2);
  }
  function c(g) {
    return cs(g, (f == null ? void 0 : f.item) ?? []);
  }
  if (!r || !n)
    return null;
  let d = hs(n), x = () => i((g) => g + 1), y = () => i((g) => g - 1);
  return import_react107.default.createElement($, { testid: "questionnaire-form", onSubmit: () => {
    e.onSubmit && f && e.onSubmit({ ...f, questionnaire: se(n), subject: e.subject, source: G(t), authored: (/* @__PURE__ */ new Date()).toISOString(), status: "completed" });
  } }, n.title && import_react107.default.createElement(Title, null, n.title), import_react107.default.createElement(Ms, { items: n.item ?? [], response: f, onChange: u2, renderPages: d > 1, activePage: l, numberOfPages: d, submitButtonText: e.submitButtonText, checkForQuestionEnabled: c, nextStep: x, prevStep: y }));
}
function Tg(e, o) {
  let t = Os(e.item ?? [], o.item ?? []);
  return { ...o, item: t.length > 0 ? t : void 0, answer: o.answer && o.answer.length > 0 ? o.answer : e.answer };
}
function Os(e, o) {
  let t = [], r = /* @__PURE__ */ new Set();
  for (let a of e) {
    let n = a.id, f = o.find((s) => s.id === n);
    f ? (t.push(Tg(a, f)), r.add(f.id)) : t.push(a);
  }
  for (let a of o)
    r.has(a.id) || t.push(a);
  return t;
}
var Eg = createStyles((e) => ({ section: { position: "relative", margin: "4px 4px 8px 0", padding: "6px 12px 16px 6px", border: `1.5px solid ${e.colors.gray[3]}`, borderRadius: e.radius.sm, transition: "all 0.1s" } }));
var Lg = ["gender", "age", "gestationalAge", "context", "appliesTo", "category"];
var Rg = { definition: { resourceType: "ObservationDefinition" }, onSubmit: () => {
} };
function JO(e) {
  e = Object.assign(Rg, e);
  let o = e.definition, [t, r] = (0, import_react111.useState)([]), [a, n] = (0, import_react111.useState)(1), [f, s] = (0, import_react111.useState)(1);
  return (0, import_react111.useEffect)(() => {
    let y = Vg(o, s);
    r(qg(y.qualifiedInterval || [], n));
  }, [o]), import_react111.default.createElement($, { testid: "reference-range-editor", onSubmit: l }, import_react111.default.createElement(Stack, null, t.map((y) => {
    var _a2;
    return import_react111.default.createElement(Ng, { unit: Ug((_a2 = o.quantitativeDetails) == null ? void 0 : _a2.unit), onChange: c, onAdd: d, onRemove: x, onRemoveGroup: u2, key: `group-${y.id}`, intervalGroup: y });
  })), import_react111.default.createElement(ActionIcon, { title: "Add Group", size: "sm", onClick: (y) => {
    R(y), i({ id: `group-id-${a}`, filters: {}, intervals: [] }), n((g) => g + 1);
  } }, import_react111.default.createElement(go, null)), import_react111.default.createElement(Group, { position: "right" }, import_react111.default.createElement(Button, { type: "submit" }, "Save")));
  function l() {
    let y = t.flatMap((g) => g.intervals).filter((g) => !Qg(g));
    e.onSubmit({ ...o, qualifiedInterval: y });
  }
  function i(y) {
    r((g) => [...g, y]);
  }
  function u2(y) {
    r((g) => g.filter((T2) => T2.id !== y.id));
  }
  function c(y, g) {
    r((T2) => {
      T2 = [...T2];
      let B = T2.find((A) => A.id === y), k2 = B == null ? void 0 : B.intervals.findIndex((A) => A.id === g.id);
      return k2 !== void 0 && (B == null ? void 0 : B.intervals[k2]) && (B.intervals[k2] = g), T2;
    });
  }
  function d(y, g) {
    g.id === void 0 && (g.id = `id-${f}`, s((T2) => T2 + 1)), r((T2) => {
      T2 = [...T2];
      let B = T2.findIndex((k2) => k2.id === y);
      if (B !== -1) {
        let k2 = { ...T2[B] };
        g = { ...g, ...k2.filters }, k2.intervals = [...k2.intervals, g], T2[B] = k2;
      }
      return T2;
    });
  }
  function x(y, g) {
    r((T2) => {
      T2 = [...T2];
      let B = T2.find((k2) => k2.id === y);
      return B && (B.intervals = B.intervals.filter((k2) => k2.id !== g.id)), T2;
    });
  }
}
function Ng(e) {
  let { intervalGroup: o, unit: t } = e, { classes: r } = Eg();
  return import_react111.default.createElement(je, { "data-testid": o.id, className: r.section }, import_react111.default.createElement(Stack, { spacing: "lg" }, import_react111.default.createElement(Group, { position: "right" }, import_react111.default.createElement(ActionIcon, { title: "Remove Group", "data-testid": `remove-group-button-${o.id}`, key: `remove-group-button-${o.id}`, size: "sm", onClick: (a) => {
    R(a), e.onRemoveGroup(o);
  } }, import_react111.default.createElement(We, null))), import_react111.default.createElement(Hg, { intervalGroup: o, onChange: e.onChange }), import_react111.default.createElement(Divider, null), o.intervals.map((a) => import_react111.default.createElement(Stack, { key: `interval-${a.id}`, spacing: "xs" }, import_react111.default.createElement(Group, null, import_react111.default.createElement(TextInput, { key: `condition-${a.id}`, "data-testid": `condition-${a.id}`, defaultValue: a.condition, label: "Condition: ", size: "sm", onChange: (n) => {
    R(n), e.onChange(o.id, { ...a, condition: n.currentTarget.value.trim() });
  } }), import_react111.default.createElement(ActionIcon, { title: "Remove Interval", size: "sm", key: `remove-interval-${a.id}`, "data-testid": `remove-interval-${a.id}`, onClick: (n) => {
    R(n), e.onRemove(o.id, a);
  } }, import_react111.default.createElement(We, null))), import_react111.default.createElement(at2, { onChange: (n) => {
    e.onChange(o.id, { ...a, range: n });
  }, key: `range-${a.id}`, name: `range-${a.id}`, defaultValue: a.range }))), import_react111.default.createElement(ActionIcon, { title: "Add Interval", size: "sm", onClick: (a) => {
    R(a), e.onAdd(o.id, { range: { low: { unit: t }, high: { unit: t } } });
  } }, import_react111.default.createElement(go, null))));
}
function Hg(e) {
  var _a2, _b;
  let { intervalGroup: o, onChange: t } = e;
  o.filters.age || (o.filters.age = {});
  for (let r of ["low", "high"])
    ((_a2 = o.filters.age[r]) == null ? void 0 : _a2.unit) || (o.filters.age[r] = { ...o.filters.age[r], unit: "years", system: "http://unitsofmeasure.org" });
  return import_react111.default.createElement(Stack, { style: { maxWidth: "50%" } }, import_react111.default.createElement(Group, null, import_react111.default.createElement(NativeSelect, { data: ["", "male", "female"], label: "Gender:", defaultValue: o.filters.gender || "", onChange: (r) => {
    for (let a of o.intervals) {
      let n = r.currentTarget.value;
      n === "" && (n = void 0), t(o.id, { ...a, gender: n });
    }
  } })), import_react111.default.createElement(Group, { spacing: "xs" }, import_react111.default.createElement(Text, { component: "label", htmlFor: `div-age-${o.id}` }, "Age:"), import_react111.default.createElement("div", { id: `div-age-${o.id}` }, import_react111.default.createElement(at2, { key: `age-${o.id}`, name: `age-${o.id}`, defaultValue: o.filters.age, onChange: (r) => {
    for (let a of o.intervals)
      t(o.id, { ...a, age: r });
  } }))), import_react111.default.createElement(NativeSelect, { data: ["", "pre-puberty", "follicular", "midcycle", "luteal", "postmenopausal"], label: "Endocrine:", defaultValue: ((_b = o.filters.context) == null ? void 0 : _b.text) || "", onChange: (r) => {
    for (let a of o.intervals) {
      let n = r.currentTarget.value;
      n === "" ? (n = void 0, t(o.id, { ...a, context: void 0 })) : t(o.id, { ...a, context: { text: n, coding: [{ code: n, system: "http://terminology.hl7.org/CodeSystem/referencerange-meaning" }] } });
    }
  } }), import_react111.default.createElement(NativeSelect, { data: ["", "reference", "critical", "absolute"], label: "Category: ", defaultValue: o.filters.category, onChange: (r) => {
    for (let a of o.intervals) {
      let n = r.currentTarget.value;
      n === "" ? t(o.id, { ...a, category: void 0 }) : t(o.id, { ...a, category: n });
    }
  } }));
}
function Vg(e, o) {
  let t = e.qualifiedInterval || [], r = Math.max(...t.map((a) => {
    var _a2;
    let n = parseInt(((_a2 = a.id) == null ? void 0 : _a2.substring(3)) || "", 10);
    return isNaN(n) ? Number.NEGATIVE_INFINITY : n;
  })) + 1;
  return Number.isFinite(r) || (r = 1), e = { ...e, qualifiedInterval: t.map((a) => ({ ...a, id: a.id || `id-${r++}` })) }, o(r), e;
}
function qg(e, o) {
  let t = 1, r = {};
  for (let a of e) {
    let n = Gg(a);
    n in r || (r[n] = { id: `group-id-${t++}`, filters: Object.fromEntries(Lg.map((f) => [f, a[f]])), intervals: [] }), r[n].intervals.push(a);
  }
  return o(t), Object.values(r);
}
function Gg(e) {
  var _a2, _b;
  return [`gender=${e.gender}`, `age=${rs(e.age)}`, `gestationalAge=${rs(e.gestationalAge)}`, `context=${(_a2 = e.context) == null ? void 0 : _a2.text}`, `appliesTo=${(_b = e.appliesTo) == null ? void 0 : _b.map((t) => t.text).join("+")}`, `category=${e.category}`].join(":");
}
function Ug(e) {
  return e && (nt(e, "http://unitsofmeasure.org") || e.text);
}
function Qg(e) {
  var _a2, _b, _c2, _d2;
  return ((_b = (_a2 = e.range) == null ? void 0 : _a2.low) == null ? void 0 : _b.value) === void 0 && ((_d2 = (_c2 = e.range) == null ? void 0 : _c2.high) == null ? void 0 : _d2.value) === void 0;
}
function t0(e) {
  var _a2;
  let o = P2(), t = z2(e.value), [r, a] = (0, import_react112.useState)(false), [n, f] = (0, import_react112.useState)();
  if ((0, import_react112.useEffect)(() => {
    t && !r && (o.executeBatch(s(t)).then(f).catch(console.log), a(true));
  }, [o, t, r]), !t || !n)
    return null;
  return import_react112.default.createElement(Grid, null, (_a2 = t.action) == null ? void 0 : _a2.map((i, u2) => {
    var _a3, _b, _c2, _d2, _e2, _f2;
    let c = i.resource && l(i.resource), d = (_b = (_a3 = c == null ? void 0 : c.input) == null ? void 0 : _a3[0]) == null ? void 0 : _b.valueReference, x = (_d2 = (_c2 = c == null ? void 0 : c.output) == null ? void 0 : _c2[0]) == null ? void 0 : _d2.valueReference;
    return import_react112.default.createElement(import_react112.default.Fragment, { key: `action-${u2}` }, import_react112.default.createElement(Grid.Col, { span: 1, p: "md" }, (c == null ? void 0 : c.status) === "completed" ? import_react112.default.createElement(Lr, null) : import_react112.default.createElement(Zr, { color: "gray" })), import_react112.default.createElement(Grid.Col, { span: 9, p: "xs" }, import_react112.default.createElement(Text, { weight: 500 }, i.title), i.description && import_react112.default.createElement("div", null, i.description), import_react112.default.createElement("div", null, "Last edited by ", import_react112.default.createElement(Ee, { value: (_e2 = c == null ? void 0 : c.meta) == null ? void 0 : _e2.author }), " on ", st((_f2 = c == null ? void 0 : c.meta) == null ? void 0 : _f2.lastUpdated)), import_react112.default.createElement("div", null, "Status: ", import_react112.default.createElement(Qt, { status: (c == null ? void 0 : c.status) || "unknown" }))), import_react112.default.createElement(Grid.Col, { span: 2, p: "md" }, d && !x && import_react112.default.createElement(Button, { onClick: () => e.onStart(c, d) }, "Start"), d && x && import_react112.default.createElement(Button, { onClick: () => e.onEdit(c, d, x) }, "Edit")));
  }));
  function s(i) {
    var _a3;
    let u2 = [];
    if (i.action)
      for (let c of i.action)
        ((_a3 = c.resource) == null ? void 0 : _a3.reference) && u2.push({ request: { method: "GET", url: c.resource.reference } });
    return { resourceType: "Bundle", type: "batch", entry: u2 };
  }
  function l(i) {
    for (let u2 of n == null ? void 0 : n.entry)
      if (u2.resource && i.reference === se(u2.resource))
        return u2.resource;
  }
}
function xr(e, o) {
  let t = $g(e, o);
  return Kg(t, e, o);
}
function $g(e, o) {
  let t = e.length, r = o.length, a = t + r + 1, n = 1 + 2 * a, f = n / 2 | 0, s = new Array(n);
  s[f + 1] = { i: 0, j: -1, prev: void 0, snake: true };
  for (let l = 0; l < a; l++) {
    for (let i = -l; i <= l; i += 2) {
      let u2 = f + i, c = u2 + 1, d = u2 - 1, x = s[c], y = s[d], g, T2 = 0;
      i === -l || i !== l && y.i < x.i ? (T2 = x.i, g = x) : (T2 = y.i + 1, g = y), s[d] = void 0;
      let B = T2 - i, k2 = { i: T2, j: B, prev: jg(g), snake: false };
      for (; T2 < t && B < r && e[T2] === o[B]; )
        T2++, B++;
      if (T2 > k2.i && (k2 = { i: T2, j: B, prev: k2, snake: true }), s[u2] = k2, T2 >= t && B >= r)
        return s[u2];
    }
    s[f + l - 1] = void 0;
  }
}
function Kg(e, o, t) {
  let r = [], a = e;
  for (a.snake && (a = a.prev); (a == null ? void 0 : a.prev) && a.prev.j >= 0; ) {
    let n = a.i, f = a.j;
    a = a.prev;
    let s = a.i, l = a.j, i = { position: s, lines: o.slice(s, n) }, u2 = { position: l, lines: t.slice(l, f) }, c;
    i.lines.length === 0 && u2.lines.length > 0 ? c = "insert" : i.lines.length > 0 && u2.lines.length === 0 ? c = "delete" : c = "change", r.push({ original: i, revised: u2, type: c }), a.snake && (a = a.prev);
  }
  return r;
}
function jg(e) {
  return e && !e.snake && e.prev ? e.prev : e;
}
function Ns(e) {
  let o = e.entry.filter((r) => !!r.resource).map((r) => {
    var _a2;
    return { meta: (_a2 = r.resource) == null ? void 0 : _a2.meta, lines: zt(r.resource, true).match(/[^\r\n]+/g) };
  }).sort((r, a) => r.meta.lastUpdated.localeCompare(a.meta.lastUpdated)), t = o[0].lines.map((r) => ({ id: o[0].meta.versionId, meta: o[0].meta, value: r, span: 1 }));
  return Zg(t, o), Yg(t), t;
}
function Zg(e, o) {
  for (let t = 1; t < o.length; t++) {
    let r = xr(o[t - 1].lines, o[t].lines);
    for (let a of r) {
      let n = a.original.position, f = a.original.lines, s = a.revised.lines;
      if ((a.type === "delete" || a.type === "change") && e.splice(n, f.length), a.type === "insert" || a.type === "change")
        for (let l = 0; l < a.revised.lines.length; l++)
          e.splice(n + l, 0, { id: o[t].meta.versionId, meta: o[t].meta, value: s[l], span: 1 });
    }
  }
}
function Yg(e) {
  let o = 0;
  for (; o < e.length; ) {
    let t = o;
    for (; t < e.length && e[t].id === e[o].id; )
      e[t].span = -1, t++;
    e[o].span = t - o, o = t;
  }
}
function Hs2(e, o) {
  return `/${e.resourceType}/${e.id}/_history/${o}`;
}
function Vs(e) {
  let o = Math.floor((Date.now() - Date.parse(e)) / 1e3), t = Math.floor(o / 31536e3);
  if (t > 0)
    return zo(t, "year");
  let r = Math.floor(o / 2592e3);
  if (r > 0)
    return zo(r, "month");
  let a = Math.floor(o / 86400);
  if (a > 0)
    return zo(a, "day");
  let n = Math.floor(o / 3600);
  if (n > 0)
    return zo(n, "hour");
  let f = Math.floor(o / 60);
  return f > 0 ? zo(f, "minute") : zo(o, "second");
}
function zo(e, o) {
  return `${e} ${e === 1 ? o : o + "s"} ago`;
}
var rh = createStyles((e) => ({ container: { overflowX: "auto" }, root: { border: `0.1px solid ${e.colors.gray[3]}`, borderCollapse: "collapse", borderRadius: e.radius.sm, borderSpacing: 0, fontSize: e.fontSizes.xs, width: "100%", "& td": { padding: "2px 4px 0 4px", verticalAlign: "top", whiteSpace: "nowrap" } }, startRow: { borderTop: `0.1px solid ${e.colors.gray[3]}` }, normalRow: { borderTop: 0 }, author: { lineHeight: "10px" }, dateTime: { borderRight: `0.1px solid ${e.colors.gray[3]}`, lineHeight: "20px" }, lineNumber: { backgroundColor: e.colors.gray[1], border: 0, color: e.colors.gray[5], fontFamily: e.fontFamilyMonospace, padding: `${e.spacing.xs} ${e.spacing.sm}`, textAlign: "right" }, line: { fontFamily: e.fontFamilyMonospace, fontSize: e.fontSizes.sm, padding: `${e.spacing.xs} ${e.spacing.sm}` }, pre: { margin: 0 } }));
function I0(e) {
  var _a2, _b;
  let { classes: o } = rh(), t = P2(), [r, a] = (0, import_react113.useState)(e.history);
  if ((0, import_react113.useEffect)(() => {
    !e.history && e.resourceType && e.id && t.readHistory(e.resourceType, e.id).then(a).catch(console.log);
  }, [t, e.history, e.resourceType, e.id]), !r)
    return import_react113.default.createElement("div", null, "Loading...");
  let n = (_b = (_a2 = r.entry) == null ? void 0 : _a2[0]) == null ? void 0 : _b.resource;
  if (!n)
    return null;
  let f = Ns(r);
  return import_react113.default.createElement("div", { className: o.container }, import_react113.default.createElement("table", { className: o.root }, import_react113.default.createElement("tbody", null, f.map((s, l) => import_react113.default.createElement("tr", { key: "row-" + l, className: s.span > 0 ? o.startRow : o.normalRow }, s.span > 0 && import_react113.default.createElement(import_react113.default.Fragment, null, import_react113.default.createElement("td", { className: o.author, rowSpan: s.span }, import_react113.default.createElement(_e, { value: s.meta.author, link: true })), import_react113.default.createElement("td", { className: o.dateTime, rowSpan: s.span }, import_react113.default.createElement(le, { to: Hs2(n, s.meta.versionId) }, Vs(s.meta.lastUpdated)))), import_react113.default.createElement("td", { className: o.lineNumber }, l + 1), import_react113.default.createElement("td", { className: o.line }, import_react113.default.createElement("pre", { className: o.pre }, s.value)))))));
}
var nh = createStyles((e) => ({ removed: { color: e.colors.red[7], textDecoration: "line-through" }, added: { color: e.colors.green[7] } }));
function b0(e) {
  let o = e.original, t = e.revised;
  e.ignoreMeta && (o = { ...o, meta: void 0 }, t = { ...t, meta: void 0 });
  let r = zt(o, true).match(/[^\r\n]+/g), a = zt(t, true).match(/[^\r\n]+/g), n = xr(r, a);
  return import_react114.default.createElement("pre", { style: { color: "gray" } }, n.map((f, s) => import_react114.default.createElement(fh, { key: "delta" + s, delta: f })));
}
function fh(e) {
  let { classes: o } = nh();
  return import_react114.default.createElement(import_react114.default.Fragment, null, "...", import_react114.default.createElement("br", null), e.delta.original.lines.length > 0 && import_react114.default.createElement("div", { className: o.removed }, e.delta.original.lines.join(`
`)), e.delta.revised.lines.length > 0 && import_react114.default.createElement("div", { className: o.added }, e.delta.revised.lines.join(`
`)), "...", import_react114.default.createElement("br", null));
}
function F0(e) {
  let o = P2(), t = z2(e.defaultValue), [r, a] = (0, import_react115.useState)(false), [n, f] = (0, import_react115.useState)();
  return (0, import_react115.useEffect)(() => {
    t && (f(it(t)), o.requestSchema(t.resourceType).then(() => a(true)).catch(console.log));
  }, [o, t]), !r || !n ? import_react115.default.createElement("div", null, "Loading...") : import_react115.default.createElement("form", { noValidate: true, autoComplete: "off", onSubmit: (s) => {
    s.preventDefault(), e.onSubmit && e.onSubmit(n);
  } }, import_react115.default.createElement(Stack, { mb: "xl" }, import_react115.default.createElement(ye, { title: "Resource Type", htmlFor: "resourceType", outcome: e.outcome }, import_react115.default.createElement(TextInput, { name: "resourceType", defaultValue: n.resourceType, disabled: true })), import_react115.default.createElement(ye, { title: "ID", htmlFor: "id", outcome: e.outcome }, import_react115.default.createElement(TextInput, { name: "id", defaultValue: n.id, disabled: true }))), import_react115.default.createElement(nt2, { typeName: n.resourceType, defaultValue: n, outcome: e.outcome, onChange: f }), import_react115.default.createElement(Group, { position: "right", mt: "xl" }, import_react115.default.createElement(Button, { type: "submit" }, "OK"), e.onDelete && import_react115.default.createElement(Button, { variant: "outline", color: "red", type: "button", onClick: () => {
    e.onDelete(n);
  } }, "Delete")));
}
function V0(e) {
  var _a2;
  let o = P2(), [t, r] = (0, import_react116.useState)(e.history);
  return (0, import_react116.useEffect)(() => {
    !e.history && e.resourceType && e.id && o.readHistory(e.resourceType, e.id).then(r).catch(console.log);
  }, [o, e.history, e.resourceType, e.id]), t ? import_react116.default.createElement(Table, { withBorder: true, withColumnBorders: true }, import_react116.default.createElement("thead", null, import_react116.default.createElement("tr", null, import_react116.default.createElement("th", null, "Author"), import_react116.default.createElement("th", null, "Date"), import_react116.default.createElement("th", null, "Version"))), import_react116.default.createElement("tbody", null, (_a2 = t.entry) == null ? void 0 : _a2.map((a, n) => import_react116.default.createElement(Ih, { key: "entry-" + n, entry: a })))) : import_react116.default.createElement("div", null, "Loading...");
}
function Ih(e) {
  var _a2, _b, _c2;
  let { response: o, resource: t } = e.entry;
  return t ? import_react116.default.createElement("tr", null, import_react116.default.createElement("td", null, import_react116.default.createElement(_e, { value: (_a2 = t.meta) == null ? void 0 : _a2.author, link: true })), import_react116.default.createElement("td", null, st((_b = t.meta) == null ? void 0 : _b.lastUpdated)), import_react116.default.createElement("td", null, import_react116.default.createElement(le, { to: gh(t) }, (_c2 = t.meta) == null ? void 0 : _c2.versionId))) : import_react116.default.createElement("tr", null, import_react116.default.createElement("td", { colSpan: 3 }, Kn(o == null ? void 0 : o.outcome)));
}
function gh(e) {
  var _a2;
  return `/${e.resourceType}/${e.id}/_history/${(_a2 = e.meta) == null ? void 0 : _a2.versionId}`;
}
var Ph = createStyles((e) => ({ container: { display: "flex", minHeight: 400 }, info: { minWidth: 300, padding: 20, borderRight: `1px solid ${e.colors.gray[3]}` }, selection: { minWidth: 300, padding: 20 } }));
function j0(e) {
  var _a2;
  let { classes: o } = Ph(), t = z2(e.schedule), r = z2(e.questionnaire), [a, n] = (0, import_react117.useState)(Ut()), [f, s] = (0, import_react117.useState)(), [l, i] = (0, import_react117.useState)(), [u2, c] = (0, import_react117.useState)(), [d] = vn("Slot", new URLSearchParams([["_count", (30 * 24).toString()], ["schedule", ae(e.schedule) ? e.schedule.reference : se(e.schedule)], ["start", "gt" + Dh(a)], ["start", "lt" + Th(a)]]));
  if (!t || !d || !r)
    return null;
  let x = (_a2 = t.actor) == null ? void 0 : _a2[0];
  return import_react117.default.createElement("div", { className: o.container, "data-testid": "scheduler" }, import_react117.default.createElement("div", { className: o.info }, x && import_react117.default.createElement(ge, { value: x, size: "xl" }), x && import_react117.default.createElement(Text, { size: "xl", weight: 500 }, import_react117.default.createElement(Ee, { value: x })), import_react117.default.createElement("p", null, "1 hour"), f && import_react117.default.createElement("p", null, f.toLocaleDateString()), l && import_react117.default.createElement("p", null, zs(new Date(l.start)))), import_react117.default.createElement("div", { className: o.selection }, !f && import_react117.default.createElement("div", null, import_react117.default.createElement("h3", null, "Select date"), import_react117.default.createElement(Kf, { slots: d, onChangeMonth: n, onClick: s })), f && !l && import_react117.default.createElement("div", null, import_react117.default.createElement("h3", null, "Select time"), import_react117.default.createElement(Stack, null, d.map((y) => {
    let g = new Date(y.start);
    return g.getTime() > f.getTime() && g.getTime() < f.getTime() + 24 * 3600 * 1e3 && import_react117.default.createElement("div", { key: y.id }, import_react117.default.createElement(Button, { variant: "outline", style: { width: 150 }, onClick: () => i(y) }, zs(g)));
  }))), f && l && !u2 && import_react117.default.createElement(ws, { questionnaire: r, submitButtonText: "Next", onSubmit: c }), f && l && u2 && import_react117.default.createElement("div", null, import_react117.default.createElement("h3", null, "You're all set!"), import_react117.default.createElement("p", null, "Check your email for a calendar invite."))));
}
function Dh(e) {
  return Ws(e.getTime());
}
function Th(e) {
  return Ws(e.getTime() + 31 * 24 * 60 * 60 * 1e3);
}
function Ws(e) {
  let o = new Date(Math.max(Date.now(), e));
  return o.setHours(0, 0, 0, 0), o.toISOString();
}
function zs(e) {
  return e.toLocaleTimeString([], { hour: "numeric", minute: "2-digit" });
}
function r1(e) {
  return import_react118.default.createElement(Ye, { value: e.serviceRequest, loadTimelineResources: async (o, t, r) => {
    let a = `${t}/${r}`, n = 100;
    return Promise.allSettled([o.readHistory("ServiceRequest", r), o.search("Communication", { "based-on": a, _count: n }), o.search("DiagnosticReport", { "based-on": a, _count: n }), o.search("Media", { "based-on": a, _count: n }), o.search("DocumentReference", { related: a, _count: n }), o.search("Task", { _filter: `based-on eq ${a} or focus eq ${a} or subject eq ${a}`, _count: n })]);
  }, createCommunication: (o, t, r) => ({ resourceType: "Communication", status: "completed", basedOn: [G(o)], subject: o.subject, sender: G(t), sent: (/* @__PURE__ */ new Date()).toISOString(), payload: [{ contentString: r }] }), createMedia: (o, t, r) => ({ resourceType: "Media", status: "completed", basedOn: [G(o)], subject: o.subject, operator: G(t), issued: (/* @__PURE__ */ new Date()).toISOString(), content: r }) });
}
function hr(e) {
  let o = P2(), [t, r] = (0, import_react120.useState)();
  return import_react120.default.createElement($, { style: { maxWidth: 400 }, onSubmit: async (a) => {
    try {
      e.handleAuthResponse(await o.startNewProject({ login: e.login, projectName: a.projectName }));
    } catch (n) {
      r(Oe(n));
    }
  } }, import_react120.default.createElement(Center, { sx: { flexDirection: "column" } }, import_react120.default.createElement(eo, { size: 32 }), import_react120.default.createElement(Title, null, "Create project")), import_react120.default.createElement(Stack, { spacing: "xl" }, import_react120.default.createElement(TextInput, { name: "projectName", label: "Project Name", placeholder: "My Project", required: true, autoFocus: true, error: pe2(t, "firstName") }), import_react120.default.createElement(Text, { color: "dimmed", size: "xs" }, "By clicking submit you agree to the Medplum", " ", import_react120.default.createElement(Anchor, { href: "https://www.medplum.com/privacy" }, "Privacy Policy"), " and ", import_react120.default.createElement(Anchor, { href: "https://www.medplum.com/terms" }, "Terms of Service"), ".")), import_react120.default.createElement(Group, { position: "right", mt: "xl", noWrap: true }, import_react120.default.createElement(Button, { type: "submit" }, "Create project")));
}
function Cr(e, o) {
  let t = document.getElementsByTagName("head")[0], r = document.createElement("script");
  r.async = true, r.src = e, r.onload = o ?? null, t.appendChild(r);
}
function yr(e) {
  let o = P2(), { googleClientId: t, handleGoogleCredential: r } = e, a = (0, import_react122.useRef)(null), [n, f] = (0, import_react122.useState)(typeof google < "u"), [s, l] = (0, import_react122.useState)(false), [i, u2] = (0, import_react122.useState)(false);
  return (0, import_react122.useEffect)(() => {
    if (typeof google > "u") {
      Cr("https://accounts.google.com/gsi/client", () => f(true));
      return;
    }
    s || (google.accounts.id.initialize({ client_id: t, callback: r }), l(true)), a.current && !i && (google.accounts.id.renderButton(a.current, {}), u2(true));
  }, [o, t, s, n, a, i, r]), t ? import_react122.default.createElement("div", { ref: a }) : null;
}
function vr(e) {
  if (e)
    return e;
  if (typeof window < "u") {
    let o = window.location.protocol + "//" + window.location.host;
    if ((("undefined" == null ? void 0 : "undefined".split(",")) ?? []).includes(o))
      return "__GOOGLE_CLIENT_ID__";
  }
}
function Js(e) {
  typeof grecaptcha > "u" && Cr("https://www.google.com/recaptcha/api.js?render=" + e);
}
function $s(e) {
  return new Promise((o, t) => {
    grecaptcha.ready(async () => {
      try {
        o(await grecaptcha.execute(e, { action: "submit" }));
      } catch (r) {
        t(r);
      }
    });
  });
}
function Zs(e) {
  let o = vr(e.googleClientId), t = e.recaptchaSiteKey, r = P2(), [a, n] = (0, import_react121.useState)(), f = Ot(a, void 0);
  return (0, import_react121.useEffect)(() => {
    t && Js(t);
  }, [t]), import_react121.default.createElement($, { style: { maxWidth: 400 }, onSubmit: async (s) => {
    try {
      let l = "";
      t && (l = await $s(t)), e.handleAuthResponse(await r.startNewUser({ projectId: e.projectId, clientId: e.clientId, firstName: s.firstName, lastName: s.lastName, email: s.email, password: s.password, remember: s.remember === "true", recaptchaSiteKey: t, recaptchaToken: l }));
    } catch (l) {
      n(Oe(l));
    }
  } }, import_react121.default.createElement(Center, { sx: { flexDirection: "column" } }, e.children), import_react121.default.createElement(Uo2, { issues: f }), o && import_react121.default.createElement(import_react121.default.Fragment, null, import_react121.default.createElement(Group, { position: "center", p: "xl", style: { height: 70 } }, import_react121.default.createElement(yr, { googleClientId: o, handleGoogleCredential: async (s) => {
    try {
      e.handleAuthResponse(await r.startGoogleLogin({ googleClientId: s.clientId, googleCredential: s.credential, createUser: true }));
    } catch (l) {
      n(Oe(l));
    }
  } })), import_react121.default.createElement(Divider, { label: "or", labelPosition: "center", my: "lg" })), import_react121.default.createElement(Stack, { spacing: "xl" }, import_react121.default.createElement(TextInput, { name: "firstName", type: "text", label: "First name", placeholder: "First name", required: true, autoFocus: true, error: pe2(a, "firstName") }), import_react121.default.createElement(TextInput, { name: "lastName", type: "text", label: "Last name", placeholder: "Last name", required: true, error: pe2(a, "lastName") }), import_react121.default.createElement(TextInput, { name: "email", type: "email", label: "Email", placeholder: "name@domain.com", required: true, error: pe2(a, "email") }), import_react121.default.createElement(PasswordInput, { name: "password", label: "Password", autoComplete: "off", required: true, error: pe2(a, "password") }), import_react121.default.createElement(Text, { color: "dimmed", size: "xs" }, "By clicking submit you agree to the Medplum", " ", import_react121.default.createElement(Anchor, { href: "https://www.medplum.com/privacy" }, "Privacy Policy"), " and ", import_react121.default.createElement(Anchor, { href: "https://www.medplum.com/terms" }, "Terms of Service"), "."), import_react121.default.createElement(Text, { color: "dimmed", size: "xs" }, "This site is protected by reCAPTCHA and the Google", " ", import_react121.default.createElement(Anchor, { href: "https://policies.google.com/privacy" }, "Privacy Policy"), " and ", import_react121.default.createElement(Anchor, { href: "https://policies.google.com/terms" }, "Terms of Service"), " apply.")), import_react121.default.createElement(Group, { position: "apart", mt: "xl", noWrap: true }, import_react121.default.createElement(Checkbox, { name: "remember", label: "Remember me", size: "xs" }), import_react121.default.createElement(Button, { type: "submit" }, "Create account")));
}
function U1(e) {
  let { type: o, projectId: t, clientId: r, googleClientId: a, recaptchaSiteKey: n, onSuccess: f } = e, s = P2(), [l, i] = (0, import_react119.useState)(), [u2, c] = (0, import_react119.useState)();
  (0, import_react119.useEffect)(() => {
    o === "patient" && l && s.startNewPatient({ login: l, projectId: t }).then((x) => s.processCode(x.code)).then(() => f()).catch((x) => c(Oe(x)));
  }, [s, o, t, l, f]);
  function d(x) {
    x.code ? s.processCode(x.code).then(() => f()).catch(console.log) : x.login && i(x.login);
  }
  return import_react119.default.createElement(Jt, { width: 450 }, u2 && import_react119.default.createElement("pre", null, JSON.stringify(u2, null, 2)), !l && import_react119.default.createElement(Zs, { projectId: t, clientId: r, googleClientId: a, recaptchaSiteKey: n, handleAuthResponse: d }, e.children), l && o === "project" && import_react119.default.createElement(hr, { login: l, handleAuthResponse: d }));
}
function ai(e) {
  let [o, t] = (0, import_react124.useState)();
  return o ? import_react124.default.createElement(rC, { email: o, ...e }) : import_react124.default.createElement(tC, { setEmail: t, ...e });
}
function tC(e) {
  let { setEmail: o, onRegister: t, handleAuthResponse: r, children: a, disableEmailAuth: n, ...f } = e, s = P2(), l = !e.disableGoogleAuth && vr(e.googleClientId), i = (0, import_react124.useCallback)(async (d) => {
    if (!d.authorizeUrl)
      return false;
    let x = JSON.stringify({ ...await s.ensureCodeChallenge(f), domain: d.domain }), y = new URL(d.authorizeUrl);
    return y.searchParams.set("state", x), window.location.assign(y.toString()), true;
  }, [s, f]), u2 = (0, import_react124.useCallback)(async (d) => {
    let x = await s.post("auth/method", { email: d.email });
    await i(x) || o(d.email);
  }, [s, i, o]), c = (0, import_react124.useCallback)(async (d) => {
    let x = await s.startGoogleLogin({ ...f, googleCredential: d.credential });
    await i(x) || r(x);
  }, [s, f, i, r]);
  return import_react124.default.createElement($, { style: { maxWidth: 400 }, onSubmit: u2 }, import_react124.default.createElement(Center, { sx: { flexDirection: "column" } }, a), l && import_react124.default.createElement(import_react124.default.Fragment, null, import_react124.default.createElement(Group, { position: "center", p: "xl", style: { height: 70 } }, import_react124.default.createElement(yr, { googleClientId: l, handleGoogleCredential: c })), !n && import_react124.default.createElement(Divider, { label: "or", labelPosition: "center", my: "lg" })), !n && import_react124.default.createElement(TextInput, { name: "email", type: "email", label: "Email", placeholder: "name@domain.com", required: true, autoFocus: true }), import_react124.default.createElement(Group, { position: "apart", mt: "xl", spacing: 0, noWrap: true }, import_react124.default.createElement("div", null, t && import_react124.default.createElement(Anchor, { component: "button", type: "button", color: "dimmed", onClick: t, size: "xs" }, "Register")), !n && import_react124.default.createElement(Button, { type: "submit" }, "Next")));
}
function rC(e) {
  let { onForgotPassword: o, handleAuthResponse: t, children: r, ...a } = e, n = P2(), [f, s] = (0, import_react124.useState)(), l = Ot(f, void 0), i = (0, import_react124.useCallback)((u2) => {
    n.startLogin({ ...a, password: u2.password, remember: u2.remember === "on" }).then(t).catch((c) => s(Oe(c)));
  }, [n, a, t]);
  return import_react124.default.createElement($, { style: { maxWidth: 400 }, onSubmit: i }, import_react124.default.createElement(Center, { sx: { flexDirection: "column" } }, r), import_react124.default.createElement(Uo2, { issues: l }), import_react124.default.createElement(Stack, { spacing: "xl" }, import_react124.default.createElement(PasswordInput, { name: "password", label: "Password", autoComplete: "off", required: true, autoFocus: true, error: pe2(f, "password") })), import_react124.default.createElement(Group, { position: "apart", mt: "xl", spacing: 0, noWrap: true }, o && import_react124.default.createElement(Anchor, { component: "button", type: "button", color: "dimmed", onClick: o, size: "xs" }, "Forgot password"), import_react124.default.createElement(Checkbox, { id: "remember", name: "remember", label: "Remember me", size: "xs", sx: { lineHeight: 1 } }), import_react124.default.createElement(Button, { type: "submit" }, "Sign in")));
}
function fi(e) {
  let o = P2(), [t, r] = (0, import_react125.useState)();
  return import_react125.default.createElement(Stack, null, import_react125.default.createElement(Center, { sx: { flexDirection: "column" } }, import_react125.default.createElement(eo, { size: 32 }), import_react125.default.createElement(Title, { order: 3 }, "Choose profile")), import_react125.default.createElement(Uo2, { outcome: t }), e.memberships.map((a) => {
    var _a2, _b;
    return import_react125.default.createElement(UnstyledButton, { key: a.id, onClick: () => {
      o.post("auth/profile", { login: e.login, profile: a.id }).then(e.handleAuthResponse).catch((n) => r(Oe(n)));
    } }, import_react125.default.createElement(Group, null, import_react125.default.createElement(Avatar, { radius: "xl" }), import_react125.default.createElement("div", { style: { flex: 1 } }, import_react125.default.createElement(Text, { size: "sm", weight: 500 }, (_a2 = a.profile) == null ? void 0 : _a2.display), import_react125.default.createElement(Text, { color: "dimmed", size: "xs" }, (_b = a.project) == null ? void 0 : _b.display))));
  }));
}
function si(e) {
  let o = P2();
  return import_react126.default.createElement($, { style: { maxWidth: 400 }, onSubmit: (t) => {
    o.post("auth/scope", { login: e.login, scope: Object.keys(t).join(" ") }).then(e.handleAuthResponse).catch(console.log);
  } }, import_react126.default.createElement(Stack, null, import_react126.default.createElement(Center, { sx: { flexDirection: "column" } }, import_react126.default.createElement(eo, { size: 32 }), import_react126.default.createElement(Title, null, "Choose scope")), import_react126.default.createElement(Stack, null, (e.scope ?? "openid").split(" ").map((t) => import_react126.default.createElement(Checkbox, { key: t, id: t, name: t, label: t, defaultChecked: true }))), import_react126.default.createElement(Group, { position: "right", mt: "xl" }, import_react126.default.createElement(Button, { type: "submit" }, "Set scope"))));
}
function ui(e) {
  let o = P2(), [t, r] = (0, import_react127.useState)();
  return import_react127.default.createElement($, { style: { maxWidth: 400 }, onSubmit: (a) => {
    r(void 0), o.post("auth/mfa/verify", { login: e.login, token: a.token }).then(e.handleAuthResponse).catch((n) => r(Kn(n)));
  } }, import_react127.default.createElement(Stack, null, import_react127.default.createElement(Center, { sx: { flexDirection: "column" } }, import_react127.default.createElement(eo, { size: 32 }), import_react127.default.createElement(Title, null, "Enter MFA code")), t && import_react127.default.createElement(Alert, { icon: import_react127.default.createElement(no, { size: 16 }), title: "Error", color: "red" }, t), import_react127.default.createElement(Stack, null, import_react127.default.createElement(TextInput, { name: "token", label: "MFA code", required: true })), import_react127.default.createElement(Group, { position: "right", mt: "xl" }, import_react127.default.createElement(Button, { type: "submit" }, "Submit code"))));
}
function VE(e) {
  let { login: o, chooseScopes: t, onSuccess: r, onForgotPassword: a, onRegister: n, onCode: f, ...s } = e, l = P2(), [i, u2] = (0, import_react123.useState)(), [c, d] = (0, import_react123.useState)(false), [x, y] = (0, import_react123.useState)(), g = (0, import_react123.useCallback)((k2) => {
    f ? f(k2) : l.processCode(k2).then(() => {
      r && r();
    }).catch((A) => showNotification({ color: "red", message: Kn(A) }));
  }, [l, f, r]), T2 = (0, import_react123.useCallback)((k2) => {
    d(!!k2.mfaRequired), k2.login && u2(k2.login), k2.memberships && y(k2.memberships), k2.code && (t ? y(void 0) : g(k2.code));
  }, [t, g]), B = (0, import_react123.useCallback)((k2) => {
    g(k2.code);
  }, [g]);
  return (0, import_react123.useEffect)(() => {
    o && !i && l.get("auth/login/" + o).then(T2).catch((k2) => showNotification({ color: "red", message: Kn(k2) }));
  }, [l, o, i, T2]), import_react123.default.createElement(Jt, { width: 450 }, (() => i ? c ? import_react123.default.createElement(ui, { login: i, handleAuthResponse: T2 }) : x ? import_react123.default.createElement(fi, { login: i, memberships: x, handleAuthResponse: T2 }) : e.projectId === "new" ? import_react123.default.createElement(hr, { login: i, handleAuthResponse: T2 }) : e.chooseScopes ? import_react123.default.createElement(si, { login: i, scope: e.scope, handleAuthResponse: B }) : import_react123.default.createElement("div", null, "Success") : import_react123.default.createElement(ai, { onForgotPassword: a, onRegister: n, handleAuthResponse: T2, disableGoogleAuth: e.disableGoogleAuth, disableEmailAuth: e.disableEmailAuth, ...s }, e.children))());
}
export {
  bn as AddressDisplay,
  kn as AddressInput,
  Bn as AnnotationInput,
  pP as AppShell,
  Do as AsyncAutocomplete,
  ef as AttachmentArrayDisplay,
  tf as AttachmentArrayInput,
  Bo as AttachmentButton,
  Oe2 as AttachmentDisplay,
  Tt as AttachmentInput,
  ot as BackboneElementDisplay,
  nt2 as BackboneElementInput,
  Kf as CalendarInput,
  wt as CheckboxFormSection,
  Dt as CodeInput,
  Mo as CodeableConceptDisplay,
  yf as CodeableConceptInput,
  sf as CodingDisplay,
  Et as CodingInput,
  df as ContactDetailDisplay,
  Sf as ContactDetailInput,
  Bt as ContactPointDisplay,
  Rt as ContactPointInput,
  je as Container,
  ke as DateTimeInput,
  YA as DefaultResourceTimeline,
  af as DescriptionList,
  nf as DescriptionListEntry,
  Pa as DiagnosticReportDisplay,
  Jt as Document,
  mm as ElementDefinitionInputSelector,
  Wf as ElementDefinitionTypeInput,
  dM as EncounterTimeline,
  vo as ErrorBoundary,
  oI as FhirPathTable,
  $ as Form,
  ye as FormSection,
  $n as Header,
  St as HumanNameDisplay,
  kf as HumanNameInput,
  cf as IdentifierDisplay,
  Af as IdentifierInput,
  ra as Loading,
  eo as Logo,
  sw as MeasureReportDisplay,
  le as MedplumLink,
  BC as MedplumProvider,
  KF as MemoizedFhirPathTable,
  qF as MemoizedSearchControl,
  pf as MoneyDisplay,
  Mf as MoneyInput,
  Yn as Navbar,
  jm as ObservationTable,
  Uo2 as OperationOutcomeAlert,
  Lo2 as Panel,
  yw as PatientTimeline,
  Rw as PlanDefinitionBuilder,
  Ke as QuantityDisplay,
  Se as QuantityInput,
  mO as QuestionnaireBuilder,
  ws as QuestionnaireForm,
  fr as QuestionnaireItemType,
  At as RangeDisplay,
  at2 as RangeInput,
  lo as ReferenceDisplay,
  Oo as ReferenceInput,
  JO as ReferenceRangeEditor,
  Ng as ReferenceRangeGroupEditor,
  U1 as RegisterForm,
  t0 as RequestGroupDisplay,
  hf as ResourceArrayDisplay,
  Vf as ResourceArrayInput,
  ge as ResourceAvatar,
  _e as ResourceBadge,
  I0 as ResourceBlame,
  b0 as ResourceDiff,
  F0 as ResourceForm,
  V0 as ResourceHistoryTable,
  Vt as ResourceInput,
  Ee as ResourceName,
  me as ResourcePropertyDisplay,
  qe as ResourcePropertyInput,
  Da as ResourceTable,
  Ye as ResourceTimeline,
  j0 as Scheduler,
  Ha as SearchChangeEvent,
  co as SearchClickEvent,
  Wx as SearchControl,
  Rl as SearchFieldEditor,
  Ul as SearchFilterEditor,
  Va as SearchLoadEvent,
  r1 as ServiceRequestTimeline,
  VE as SignInForm,
  Qt as StatusBadge,
  sl as Timeline,
  Ze as TimelineItem,
  zf as TimingInput,
  Ma2 as addDateFilterBetween,
  BM as addField,
  Ho as addFilter,
  Tl as addLastMonthFilter,
  Fa2 as addMissingFilter,
  Bl as addNextMonthFilter,
  kl as addThisMonthFilter,
  Pl as addTodayFilter,
  Dl as addTomorrowFilter,
  Al as addYearToDateFilter,
  bl as addYesterdayFilter,
  Pe as buildFieldNameString,
  xs as buildInitialResponse,
  Ka as buildInitialResponseItem,
  kM as clearFilters,
  jt as clearFiltersOnField,
  Pf as convertIsoToLocal,
  Df as convertLocalToIso,
  Cr as createScriptTag,
  Sl as deleteFilter,
  gs as formatReferenceString,
  pe2 as getErrorsForInput,
  Wl as getFieldDefinitions,
  Ot as getIssuesForExpression,
  ms as getNewMultiSelectValues,
  hs as getNumberOfPages,
  st2 as getOpString,
  lr as getQuestionnaireItemReferenceTargetTypes,
  $s as getRecaptcha,
  Ol as getSearchOperators,
  Fl as getSortField,
  Js as initRecaptcha,
  ds as isChoiceQuestion,
  cs as isQuestionEnabled,
  wl as isSortDescending,
  Kn2 as parseForm,
  hn2 as reactContext,
  El as renderValue,
  lt as setFilters,
  jp as setOffset,
  Ml as setPage,
  sr as setQuestionnaireItemReferenceTargetTypes,
  wa as setSort,
  dl as sortByDateAndPriority,
  AM as toggleSort,
  P2 as useMedplum,
  Xo as useMedplumContext,
  Qe as useMedplumNavigate,
  gt as useMedplumProfile,
  z2 as useResource,
  OC as useSearch,
  yn as useSearchOne,
  vn as useSearchResources
};
//# sourceMappingURL=@medplum_react.js.map
